<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ricardo Accioly">

<title>IME05 - Análise de Sobrevivência - Análise de Sobrevivência</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IME05 - Análise de Sobrevivência</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Início</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">Sobre</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./modregpar01.html" aria-current="page">Análise de Sobrevivência</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução">Introdução</a></li>
  <li><a href="#carregando-os-dados" id="toc-carregando-os-dados" class="nav-link" data-scroll-target="#carregando-os-dados">Carregando os dados</a></li>
  <li><a href="#ajuste-não-paramétrico" id="toc-ajuste-não-paramétrico" class="nav-link" data-scroll-target="#ajuste-não-paramétrico">Ajuste Não Paramétrico</a></li>
  <li><a href="#modelo-exponencial" id="toc-modelo-exponencial" class="nav-link" data-scroll-target="#modelo-exponencial">Modelo Exponencial</a></li>
  <li><a href="#automatizando-ajuste" id="toc-automatizando-ajuste" class="nav-link" data-scroll-target="#automatizando-ajuste">Automatizando ajuste</a></li>
  <li><a href="#fazendo-previsões" id="toc-fazendo-previsões" class="nav-link" data-scroll-target="#fazendo-previsões">Fazendo Previsões</a></li>
  <li><a href="#tempo-mediano" id="toc-tempo-mediano" class="nav-link" data-scroll-target="#tempo-mediano">Tempo Mediano</a></li>
  <li><a href="#comparando-com-outro-quantil" id="toc-comparando-com-outro-quantil" class="nav-link" data-scroll-target="#comparando-com-outro-quantil">Comparando com outro quantil</a></li>
  <li><a href="#verificando-o-modelo" id="toc-verificando-o-modelo" class="nav-link" data-scroll-target="#verificando-o-modelo">Verificando o modelo</a></li>
  <li><a href="#modelo-weibull" id="toc-modelo-weibull" class="nav-link" data-scroll-target="#modelo-weibull">Modelo Weibull</a></li>
  <li><a href="#análise-de-resíduos" id="toc-análise-de-resíduos" class="nav-link" data-scroll-target="#análise-de-resíduos">Análise de resíduos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análise de Sobrevivência</h1>
<p class="subtitle lead">Modelos de regressão paramétricos</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ricardo Accioly </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="introdução" class="level3">
<h3 class="anchored" data-anchor-id="introdução">Introdução</h3>
<p>Nesta etapa vamos começar a trabalhar com modelos de regressão paramétricos.</p>
<p>Os modelos que vamos ver se denominam modelos de tempo de falha (vida) acelerado TFA (AFT).</p>
<p>O conjunto de dados a seguir chamado “anderson.xlsx” consiste em tempos de remissão em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padrão. A variável de exposição de interesse é o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padrão).</p>
<p>Duas outras variáveis para controle como potenciais confundidores são a contagem de glóbulos brancos (ou seja, logwbc) e sexo. O status de falha é definido pela variável recaída (0 se censurado, 1 se falhar).</p>
</section>
<section id="carregando-os-dados" class="level3">
<h3 class="anchored" data-anchor-id="carregando-os-dados">Carregando os dados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"anderson.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span> )</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     tempo           status            sexo            logwbc     
 Min.   : 1.00   Min.   :0.0000   Min.   :0.0000   Min.   :1.450  
 1st Qu.: 6.00   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2.303  
 Median :10.50   Median :1.0000   Median :0.0000   Median :2.800  
 Mean   :12.88   Mean   :0.7143   Mean   :0.4762   Mean   :2.930  
 3rd Qu.:18.50   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:3.490  
 Max.   :35.00   Max.   :1.0000   Max.   :1.0000   Max.   :5.000  
       Rx     
 Min.   :0.0  
 1st Qu.:0.0  
 Median :0.5  
 Mean   :0.5  
 3rd Qu.:1.0  
 Max.   :1.0  </code></pre>
</div>
</div>
</section>
<section id="ajuste-não-paramétrico" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-não-paramétrico">Ajuste Não Paramétrico</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ekm <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(tempo,status)<span class="sc">~</span>Rx, <span class="at">data=</span>dados)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>tempo <span class="ot">&lt;-</span> ekm<span class="sc">$</span>time</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> ekm<span class="sc">$</span>surv</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ekm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(tempo, status) ~ Rx, data = dados)

                Rx=0 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    6     21       3    0.857  0.0764        0.720        1.000
    7     17       1    0.807  0.0869        0.653        0.996
   10     15       1    0.753  0.0963        0.586        0.968
   13     12       1    0.690  0.1068        0.510        0.935
   16     11       1    0.627  0.1141        0.439        0.896
   22      7       1    0.538  0.1282        0.337        0.858
   23      6       1    0.448  0.1346        0.249        0.807

                Rx=1 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     21       2   0.9048  0.0641      0.78754        1.000
    2     19       2   0.8095  0.0857      0.65785        0.996
    3     17       1   0.7619  0.0929      0.59988        0.968
    4     16       2   0.6667  0.1029      0.49268        0.902
    5     14       2   0.5714  0.1080      0.39455        0.828
    8     12       4   0.3810  0.1060      0.22085        0.657
   11      8       2   0.2857  0.0986      0.14529        0.562
   12      6       2   0.1905  0.0857      0.07887        0.460
   15      4       1   0.1429  0.0764      0.05011        0.407
   17      3       1   0.0952  0.0641      0.02549        0.356
   22      2       1   0.0476  0.0465      0.00703        0.322
   23      1       1   0.0000     NaN           NA           NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ekm, <span class="at">xlab=</span><span class="st">"Tempo (meses)"</span>,<span class="at">ylab=</span><span class="st">"S(t) estimada"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modregpar01_files/figure-html/ex_2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modelo-exponencial" class="level2">
<h2 class="anchored" data-anchor-id="modelo-exponencial">Modelo Exponencial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>leuc.exp.comp <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(tempo, status) <span class="sc">~</span> sexo <span class="sc">+</span> logwbc <span class="sc">+</span> Rx, <span class="at">data =</span> dados, <span class="at">dist =</span> <span class="st">"exponential"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leuc.exp.comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, 
    dist = "exponential")
              Value Std. Error     z      p
(Intercept)  5.9741     0.6965  8.58 &lt;2e-16
sexo        -0.0859     0.3834 -0.22  0.823
logwbc      -0.8723     0.2212 -3.94  8e-05
Rx          -1.1156     0.4270 -2.61  0.009

Scale fixed at 1 

Exponential distribution
Loglik(model)= -100.7   Loglik(intercept only)= -116.8
    Chisq= 32.04 on 3 degrees of freedom, p= 5.1e-07 
Number of Newton-Raphson Iterations: 4 
n= 42 </code></pre>
</div>
</div>
</section>
<section id="automatizando-ajuste" class="level2">
<h2 class="anchored" data-anchor-id="automatizando-ajuste">Automatizando ajuste</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>leuc.exp.sel <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(leuc.exp.comp, <span class="at">ditection=</span><span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=209.5
Surv(tempo, status) ~ sexo + logwbc + Rx

         Df    AIC
- sexo    1 207.55
&lt;none&gt;      209.50
- Rx      1 215.10
- logwbc  1 222.57

Step:  AIC=207.55
Surv(tempo, status) ~ logwbc + Rx

         Df    AIC
&lt;none&gt;      207.55
- Rx      1 213.22
- logwbc  1 221.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leuc.exp.sel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, 
    dist = "exponential")
             Value Std. Error     z       p
(Intercept)  5.958      0.699  8.52 &lt; 2e-16
logwbc      -0.884      0.216 -4.10 4.2e-05
Rx          -1.093      0.413 -2.65  0.0082

Scale fixed at 1 

Exponential distribution
Loglik(model)= -100.8   Loglik(intercept only)= -116.8
    Chisq= 31.99 on 2 degrees of freedom, p= 1.1e-07 
Number of Newton-Raphson Iterations: 4 
n= 42 </code></pre>
</div>
</div>
</section>
<section id="fazendo-previsões" class="level2">
<h2 class="anchored" data-anchor-id="fazendo-previsões">Fazendo Previsões</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>novosdados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">logwbc=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">Rx=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(leuc.exp.sel, <span class="at">type=</span><span class="st">"lp"</span>, <span class="at">newdata=</span>novosdados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
4.189084 3.096010 </code></pre>
</div>
</div>
</section>
<section id="tempo-mediano" class="level2">
<h2 class="anchored" data-anchor-id="tempo-mediano">Tempo Mediano</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>prev1 <span class="ot">&lt;-</span><span class="fu">predict</span>(leuc.exp.sel, <span class="at">type=</span><span class="st">"quantile"</span>, <span class="at">newdata=</span>novosdados, <span class="at">p=</span><span class="fl">0.5</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>prev1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
45.72161 15.32518 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>prev1[<span class="dv">1</span>]<span class="sc">/</span>prev1[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.983431 </code></pre>
</div>
</div>
</section>
<section id="comparando-com-outro-quantil" class="level2">
<h2 class="anchored" data-anchor-id="comparando-com-outro-quantil">Comparando com outro quantil</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>prev2 <span class="ot">&lt;-</span><span class="fu">predict</span>(leuc.exp.sel, <span class="at">type=</span><span class="st">"quantile"</span>, <span class="at">newdata=</span>novosdados, <span class="at">p=</span><span class="fl">0.7</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>prev2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
79.41687 26.61931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prev2[<span class="dv">1</span>]<span class="sc">/</span>prev2[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.983431 </code></pre>
</div>
</div>
</section>
<section id="verificando-o-modelo" class="level2">
<h2 class="anchored" data-anchor-id="verificando-o-modelo">Verificando o modelo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>pred.lin <span class="ot">&lt;-</span> <span class="fu">predict</span>(leuc.exp.sel, <span class="at">type =</span> <span class="st">"lp"</span>)[dados<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>log.resid <span class="ot">&lt;-</span> <span class="fu">log</span>(dados<span class="sc">$</span>tempo[dados<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> pred.lin</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred.lin, log.resid, <span class="at">main =</span> <span class="st">"Grafico TA"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"log(valores ajustados)"</span>, <span class="at">ylab =</span> <span class="st">"log(residuos)"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(log.resid, <span class="at">dist =</span> <span class="st">"norm"</span>, <span class="at">sd=</span>leuc.exp.sel<span class="sc">$</span>scale, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Grafico Q-Q"</span>, <span class="at">xlab =</span> <span class="st">"Quantis teoricos Exponencial"</span>, <span class="at">ylab =</span> <span class="st">"Quantis empiricos"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modregpar01_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29  7</code></pre>
</div>
</div>
</section>
<section id="modelo-weibull" class="level2">
<h2 class="anchored" data-anchor-id="modelo-weibull">Modelo Weibull</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>leuc.wei.comp <span class="ot">&lt;-</span> <span class="fu">survreg</span>(<span class="fu">Surv</span>(tempo, status) <span class="sc">~</span> sexo <span class="sc">+</span> logwbc <span class="sc">+</span> Rx, <span class="at">data =</span> dados, <span class="at">dist =</span> <span class="st">"weibull"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(leuc.wei.comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
survreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, 
    dist = "weibull")
             Value Std. Error     z       p
(Intercept)  5.462      0.351 15.58 &lt; 2e-16
sexo        -0.156      0.179 -0.87 0.38350
logwbc      -0.792      0.105 -7.54 4.8e-14
Rx          -0.722      0.201 -3.59 0.00034
Log(scale)  -0.815      0.144 -5.65 1.6e-08

Scale= 0.443 

Weibull distribution
Loglik(model)= -89.7   Loglik(intercept only)= -116.4
    Chisq= 53.42 on 3 degrees of freedom, p= 1.5e-11 
Number of Newton-Raphson Iterations: 7 
n= 42 </code></pre>
</div>
</div>
</section>
<section id="análise-de-resíduos" class="level2">
<h2 class="anchored" data-anchor-id="análise-de-resíduos">Análise de resíduos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">##=====================================================================</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>qq.reg.resid.r<span class="ot">&lt;-</span><span class="cf">function</span>(data,time,status,fit,quantile,xlab){</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">##=================================</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Purpose: For parametric regression models, this constructs a</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          qq-plot of ordered residuals e_i=(y_i-yhat_i)/sigmahat against</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          the log-parametric standard quantiles z_i of either the</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          "weibull", "lognormal", or "loglogistic" distribution.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">##--------------------------------------------------------------------------</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">:  This can also be used for fitting a single sample of survival</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">##        times to a parametric model. Since there are no covariates</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="do">##        remember to type survReg(Surv(...,...)~1,dist="...",data=...) </span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="do">##        in order to estimate the intercept mu.</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">##---------------------------------------------------------------------------</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Arguments:   data = data.frame</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="do">##              time = survival time variable name in data.frame</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="do">##              status = name of status variable in data.frame</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="do">##              fit = a survreg object</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="do">##              quantile = "qweibull" or "qnorm" or "qlogis"  </span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="do">##              xlab = "type your label" E.g., "standard extreme value quantiles"</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="do">##------------------------------------------------------------------------------</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Author: Mara Tableman, Revises: 6 March, 2013</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="do">##==============================================================================</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">&lt;-</span>data</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>time<span class="ot">&lt;-</span>time</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>status<span class="ot">&lt;-</span>status</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>ei<span class="ot">&lt;-</span>(<span class="fu">log</span>(temp<span class="sc">$</span>time)<span class="sc">-</span><span class="fu">predict</span>(fit,<span class="at">type=</span><span class="st">"lp"</span>))<span class="sc">/</span>fit<span class="sc">$</span>scale</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">&lt;-</span>temp[<span class="fu">order</span>(temp<span class="sc">$</span>ei), ]</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>con<span class="ot">&lt;-</span><span class="fu">abs</span>(<span class="fu">min</span>(temp<span class="sc">$</span>ei))<span class="sc">+</span>.<span class="dv">00001</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>ei<span class="ot">&lt;-</span>temp<span class="sc">$</span>ei<span class="sc">+</span>con </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>km.fit<span class="ot">&lt;-</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(ei,status)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>temp)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="do">##temp$km.surv&lt;-summary(km.fit,censor=T)$surv</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>km.surv<span class="ot">&lt;-</span><span class="fu">summary</span>(km.fit, <span class="at">time=</span>temp<span class="sc">$</span>ei, <span class="at">extend=</span>T)<span class="sc">$</span>surv</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (quantile <span class="sc">==</span> <span class="st">"qweibull"</span>) {</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>zi<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">qweibull</span>(<span class="dv">1</span><span class="sc">-</span>temp<span class="sc">$</span>km.surv,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(temp)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (zi[i]<span class="sc">!=-</span><span class="cn">Inf</span> <span class="sc">&amp;&amp;</span> zi[i]<span class="sc">!=</span><span class="cn">Inf</span> ) zi[i]<span class="ot">&lt;-</span><span class="fu">log</span>(zi[i])</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>zi<span class="ot">&lt;-</span>zi</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==-</span><span class="cn">Inf</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>{   surv.max<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">max</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    d<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>surv.max<span class="fl">.1</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    surv.pu<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>d<span class="sc">/</span><span class="dv">2</span>  </span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="fu">qweibull</span>(<span class="dv">1</span><span class="sc">-</span>surv.pu,<span class="dv">1</span>,<span class="dv">1</span>))}</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==</span><span class="cn">Inf</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>{  d<span class="ot">&lt;-</span><span class="fu">min</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>km.surv <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    surv.pl<span class="ot">&lt;-</span>d<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="fu">qweibull</span>(<span class="dv">1</span><span class="sc">-</span>surv.pl,<span class="dv">1</span>,<span class="dv">1</span>))}</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (quantile <span class="sc">==</span> <span class="st">"qlogis"</span>) {</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>zi<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">qlogis</span>(<span class="dv">1</span><span class="sc">-</span>temp<span class="sc">$</span>km.surv,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(temp)</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (zi[i]<span class="sc">!=-</span><span class="cn">Inf</span> <span class="sc">&amp;&amp;</span> zi[i]<span class="sc">!=</span><span class="cn">Inf</span> ) zi[i]<span class="ot">&lt;-</span>zi[i]</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>zi<span class="ot">&lt;-</span>zi</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==-</span><span class="cn">Inf</span>)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>{   surv.max<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">max</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    d<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>surv.max<span class="fl">.1</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    surv.pu<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>d<span class="sc">/</span><span class="dv">2</span>  </span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">qlogis</span>(<span class="dv">1</span><span class="sc">-</span>surv.pu,<span class="dv">0</span>,<span class="dv">1</span>)}</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==</span><span class="cn">Inf</span>)</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>{  d<span class="ot">&lt;-</span><span class="fu">min</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>km.surv <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    surv.pl<span class="ot">&lt;-</span>d<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">qlogis</span>(<span class="dv">1</span><span class="sc">-</span>surv.pl,<span class="dv">0</span>,<span class="dv">1</span>)}</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (quantile <span class="sc">==</span> <span class="st">"qnorm"</span>){ </span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>zi<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>temp<span class="sc">$</span>km.surv,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(temp)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (zi[i]<span class="sc">!=-</span><span class="cn">Inf</span> <span class="sc">&amp;&amp;</span> zi[i]<span class="sc">!=</span><span class="cn">Inf</span> ) zi[i]<span class="ot">&lt;-</span>zi[i]</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>temp<span class="sc">$</span>zi<span class="ot">&lt;-</span>zi</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==-</span><span class="cn">Inf</span>)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>{   surv.max<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">max</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>    d<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>surv.max<span class="fl">.1</span></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>    surv.pu<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>d<span class="sc">/</span><span class="dv">2</span>  </span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>surv.pu,<span class="dv">0</span>,<span class="dv">1</span>)}</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){ <span class="cf">if</span> (temp<span class="sc">$</span>zi[i]<span class="sc">==</span><span class="cn">Inf</span>)</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>{  d<span class="ot">&lt;-</span><span class="fu">min</span>(temp<span class="sc">$</span>km.surv[temp<span class="sc">$</span>km.surv <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    surv.pl<span class="ot">&lt;-</span>d<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>    temp<span class="sc">$</span>zi[i]<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>surv.pl,<span class="dv">0</span>,<span class="dv">1</span>)}</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a> temp<span class="sc">$</span>ei<span class="ot">&lt;-</span>temp<span class="sc">$</span>ei<span class="sc">-</span>con</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a><span class="do">##print(temp)</span></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temp<span class="sc">$</span>zi,temp<span class="sc">$</span>ei,<span class="at">xlab=</span>xlab,<span class="at">ylab=</span><span class="st">"ordered ei residuals"</span>,<span class="at">type=</span><span class="st">"n"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(temp<span class="sc">$</span>zi),<span class="fu">max</span>(temp<span class="sc">$</span>zi)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(temp<span class="sc">$</span>ei),<span class="fu">max</span>(temp<span class="sc">$</span>ei)<span class="sc">+</span>.<span class="dv">15</span>))</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(temp<span class="sc">$</span>zi[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">0</span>],temp<span class="sc">$</span>ei[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">0</span>],<span class="at">pch=</span><span class="st">"."</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(temp<span class="sc">$</span>zi[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>],temp<span class="sc">$</span>ei[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>],<span class="at">pch=</span><span class="st">"o"</span>,<span class="at">cex=</span><span class="dv">1</span>)</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(temp<span class="sc">$</span>zi[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>],temp<span class="sc">$</span>ei[temp<span class="sc">$</span>status<span class="sc">==</span><span class="dv">1</span>],<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(temp)</span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>{ <span class="cf">if</span> (temp<span class="sc">$</span>status[i]<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(temp<span class="sc">$</span>zi[i],temp<span class="sc">$</span>ei[i],temp<span class="sc">$</span>zi[i],temp<span class="sc">$</span>ei[i]<span class="sc">+</span>.<span class="dv">15</span>,<span class="at">code=</span><span class="dv">2</span>,<span class="at">length=</span>.<span class="dv">12</span>,<span class="at">lwd=</span><span class="fl">2.01</span>)}</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">4</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>usr<span class="ot">&lt;-</span><span class="fu">par</span>(<span class="st">"usr"</span>)</span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(.<span class="dv">9</span><span class="sc">*</span>usr[<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">1</span><span class="sc">*</span>usr[<span class="dv">2</span>],.<span class="dv">07</span><span class="sc">*</span>usr[<span class="dv">3</span>]<span class="sc">+</span>.<span class="dv">93</span><span class="sc">*</span>usr[<span class="dv">4</span>],.<span class="dv">9</span><span class="sc">*</span>usr[<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">1</span><span class="sc">*</span>usr[<span class="dv">2</span>],.<span class="dv">07</span><span class="sc">*</span>usr[<span class="dv">3</span>]<span class="sc">+</span>.<span class="dv">93</span><span class="sc">*</span>usr[<span class="dv">4</span>]<span class="sc">+</span>.<span class="dv">15</span>,<span class="at">code=</span><span class="dv">2</span>,<span class="at">length=</span>.<span class="dv">12</span>,<span class="at">lwd=</span><span class="fl">2.01</span>)</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">8</span><span class="sc">*</span>usr[<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">2</span><span class="sc">*</span>usr[<span class="dv">2</span>],.<span class="dv">05</span><span class="sc">*</span>usr[<span class="dv">3</span>]<span class="sc">+</span>.<span class="dv">95</span><span class="sc">*</span>usr[<span class="dv">4</span>],<span class="st">"= censored"</span>)</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(.<span class="dv">9</span><span class="sc">*</span>usr[<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">1</span><span class="sc">*</span>usr[<span class="dv">2</span>],.<span class="dv">11</span><span class="sc">*</span>usr[<span class="dv">3</span>]<span class="sc">+</span>.<span class="dv">89</span><span class="sc">*</span>usr[<span class="dv">4</span>],<span class="at">pch=</span><span class="st">"o"</span>)</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(.<span class="dv">79</span><span class="sc">*</span>usr[<span class="dv">1</span>]<span class="sc">+</span>.<span class="dv">21</span><span class="sc">*</span>usr[<span class="dv">2</span>],.<span class="dv">1</span><span class="sc">*</span>usr[<span class="dv">3</span>]<span class="sc">+</span>.<span class="dv">90</span><span class="sc">*</span>usr[<span class="dv">4</span>], <span class="st">"= uncensored"</span>) </span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a><span class="fu">on.exit</span>()</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a><span class="st">"qq.reg.resid:done"</span></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a><span class="fu">qq.reg.resid.r</span>(dados,dados<span class="sc">$</span>tempo,dados<span class="sc">$</span>status, leuc.wei.comp,<span class="st">"qweibull"</span>,<span class="st">"standard extreme value quantiles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="modregpar01_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "qq.reg.resid:done"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Example 2: </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">##fit.weib&lt;-survreg(Surv(weeks,status)~1,dist="weibull",data=aml1)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">##qq.reg.resid.r(aml1,aml1$weeks,aml1$status,fit.weib,"qweibull","standard extreme value quantiles")</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="do">##==================================================</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>