[
  {
    "objectID": "visao-do-curso.html",
    "href": "visao-do-curso.html",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Introdu√ß√£o e conceitos b√°sicos em An√°lise de Sobreviv√™ncia.\nEstimativa n√£o param√©trica da fun√ß√£o de sobreviv√™ncia.\nCompara√ß√£o de curvas de sobreviv√™ncia.\nDistribui√ß√µes param√©tricas do tempo e vida.\nModelos de regress√£o."
  },
  {
    "objectID": "semanas/Aula11.html#diagn√≥stico-do-modelo-de-cox",
    "href": "semanas/Aula11.html#diagn√≥stico-do-modelo-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do modelo de Cox",
    "text": "Diagn√≥stico do modelo de Cox\nO conjunto de dados carregados a seguir s√£o de 238 pacientes viciados com hero√≠na.\nOs pacientes foram tratados em duas cl√≠nicas (1 e 2), al√©m disso foram coletadas informa√ß√µes sobre dose de medicamento ministrado no tratamento e se o paciente j√° havia sido preso ou n√£o.\nOs tempos (survt) s√£o em dias e o evento analisado foi o tempo at√© a sa√≠da da cl√≠nica (status=1) ou o tempo at√© o t√©rmino de estudo (tempo censurado (status=0).\n\nid: Identifica√ß√£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo at√© a sa√≠da da cl√≠nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se j√° foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula11.html#carregando-os-dados",
    "href": "semanas/Aula11.html#carregando-os-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\nlibrary(survival)\nlibrary(readxl)\ndados &lt;- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nstr(dados)\n\ntibble [238 √ó 6] (S3: tbl_df/tbl/data.frame)\n $ id    : num [1:238] 1 2 3 4 5 6 7 8 9 10 ...\n $ clinic: num [1:238] 1 1 1 1 1 1 1 1 1 1 ...\n $ status: num [1:238] 1 1 1 1 1 1 1 0 1 1 ...\n $ survt : num [1:238] 428 275 262 183 259 714 438 796 892 393 ...\n $ prison: num [1:238] 0 1 0 0 1 0 1 1 0 1 ...\n $ dose  : num [1:238] 50 55 55 30 65 55 65 60 50 65 ..."
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-presen√ßa-de-dados-ausentes",
    "href": "semanas/Aula11.html#avaliando-presen√ßa-de-dados-ausentes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando presen√ßa de dados ausentes",
    "text": "Avaliando presen√ßa de dados ausentes\n\nsum(complete.cases(dados))\n\n[1] 238"
  },
  {
    "objectID": "semanas/Aula11.html#ajuste-do-modelo",
    "href": "semanas/Aula11.html#ajuste-do-modelo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do modelo",
    "text": "Ajuste do modelo\n\najuste1 &lt;- coxph(Surv(survt,status) ~ clinic + prison + dose,\n                 ties= \"efron\", data=dados)\najuste1\n\nCall:\ncoxph(formula = Surv(survt, status) ~ clinic + prison + dose, \n    data = dados, ties = \"efron\")\n\n            coef exp(coef)  se(coef)      z        p\nclinic -1.009896  0.364257  0.214889 -4.700 2.61e-06\nprison  0.326555  1.386184  0.167225  1.953   0.0508\ndose   -0.035369  0.965249  0.006379 -5.545 2.94e-08\n\nLikelihood ratio test=64.56  on 3 df, p=6.229e-14\nn= 238, number of events= 150"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo",
    "href": "semanas/Aula11.html#avaliando-o-modelo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\namostra.dados &lt;- data.frame(clinic = c(\"1\", \"2\"), prison = rep(0, 2), dose = rep(mean(dados$dose), 2))\namostra.sobr &lt;- survfit(ajuste1, newdata = amostra.dados)\nplot(amostra.sobr, col = c(1, 2), conf.int = TRUE,\nxlab = \"Tempo (dias)\", ylab = \"S(t)\")\nlegend(\"bottomleft\", bty = \"n\", lty = 1, col = 1:2,\nlegend = sprintf(\"clinic %d\", 1:2))"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-proporcionalidade",
    "href": "semanas/Aula11.html#avaliando-proporcionalidade",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando proporcionalidade",
    "text": "Avaliando proporcionalidade\n\nvic.km.clinica &lt;- survfit(Surv(survt, status) ~ clinic, data = dados)\ntabela.vic &lt;- summary(vic.km.clinica)\nplot(tabela.vic$time, log(-log(tabela.vic$surv)),\ncol = tabela.vic$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-proporcionalidade-1",
    "href": "semanas/Aula11.html#avaliando-proporcionalidade-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando proporcionalidade",
    "text": "Avaliando proporcionalidade\n\nlibrary(rms)\nsurvplot(npsurv(Surv(survt, status) ~ clinic, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo-1",
    "href": "semanas/Aula11.html#avaliando-o-modelo-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\nsurvplot(npsurv(Surv(survt, status) ~ prison, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo-2",
    "href": "semanas/Aula11.html#avaliando-o-modelo-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\ndados$dose_60 &lt;- as.integer(dados$dose&lt;=60)\nsurvplot(npsurv(Surv(survt, status) ~ dose_60, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#res√≠duos-de-cox-snell",
    "href": "semanas/Aula11.html#res√≠duos-de-cox-snell",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Cox-Snell",
    "text": "Res√≠duos de Cox-Snell\n\nlibrary(car)\ncox.snell &lt;- abs(dados$status - ajuste1$residuals)\nqqPlot(cox.snell, dist = \"exp\", rate = mean(cox.snell))\n\n\n[1]  9 84"
  },
  {
    "objectID": "semanas/Aula11.html#res√≠duos-de-schoenfeld",
    "href": "semanas/Aula11.html#res√≠duos-de-schoenfeld",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Schoenfeld",
    "text": "Res√≠duos de Schoenfeld\n\ncox.zph(ajuste1)\n\n        chisq df       p\nclinic 11.159  1 0.00084\nprison  0.839  1 0.35969\ndose    0.515  1 0.47310\nGLOBAL 12.287  3 0.00646"
  },
  {
    "objectID": "semanas/Aula11.html#res√≠duos-de-schoenfeld-1",
    "href": "semanas/Aula11.html#res√≠duos-de-schoenfeld-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Schoenfeld",
    "text": "Res√≠duos de Schoenfeld\n\nresid.sch &lt;- cox.zph(ajuste1)\npar(mfrow=c(1,3))\nplot(resid.sch)"
  },
  {
    "objectID": "semanas/Aula09.html",
    "href": "semanas/Aula09.html",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Vamos usar neste exemplo dados da biblioteca survival.\nOs dados s√£o de sobreviv√™ncia de pacientes com cancer de pulm√£o em est√°gio avan√ßado do North Central Cancer Treatment Group.\n- inst: C√≥dico da Intitui√ß√£o\n- time: Tempo de sobreviv√™ncia em dias\n- status: 1=censurado, 2=morto\n- age: Idade em anos\n- sex: 1=Homem 2 = Mulher\n- ph.ecog: escore ecog 0=bom 5=morto\n- ph.karno: escore de Karnofsky (ruim=0-bom=100) definido pelo m√©dico\n- pat.karno: escore de Karnofsky definido pelo paciente\n- meal.cal: Calorias consumidas nas refei√ß√µes\n- wt.loss: Perda de peso nos √∫ltimos seis meses (libras)"
  },
  {
    "objectID": "semanas/Aula09.html#modelo-semi-param√©trico-de-cox",
    "href": "semanas/Aula09.html#modelo-semi-param√©trico-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Semi-param√©trico de Cox",
    "text": "Modelo Semi-param√©trico de Cox\n\najuste1 &lt;- coxph(Surv(time, status) ~ age + sex + ph.ecog +\n                   ph.karno + pat.karno + meal.cal + wt.loss, data = dados)\nsummary(ajuste1)\n\nCall:\ncoxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + \n    pat.karno + meal.cal + wt.loss, data = dados)\n\n  n= 167, number of events= 120 \n\n                coef  exp(coef)   se(coef)      z Pr(&gt;|z|)   \nage        1.080e-02  1.011e+00  1.160e-02  0.931  0.35168   \nsex       -5.536e-01  5.749e-01  2.016e-01 -2.746  0.00603 **\nph.ecog    7.395e-01  2.095e+00  2.250e-01  3.287  0.00101 **\nph.karno   2.244e-02  1.023e+00  1.123e-02  1.998  0.04575 * \npat.karno -1.207e-02  9.880e-01  8.116e-03 -1.488  0.13685   \nmeal.cal   2.835e-05  1.000e+00  2.594e-04  0.109  0.91298   \nwt.loss   -1.420e-02  9.859e-01  7.766e-03 -1.828  0.06748 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n          exp(coef) exp(-coef) lower .95 upper .95\nage          1.0109     0.9893    0.9881    1.0341\nsex          0.5749     1.7395    0.3872    0.8534\nph.ecog      2.0950     0.4773    1.3479    3.2560\nph.karno     1.0227     0.9778    1.0004    1.0455\npat.karno    0.9880     1.0121    0.9724    1.0038\nmeal.cal     1.0000     1.0000    0.9995    1.0005\nwt.loss      0.9859     1.0143    0.9710    1.0010\n\nConcordance= 0.653  (se = 0.029 )\nLikelihood ratio test= 28.16  on 7 df,   p=2e-04\nWald test            = 27.5  on 7 df,   p=3e-04\nScore (logrank) test = 28.31  on 7 df,   p=2e-04\n\nlogLik(ajuste1)\n\n'log Lik.' -494.0344 (df=7)"
  },
  {
    "objectID": "semanas/Aula09.html#usando-o-teste-de-wald-e-da-raz√£o-de-verossimilhan√ßa",
    "href": "semanas/Aula09.html#usando-o-teste-de-wald-e-da-raz√£o-de-verossimilhan√ßa",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Usando o teste de Wald e da raz√£o de verossimilhan√ßa",
    "text": "Usando o teste de Wald e da raz√£o de verossimilhan√ßa\nO teste de Wald avalia a estat√≠stica z, que no caso acima indica que diversas vari√°veis n√£o s√£o significativas, por exemplo, meat.cal, age, pat.karno.\nVamos eliminar somente meat.cal e fazer o teste da raz√£o de verossimilhan√ßa para confirmarmos que ela n√£o √© estat√≠sticamente significativa.\n\najuste2 &lt;- coxph(Surv(time, status) ~ age + sex + ph.ecog +\n                   ph.karno + pat.karno + wt.loss, data = dados)\nlogLik(ajuste2)\n\n'log Lik.' -494.0404 (df=6)\n\nTRV &lt;- 2*(logLik(ajuste1) - logLik(ajuste2))\npchisq(TRV[1],1, lower.tail = FALSE)\n\n[1] 0.9131696\n\n\nO resultado acima confirma que o modelo n√£o √© afetado pela retirada de meat.cal, ou seja, ela n√£o √© estat√≠sticamente significativa."
  },
  {
    "objectID": "semanas/Aula09.html#automatizando-ajuste",
    "href": "semanas/Aula09.html#automatizando-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\najuste3 &lt;- stepAIC(ajuste1, direction=\"backward\", trace=FALSE)\nsummary(ajuste3)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + ph.ecog + ph.karno + \n    pat.karno + wt.loss, data = dados)\n\n  n= 167, number of events= 120 \n\n               coef exp(coef)  se(coef)      z Pr(&gt;|z|)   \nsex       -0.558190  0.572244  0.199202 -2.802  0.00508 **\nph.ecog    0.742983  2.102197  0.227604  3.264  0.00110 **\nph.karno   0.020366  1.020575  0.011080  1.838  0.06604 . \npat.karno -0.012401  0.987675  0.007978 -1.554  0.12008   \nwt.loss   -0.014494  0.985611  0.007693 -1.884  0.05957 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n          exp(coef) exp(-coef) lower .95 upper .95\nsex          0.5722     1.7475    0.3873    0.8456\nph.ecog      2.1022     0.4757    1.3457    3.2841\nph.karno     1.0206     0.9798    0.9987    1.0430\npat.karno    0.9877     1.0125    0.9724    1.0032\nwt.loss      0.9856     1.0146    0.9709    1.0006\n\nConcordance= 0.658  (se = 0.029 )\nLikelihood ratio test= 27.28  on 5 df,   p=5e-05\nWald test            = 26.89  on 5 df,   p=6e-05\nScore (logrank) test = 27.64  on 5 df,   p=4e-05\n\n\nVeja que wt.loss e ph.karno s√£o marginalmente significativas. pat.karno tem p-valor acima de 0,10 o que normalmente indicaria sua retirada do modelo."
  },
  {
    "objectID": "semanas/Aula09.html#usando-o-bic",
    "href": "semanas/Aula09.html#usando-o-bic",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Usando o BIC",
    "text": "Usando o BIC\n\nn_eventos &lt;- sum(dados$status)\najuste4 &lt;- stepAIC(ajuste1, direction=\"backward\", k= log(n_eventos), trace=FALSE)\nsummary(ajuste4)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + ph.ecog, data = dados)\n\n  n= 167, number of events= 120 \n\n           coef exp(coef) se(coef)      z Pr(&gt;|z|)    \nsex     -0.5101    0.6004   0.1969 -2.591 0.009579 ** \nph.ecog  0.4825    1.6201   0.1323  3.647 0.000266 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n        exp(coef) exp(-coef) lower .95 upper .95\nsex        0.6004     1.6655    0.4082    0.8832\nph.ecog    1.6201     0.6172    1.2501    2.0998\n\nConcordance= 0.641  (se = 0.031 )\nLikelihood ratio test= 19.48  on 2 df,   p=6e-05\nWald test            = 19.35  on 2 df,   p=6e-05\nScore (logrank) test = 19.62  on 2 df,   p=5e-05"
  },
  {
    "objectID": "semanas/Aula09.html#informa√ß√µes-do-ajuste",
    "href": "semanas/Aula09.html#informa√ß√µes-do-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Informa√ß√µes do Ajuste",
    "text": "Informa√ß√µes do Ajuste\n\ncoef(ajuste4)\n\n       sex    ph.ecog \n-0.5100991  0.4825185 \n\nlogLik(ajuste4)\n\n'log Lik.' -498.3757 (df=2)"
  },
  {
    "objectID": "semanas/Aula09.html#tempos-id√™nticos",
    "href": "semanas/Aula09.html#tempos-id√™nticos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Tempos Id√™nticos",
    "text": "Tempos Id√™nticos\n\najuste5 &lt;- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"efron\", \n                 data=dados)\najuste6 &lt;- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"breslow\", \n                 data=dados)\najuste7 &lt;- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"exact\", \n                 data=dados)\ndif_met &lt;- rbind(coef(ajuste5), coef(ajuste6), coef(ajuste7))\nrow.names(dif_met) &lt;- c(\"Efron\", \"Breslow\", \"Exact\")\nknitr::kable(dif_met)\n\n\n\n\n\nsex\nph.ecog\n\n\n\n\nEfron\n-0.5100991\n0.4825185\n\n\nBreslow\n-0.5094047\n0.4823368\n\n\nExact\n-0.5103502\n0.4832902\n\n\n\n\n\nObserve que as diferen√ßas entre os m√©todos s√£o pequenas, n√£o afetando a interpreta√ß√£o."
  },
  {
    "objectID": "semanas/Aula09.html#avaliando-ajuste",
    "href": "semanas/Aula09.html#avaliando-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando Ajuste",
    "text": "Avaliando Ajuste\n\nav1 &lt;- survfit(Surv(time, status) ~ sex, data = dados)\nav1.tab &lt;- summary(av1)\nplot(log(av1.tab$time),log(-log(av1.tab$surv)),\ncol = av1.tab$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)\nlegend(\"bottomright\", bty = \"n\", lty = 1, col = c(1:2),\nlegend = sprintf(\"Sexo %d\", 1:2))\n\n\n\nav2 &lt;- survfit(Surv(time, status) ~ ph.ecog, data = dados)\nav2.tab &lt;- summary(av2)\nplot(log(av2.tab$time),log(-log(av2.tab$surv)),\ncol = av2.tab$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)\nlegend(\"bottomright\", bty = \"n\", lty = 1, col = c(1,2,3,4),\nlegend = sprintf(\"Ecog %d\", 0:3))\n\n\n\n\nN√£o temos indica√ß√£o gr√°fica de n√£o proporcionalidade das taxas de falhas"
  },
  {
    "objectID": "semanas/Aula09.html#res√≠duos-de-cox-snell",
    "href": "semanas/Aula09.html#res√≠duos-de-cox-snell",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Cox-Snell",
    "text": "Res√≠duos de Cox-Snell\n\nlibrary(car)\ncox.snell &lt;- abs(dados$status - ajuste4$residuals)\nqqPlot(cox.snell, dist = \"exp\", rate = mean(cox.snell))\n\n\n\n\n37 18 \n25 11 \n\n\nAlgum desvio na cauda direita"
  },
  {
    "objectID": "semanas/Aula09.html#res√≠duos-de-schoenfeld",
    "href": "semanas/Aula09.html#res√≠duos-de-schoenfeld",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Schoenfeld",
    "text": "Res√≠duos de Schoenfeld\n\ncox.zph(ajuste4)\n\n        chisq df     p\nsex      1.24  1 0.266\nph.ecog  5.27  1 0.022\nGLOBAL   6.19  2 0.045\n\nresid.sch &lt;- cox.zph(ajuste4)\npar(mfrow=c(1,3))\nplot(resid.sch)\n\n\n\n\nN√£o h√° indica√ß√£o significativa de n√£o proporcionalidade.\nSomente ph.ecog apresenta um p valor mais baixo indicando um potencial comportamento de n√£o proporcionalidade. A hip√≥tese nula √© que o coeficiente angular √© zero."
  },
  {
    "objectID": "semanas/Aula09.html#res√≠duos-martingale-e-deviance",
    "href": "semanas/Aula09.html#res√≠duos-martingale-e-deviance",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos Martingale e Deviance",
    "text": "Res√≠duos Martingale e Deviance\nOs res√≠duos Martingale servem para avaliar alguma forma de n√£o lineridade do modelo e os res√≠duoas deviance para verificarmos a presen√ßa de outliers.\n\npar(mfrow=c(1,2))\nmart&lt;- residuals(ajuste4,type=\"martingale\")\ndev&lt;- residuals(ajuste4,type=\"deviance\")\nplot(mart, ylab=\"res\",pch=20)\ntitle(\"Resƒ±duos Martingale\")\nplot(dev, ylab=\"res\",pch=20)\ntitle(\"Residuos Deviance\")\n\n\n\n\nN√£o temos indica√ß√µes claras em nenhum dos dois res√≠duos"
  },
  {
    "objectID": "semanas/Aula09.html#modelo-de-cox-estratificado",
    "href": "semanas/Aula09.html#modelo-de-cox-estratificado",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo de Cox Estratificado",
    "text": "Modelo de Cox Estratificado\nNa eventiualidade de termos um termo claramente violando a proporcionalidade das taxas de falhas, podemos contornar este problema usando a vari√°vel como um estrato.\n\najuste4_E &lt;- coxph(Surv(time, status) ~ sex + strata(ph.ecog), data=dados)\nsummary(ajuste4_E)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + strata(ph.ecog), data = dados)\n\n  n= 167, number of events= 120 \n\n       coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nsex -0.5434    0.5807   0.2002 -2.715  0.00664 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n    exp(coef) exp(-coef) lower .95 upper .95\nsex    0.5807      1.722    0.3923    0.8598\n\nConcordance= 0.572  (se = 0.027 )\nLikelihood ratio test= 7.75  on 1 df,   p=0.005\nWald test            = 7.37  on 1 df,   p=0.007\nScore (logrank) test = 7.54  on 1 df,   p=0.006\n\n\n\najuste_aux &lt;- survfit(ajuste4_E)\nplot(ajuste_aux, mark.time=FALSE, col=c(1:4), lwd=3, las=1, bty='n', xlab=\"Tempo (dias)\", ylab=\"S(t)\")\nniveis &lt;- sort(unique(dados$ph.ecog))\nlegend(\"topright\", levels(factor(niveis)), lwd=3, col=c(1:6))"
  },
  {
    "objectID": "semanas/Aula07.html",
    "href": "semanas/Aula07.html",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Nesta etapa vamos come√ßar a trabalhar com modelos de regress√£o param√©tricos.\nOs modelos que vamos ver se denominam modelos de tempo de falha (vida) acelerado TFA (AFT).\nO conjunto de dados a seguir chamado ‚Äúanderson.xlsx‚Äù consiste em tempos de remiss√£o (em semanas) em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padr√£o. A vari√°vel de exposi√ß√£o de interesse √© o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padr√£o).\nDuas outras vari√°veis para controle como potenciais confundidores s√£o a contagem de gl√≥bulos brancos (ou seja, logwbc) e sexo. O status de falha √© definido pela vari√°vel reca√≠da (0 se censurado, 1 se falhar)."
  },
  {
    "objectID": "semanas/Aula07.html#modelo-exponencial",
    "href": "semanas/Aula07.html#modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Exponencial",
    "text": "Modelo Exponencial\n\nleuc.exp.comp &lt;- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"exponential\")\nsummary(leuc.exp.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"exponential\")\n              Value Std. Error     z      p\n(Intercept)  5.9741     0.6965  8.58 &lt;2e-16\nsexo        -0.0859     0.3834 -0.22  0.823\nlogwbc      -0.8723     0.2212 -3.94  8e-05\nRx          -1.1156     0.4270 -2.61  0.009\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.7   Loglik(intercept only)= -116.8\n    Chisq= 32.04 on 3 degrees of freedom, p= 5.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#automatizando-ajuste",
    "href": "semanas/Aula07.html#automatizando-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\nleuc.exp.sel &lt;- stepAIC(leuc.exp.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.exp.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"exponential\")\n             Value Std. Error     z       p\n(Intercept)  5.958      0.699  8.52 &lt; 2e-16\nlogwbc      -0.884      0.216 -4.10 4.2e-05\nRx          -1.093      0.413 -2.65  0.0082\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.8   Loglik(intercept only)= -116.8\n    Chisq= 31.99 on 2 degrees of freedom, p= 1.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previs√µes",
    "href": "semanas/Aula07.html#fazendo-previs√µes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fazendo Previs√µes",
    "text": "Fazendo Previs√µes\n\nnovosdados &lt;- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.exp.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n4.189084 3.096010"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano",
    "href": "semanas/Aula07.html#tempo-mediano",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 &lt;-predict(leuc.exp.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n45.72161 15.32518 \n\nprev1[1]/prev1[2]\n\n       1 \n2.983431"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 &lt;-predict(leuc.exp.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n79.41687 26.61931 \n\nprev2[1]/prev2[2]\n\n       1 \n2.983431"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo",
    "href": "semanas/Aula07.html#verificando-o-modelo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\nsmoothSEcurve &lt;- function(yy, xx) {\n# usar depois de chamar um grafico\n# Ajusta um curva lowess curve com IC de 95%\n## Facilita a avalia√ß√£o dos res√≠duos\nxx.list &lt;- min(xx) + ((0:100)/100)*(max(xx) - min(xx))\nyy.xx &lt;- predict(loess(yy ~ xx), se=T,\nnewdata=data.frame(xx=xx.list))\nlines(yy.xx$fit ~ xx.list, lwd=2)\nlines(yy.xx$fit -\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\nlines(yy.xx$fit +\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\n}\n\n\nlibrary(car)\n\nCarregando pacotes exigidos: carData\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(leuc.exp.sel, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 16"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-weibull",
    "href": "semanas/Aula07.html#modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\nleuc.wei.comp &lt;- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"weibull\")\nsummary(leuc.wei.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.462      0.351 15.58 &lt; 2e-16\nsexo        -0.156      0.179 -0.87 0.38350\nlogwbc      -0.792      0.105 -7.54 4.8e-14\nRx          -0.722      0.201 -3.59 0.00034\nLog(scale)  -0.815      0.144 -5.65 1.6e-08\n\nScale= 0.443 \n\nWeibull distribution\nLoglik(model)= -89.7   Loglik(intercept only)= -116.4\n    Chisq= 53.42 on 3 degrees of freedom, p= 1.5e-11 \nNumber of Newton-Raphson Iterations: 7 \nn= 42 \n\n\n\nleuc.wei.sel &lt;- stepAIC(leuc.wei.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.wei.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.399      0.364 14.84 &lt; 2e-16\nlogwbc      -0.807      0.108 -7.45 9.7e-14\nRx          -0.659      0.189 -3.49 0.00049\nLog(scale)  -0.793      0.142 -5.58 2.5e-08\n\nScale= 0.452 \n\nWeibull distribution\nLoglik(model)= -90.1   Loglik(intercept only)= -116.4\n    Chisq= 52.68 on 2 degrees of freedom, p= 3.6e-12 \nNumber of Newton-Raphson Iterations: 7 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previs√µes-1",
    "href": "semanas/Aula07.html#fazendo-previs√µes-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fazendo Previs√µes",
    "text": "Fazendo Previs√µes\n\nnovosdados &lt;- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.wei.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.784108 3.125137"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-1",
    "href": "semanas/Aula07.html#tempo-mediano-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 &lt;-predict(leuc.wei.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n37.27311 19.28448 \n\nprev1[1]/prev1[2]\n\n       1 \n1.932804"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-1",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 &lt;-predict(leuc.wei.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n47.85133 24.75747 \n\nprev2[1]/prev2[2]\n\n       1 \n1.932804"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-1",
    "href": "semanas/Aula07.html#verificando-o-modelo-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(leuc.wei.sel, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1/leuc.wei.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 16"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-lognormal",
    "href": "semanas/Aula07.html#modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\nleuc.logn.comp &lt;- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"lognormal\")\nsummary(leuc.logn.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n              Value Std. Error     z       p\n(Intercept)  4.9975     0.3924 12.74 &lt; 2e-16\nsexo        -0.0947     0.2211 -0.43 0.66862\nlogwbc      -0.7051     0.1251 -5.64 1.7e-08\nRx          -0.8539     0.2311 -3.69 0.00022\nLog(scale)  -0.4424     0.1293 -3.42 0.00062\n\nScale= 0.642 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 43.08 on 3 degrees of freedom, p= 2.4e-09 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\n\n\nleuc.logn.sel &lt;- stepAIC(leuc.logn.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.logn.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n             Value Std. Error     z       p\n(Intercept)  4.982      0.394 12.65 &lt; 2e-16\nlogwbc      -0.716      0.123 -5.80 6.6e-09\nRx          -0.848      0.232 -3.66 0.00025\nLog(scale)  -0.437      0.129 -3.39 0.00070\n\nScale= 0.646 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 42.9 on 2 degrees of freedom, p= 4.8e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previs√µes-2",
    "href": "semanas/Aula07.html#fazendo-previs√µes-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fazendo Previs√µes",
    "text": "Fazendo Previs√µes\n\nnovosdados &lt;- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.logn.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.549821 2.702019"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-2",
    "href": "semanas/Aula07.html#tempo-mediano-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 &lt;-predict(leuc.logn.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n34.80708 14.90980 \n\nprev1[1]/prev1[2]\n\n      1 \n2.33451"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-2",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 &lt;-predict(leuc.logn.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n48.83742 20.91977 \n\nprev2[1]/prev2[2]\n\n      1 \n2.33451"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-2",
    "href": "semanas/Aula07.html#verificando-o-modelo-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(leuc.logn.sel, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"norm\",\nsd = leuc.logn.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 12"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-loglogistico",
    "href": "semanas/Aula07.html#modelo-loglogistico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Loglogistico",
    "text": "Modelo Loglogistico\n\nleuc.logl.comp &lt;- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"loglogistic\")\nsummary(leuc.logl.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n              Value Std. Error     z       p\n(Intercept)  5.0190     0.3518 14.27 &lt; 2e-16\nsexo        -0.0408     0.2027 -0.20 0.84065\nlogwbc      -0.7278     0.1098 -6.63 3.4e-11\nRx          -0.7494     0.2133 -3.51 0.00044\nLog(scale)  -1.0894     0.1509 -7.22 5.1e-13\n\nScale= 0.336 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.08 on 3 degrees of freedom, p= 5.5e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\n\n\nleuc.logl.sel &lt;- stepAIC(leuc.logl.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.logl.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n             Value Std. Error     z       p\n(Intercept)  5.008      0.348 14.40 &lt; 2e-16\nlogwbc      -0.733      0.108 -6.81 9.8e-12\nRx          -0.743      0.210 -3.54   4e-04\nLog(scale)  -1.089      0.151 -7.22 5.3e-13\n\nScale= 0.337 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.04 on 2 degrees of freedom, p= 1e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previs√µes-3",
    "href": "semanas/Aula07.html#fazendo-previs√µes-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fazendo Previs√µes",
    "text": "Fazendo Previs√µes\n\nnovosdados &lt;- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.logl.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.542894 2.800346"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-3",
    "href": "semanas/Aula07.html#tempo-mediano-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 &lt;-predict(leuc.logl.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n34.56680 16.45034 \n\nprev1[1]/prev1[2]\n\n       1 \n2.101282"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-3",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 &lt;-predict(leuc.logl.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n45.97221 21.87818 \n\nprev2[1]/prev2[2]\n\n       1 \n2.101282"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-3",
    "href": "semanas/Aula07.html#verificando-o-modelo-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(leuc.logl.sel, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"logis\",\nscale = leuc.logl.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 12"
  },
  {
    "objectID": "semanas/Aula07.html#compara√ß√£o-dos-modelos",
    "href": "semanas/Aula07.html#compara√ß√£o-dos-modelos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos modelos",
    "text": "Compara√ß√£o dos modelos\n\ntab.exp &lt;- summary(leuc.exp.sel)\ntab.exp\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"exponential\")\n             Value Std. Error     z       p\n(Intercept)  5.958      0.699  8.52 &lt; 2e-16\nlogwbc      -0.884      0.216 -4.10 4.2e-05\nRx          -1.093      0.413 -2.65  0.0082\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.8   Loglik(intercept only)= -116.8\n    Chisq= 31.99 on 2 degrees of freedom, p= 1.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42 \n\ntab.wei &lt;- summary(leuc.wei.sel)\ntab.wei\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.399      0.364 14.84 &lt; 2e-16\nlogwbc      -0.807      0.108 -7.45 9.7e-14\nRx          -0.659      0.189 -3.49 0.00049\nLog(scale)  -0.793      0.142 -5.58 2.5e-08\n\nScale= 0.452 \n\nWeibull distribution\nLoglik(model)= -90.1   Loglik(intercept only)= -116.4\n    Chisq= 52.68 on 2 degrees of freedom, p= 3.6e-12 \nNumber of Newton-Raphson Iterations: 7 \nn= 42 \n\nTRV &lt;- 2*(tab.wei$loglik[1] - tab.exp$loglik[1])\npchisq(TRV, 1, lower.tail = F)\n\n[1] 0.3953251\n\ntab.ln &lt;- summary(leuc.logn.sel)\ntab.ln\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n             Value Std. Error     z       p\n(Intercept)  4.982      0.394 12.65 &lt; 2e-16\nlogwbc      -0.716      0.123 -5.80 6.6e-09\nRx          -0.848      0.232 -3.66 0.00025\nLog(scale)  -0.437      0.129 -3.39 0.00070\n\nScale= 0.646 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 42.9 on 2 degrees of freedom, p= 4.8e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\ntab.ll &lt;- summary(leuc.logl.sel)\ntab.ll\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n             Value Std. Error     z       p\n(Intercept)  5.008      0.348 14.40 &lt; 2e-16\nlogwbc      -0.733      0.108 -6.81 9.8e-12\nRx          -0.743      0.210 -3.54   4e-04\nLog(scale)  -1.089      0.151 -7.22 5.3e-13\n\nScale= 0.337 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.04 on 2 degrees of freedom, p= 1e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\naic.exp &lt;- -2*tab.exp$loglik[1] + 2*3\naic.exp\n\n[1] 239.5333\n\naic.wei &lt;- -2*tab.wei$loglik[1] + 2*4\naic.wei\n\n[1] 240.8108\n\naic.ln &lt;- -2*tab.ln$loglik[1] + 2*4\naic.ln\n\n[1] 238.786\n\naic.ll &lt;- -2*tab.ll$loglik[1] + 2*4\naic.ll\n\n[1] 238.7022\n\naic &lt;- c(aic.exp, aic.wei, aic.ln, aic.ll)\ndelta.aic &lt;- aic - min(aic)\ndelta.aic\n\n[1] 0.83108732 2.10858745 0.08373248 0.00000000\n\npeso.aic &lt;- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1\n\nmodelos &lt;- data.frame(modelos=c(\"Exponencial\", \"Weibull\",\n                                \"Lognormal\", \"Loglogistico\"),\n                      p_Akaike = peso.aic)\ngt::gt(modelos)\n\n\n\n\n\n\n\n\nmodelos\np_Akaike\n\n\n\n\nExponencial\n0.2224093\n\n\nWeibull\n0.1174214\n\n\nLognormal\n0.3231759\n\n\nLoglogistico\n0.3369933"
  },
  {
    "objectID": "semanas/Aula06x.html#modelo-tfa-exponencial",
    "href": "semanas/Aula06x.html#modelo-tfa-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo TFA Exponencial",
    "text": "Modelo TFA Exponencial\nO conjunto de dados carregados a seguir s√£o de 238 pacientes viciados com hero√≠na.\nOs pacientes foram tratados em duas cl√≠nicas (1 e 2), al√©m disso foram coletadas informa√ß√µes sobre dose de medicamento ministrado no tratamento e se o paciente j√° havia sido preso ou n√£o.\nOs tempos (survt) s√£o em dias e o evento analisado foi o tempo at√© a sa√≠da da cl√≠nica (status=1) ou o tempo at√© o t√©rmino de estudo (tempo censurado (status=0).\n\nid: Identifica√ß√£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo at√© a sa√≠da da cl√≠nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se j√° foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula06x.html#carregando-os-dados",
    "href": "semanas/Aula06x.html#carregando-os-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\nlibrary(readxl)\ndados &lt;- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nsummary(dados)\n```\n\n       id             clinic          status           survt       \n Min.   :  1.00   Min.   :1.000   Min.   :0.0000   Min.   :   2.0  \n 1st Qu.: 65.25   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.: 171.2  \n Median :131.50   Median :1.000   Median :1.0000   Median : 367.5  \n Mean   :134.13   Mean   :1.315   Mean   :0.6303   Mean   : 402.6  \n 3rd Qu.:205.75   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.: 585.5  \n Max.   :266.00   Max.   :2.000   Max.   :1.0000   Max.   :1076.0  \n     prison            dose      \n Min.   :0.0000   Min.   : 20.0  \n 1st Qu.:0.0000   1st Qu.: 50.0  \n Median :0.0000   Median : 60.0  \n Mean   :0.4664   Mean   : 60.4  \n 3rd Qu.:1.0000   3rd Qu.: 70.0  \n Max.   :1.0000   Max.   :110.0"
  },
  {
    "objectID": "semanas/Aula06x.html#avaliando-presen√ßa-de-dados-ausentes",
    "href": "semanas/Aula06x.html#avaliando-presen√ßa-de-dados-ausentes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando presen√ßa de dados ausentes",
    "text": "Avaliando presen√ßa de dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 238\n[1] 238"
  },
  {
    "objectID": "semanas/Aula06x.html#ajuste-do-modelo-exponencial",
    "href": "semanas/Aula06x.html#ajuste-do-modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo Exponencial",
    "text": "Ajuste do Modelo Exponencial\n\n```{r}\nTFAExp &lt;- survreg(Surv(survt, status) ~ clinic + prison + dose,\n                   dist = \"exponential\", \n                   data=dados)\nsummary(TFAExp)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + prison + dose, \n    data = dados, dist = \"exponential\")\n               Value Std. Error     z       p\n(Intercept)  3.68434    0.43072  8.55 &lt; 2e-16\nclinic       0.88058    0.21063  4.18 2.9e-05\nprison      -0.25265    0.16489 -1.53    0.13\ndose         0.02892    0.00614  4.71 2.5e-06\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -1094   Loglik(intercept only)= -1118.9\n    Chisq= 49.91 on 3 degrees of freedom, p= 8.3e-11 \nNumber of Newton-Raphson Iterations: 5 \nn= 238 \n\n\nA vari√°vel prison √© marginalmente significativa considerando um n√≠vel de signific√¢ncia de 0,10."
  },
  {
    "objectID": "semanas/Aula06x.html#modelo-reajustado",
    "href": "semanas/Aula06x.html#modelo-reajustado",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Reajustado",
    "text": "Modelo Reajustado\n\n```{r}\nTFAExp1 &lt;- survreg(Surv(survt, status) ~ clinic + dose,\n                   dist = \"exponential\", \n                   data=dados)\nsummary(TFAExp1)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + dose, data = dados, \n    dist = \"exponential\")\n              Value Std. Error    z       p\n(Intercept) 3.64522    0.42393 8.60 &lt; 2e-16\nclinic      0.85494    0.21014 4.07 4.7e-05\ndose        0.02825    0.00606 4.66 3.2e-06\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -1095.1   Loglik(intercept only)= -1118.9\n    Chisq= 47.58 on 2 degrees of freedom, p= 4.7e-11 \nNumber of Newton-Raphson Iterations: 5 \nn= 238 \n\n\nModelo sem a vari√°vel prison."
  },
  {
    "objectID": "semanas/Aula06x.html#m√©todo-de-kaplan-meier",
    "href": "semanas/Aula06x.html#m√©todo-de-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de Kaplan-Meier",
    "text": "M√©todo de Kaplan-Meier\n\n```{r}\najusteKM &lt;- survfit(Surv(survt, status) ~ clinic, data = dados)\nplot(ajusteKM, xlab=\"T(dias)\",ylab=\"S(t)\", lty=1:2, col = 1:2) \nlegend(\"topright\", bty = \"n\", lty = 1:2, col = 1:2,\nlegend = sprintf(\"clinic %d\", 1:2))\n```"
  },
  {
    "objectID": "semanas/Aula06x.html#avalia√ß√£o-dos-resultados",
    "href": "semanas/Aula06x.html#avalia√ß√£o-dos-resultados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o dos resultados",
    "text": "Avalia√ß√£o dos resultados\n\n```{r}\ncoefExp &lt;- coef(TFAExp1)\nexp(coefExp[2])\nexp(coefExp[3])\n```\n\n  clinic \n2.351231 \n   dose \n1.02865 \n\n\nA mudan√ßa da clinica 1 para a clinica 2 teve um fator de acelera√ß√£o de 2,35, ou seja, na mesma probabilidade o tempo at√© o evento na clinica 2 √© 2,35 vezes maior do que na cl√≠nica 1.\nA mudan√ßa na dose aumentou ligeiramente o tempo at√© o evento, o fator de acelera√ß√£o foi de 1,02"
  },
  {
    "objectID": "semanas/Aula06x.html#novos-dados",
    "href": "semanas/Aula06x.html#novos-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Novos dados",
    "text": "Novos dados\n\n```{r}\nnovosdados &lt;- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = c(\"no\", \"no\"), dose = c(60, 60))\nprevis &lt;- predict(TFAExp1, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis &lt;- predict(TFAExp1, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n144.5357 339.8368 \n       2 \n2.351231 \n       1        2 \n251.0535 590.2849 \n       2 \n2.351231 \n\n\nVeja que no modelo TFA a proporcionalidade √© verificada em diferentes quantis da curva de sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula05.html#modelos-param√©tricos",
    "href": "semanas/Aula05.html#modelos-param√©tricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos",
    "text": "Modelos Param√©tricos\nNeste exemplo s√£o considerados os tempos de reincid√™ncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser.\nNesta apresenta√ß√£o vamos verificar graficamente atrav√©s de gr√°ficos Q-Q se os modelos exponencial, Weibull, lognormal e log-log√≠stico parecem ser adequados.\nAqui vamos utilizar as fun√ß√µes existentes no pacote survival.\nPara ajustar um modelo param√©trico usamos a fun√ß√£o survreg."
  },
  {
    "objectID": "semanas/Aula05.html#metodo-kaplan-meier",
    "href": "semanas/Aula05.html#metodo-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Metodo Kaplan-Meier",
    "text": "Metodo Kaplan-Meier\n\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    3     20       1   0.9500  0.0487      0.85913        1.000\n    5     19       1   0.9000  0.0671      0.77767        1.000\n    6     18       1   0.8500  0.0798      0.70707        1.000\n    7     17       1   0.8000  0.0894      0.64257        0.996\n    8     16       1   0.7500  0.0968      0.58233        0.966\n    9     15       1   0.7000  0.1025      0.52541        0.933\n   10     14       1   0.6500  0.1067      0.47124        0.897\n   12     12       1   0.5958  0.1107      0.41402        0.857\n   15     11       1   0.5417  0.1131      0.35976        0.816\n   18      9       1   0.4815  0.1154      0.30096        0.770\n   19      8       1   0.4213  0.1156      0.24601        0.721\n   20      7       1   0.3611  0.1137      0.19481        0.669\n   22      6       1   0.3009  0.1095      0.14745        0.614\n   25      5       1   0.2407  0.1028      0.10422        0.556\n   28      4       1   0.1806  0.0931      0.06573        0.496\n   30      3       1   0.1204  0.0792      0.03317        0.437\n   40      2       1   0.0602  0.0581      0.00907        0.399"
  },
  {
    "objectID": "semanas/Aula05.html#curva-de-sobreviv√™ncia-n√£o-param√©trica",
    "href": "semanas/Aula05.html#curva-de-sobreviv√™ncia-n√£o-param√©trica",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia N√£o param√©trica",
    "text": "Curva de Sobreviv√™ncia N√£o param√©trica"
  },
  {
    "objectID": "semanas/Aula05.html#modelos-param√©tricos-1",
    "href": "semanas/Aula05.html#modelos-param√©tricos-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos",
    "text": "Modelos Param√©tricos\n`"
  },
  {
    "objectID": "semanas/Aula05.html#avalia√ß√£o-do-modelo-weibull",
    "href": "semanas/Aula05.html#avalia√ß√£o-do-modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo Weibull",
    "text": "Avalia√ß√£o do Modelo Weibull\n\n\n\n                     2.5 %    97.5 %\n(Intercept)      -4.763998 -4.318050\nlog(tab.np$time)  1.442427  1.609615"
  },
  {
    "objectID": "semanas/Aula05.html#avalia√ß√£o-do-modelo-lognormal",
    "href": "semanas/Aula05.html#avalia√ß√£o-do-modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo Lognormal",
    "text": "Avalia√ß√£o do Modelo Lognormal"
  },
  {
    "objectID": "semanas/Aula05.html#avalia√ß√£o-do-modelo-loglog√≠stico",
    "href": "semanas/Aula05.html#avalia√ß√£o-do-modelo-loglog√≠stico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo LogLog√≠stico",
    "text": "Avalia√ß√£o do Modelo LogLog√≠stico"
  },
  {
    "objectID": "semanas/Aula05.html#teste-de-raz√£o-de-verossimilhan√ßa",
    "href": "semanas/Aula05.html#teste-de-raz√£o-de-verossimilhan√ßa",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste de Raz√£o de Verossimilhan√ßa",
    "text": "Teste de Raz√£o de Verossimilhan√ßa\nNo n√≠vel de signific√¢ncia de ùõº=0,05 eu rejeito a hip√≥tese de que o parametro de forma seja igual a 1.\n\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"exponential\")\n            Value Std. Error    z      p\n(Intercept) 3.016      0.243 12.4 &lt;2e-16\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -68.3   Loglik(intercept only)= -68.3\nNumber of Newton-Raphson Iterations: 4 \nn= 20 \n\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"weibull\")\n             Value Std. Error    z      p\n(Intercept)  3.061      0.160 19.1 &lt;2e-16\nLog(scale)  -0.434      0.189 -2.3  0.022\n\nScale= 0.648 \n\nWeibull distribution\nLoglik(model)= -66.1   Loglik(intercept only)= -66.1\nNumber of Newton-Raphson Iterations: 6 \nn= 20 \n\n\n[1] 0.03853913"
  },
  {
    "objectID": "semanas/Aula05.html#comparando-modelos-atrav√©s-do-aic",
    "href": "semanas/Aula05.html#comparando-modelos-atrav√©s-do-aic",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando modelos atrav√©s do AIC",
    "text": "Comparando modelos atrav√©s do AIC\n\ntab.exp &lt;- summary(ajustExp)\ntab.wei &lt;- summary(ajustWei)\ntab.ln &lt;- summary(ajustLog)\ntab.ll &lt;- summary(ajustLogl)\naic.exp &lt;- -2*tab.exp$loglik[1] + 2*1\naic.exp\n\n[1] 138.5478\n\naic.wei &lt;- -2*tab.wei$loglik[1] + 2*2\naic.wei\n\n[1] 136.2667\n\naic.ln &lt;- -2*tab.ln$loglik[1] + 2*2\naic.ln\n\n[1] 135.4798\n\naic.ll &lt;- -2*tab.ll$loglik[1] + 2*2\naic.ll\n\n[1] 136.0611\n\naic &lt;- c(aic.exp, aic.wei, aic.ln, aic.ll)\ndelta.aic &lt;- aic - min(aic)\ndelta.aic\n\n[1] 3.0679853 0.7869174 0.0000000 0.5812562\n\npeso.aic &lt;- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1"
  },
  {
    "objectID": "semanas/Aula05.html#comparando-modleos-atrav√©s-do-peso-de-akaike",
    "href": "semanas/Aula05.html#comparando-modleos-atrav√©s-do-peso-de-akaike",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando modleos atrav√©s do Peso de Akaike",
    "text": "Comparando modleos atrav√©s do Peso de Akaike\n\n\n\n\n\n\n\n\n\nmodelos\np_Akaike\n\n\n\n\nExponencial\n0.08175044\n\n\nWeibull\n0.25575120\n\n\nLognormal\n0.37904837\n\n\nLoglogistico\n0.28344999"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos",
    "href": "semanas/Aula03.html#modelos-param√©tricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos",
    "text": "Modelos Param√©tricos\nNesta apresenta√ß√£o vamos ver passo a passo como obter a fun√ß√£o taxa de falhas e de sobreviv√™ncia para alguns modelos de probabilidade.\nAqui vamos utilizar as fun√ß√µes existentes no pacote stats que vem com a instala√ß√£o padr√£o do R."
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---exponencial",
    "href": "semanas/Aula03.html#modelos-param√©tricos---exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Exponencial",
    "text": "Modelos Param√©tricos - Exponencial\n\n\nexpHaz &lt;- function(x, rate) { \n  dexp(x, rate=rate)/\n    pexp(x, rate=rate, lower.tail=F)\n}\ncurve(expHaz(x, rate=0.5), from=0, to=50,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"red\", ylim=c(0,1))\ncurve(expHaz(x, rate=0.3), from=0, to=50, \n      ylab=\"h(t)\", xlab=\"Tempo\",\n      col=\"blue\", add = T)\ncurve(expHaz(x, rate=0.1), from=0, to=50,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(alfa, \" = \", 2)),\n                  expression(paste(alfa, \" = \", 3)),\n                  expression(paste(alfa, \" = \", 10))),\n                   lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---exponencial",
    "href": "semanas/Aula03.html#taxa-de-falhas---exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas - Exponencial",
    "text": "Taxa de Falhas - Exponencial"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---exponencial-1",
    "href": "semanas/Aula03.html#modelos-param√©tricos---exponencial-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Exponencial",
    "text": "Modelos Param√©tricos - Exponencial\n\n\nexpSurv &lt;- function(x, rate) { \n  pexp(x, rate=rate, lower.tail=F)\n}\ncurve(expSurv(x, rate=0.5), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(expSurv(x, rate=0.3), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"blue\", add=T)\ncurve(expSurv(x, rate=0.1), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(alfa, \" = \", 2)),\n                  expression(paste(alfa, \" = \", 3)),\n                  expression(paste(alfa, \" = \", 10))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobreviv√™ncia---exponencial",
    "href": "semanas/Aula03.html#curva-de-sobreviv√™ncia---exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia - Exponencial",
    "text": "Curva de Sobreviv√™ncia - Exponencial"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---weibull",
    "href": "semanas/Aula03.html#modelos-param√©tricos---weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Weibull",
    "text": "Modelos Param√©tricos - Weibull\n\n\nweibHaz &lt;- function(x, shape, scale) { \n  dweibull(x, shape=shape, scale=scale)/\n  pweibull(x, shape=shape, scale=scale,\n           lower.tail=F)\n}\ncurve(weibHaz(x, shape=1.5, scale=1), \n      from=0, to=2,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(weibHaz(x, shape=1, scale=1), \n      from=0, to=2, \n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"blue\", \n      add = T)\ncurve(weibHaz(x, shape=0.75, scale=1), \n      from=0, to=2,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"black\", \n      add=T)\nlegend(\"topright\", \n   legend = c(expression(paste(beta, \" = \", 1.5,\" \",\n                                   alfa, \" = \", 1)),\n              expression(paste(beta, \" = \", 1,\" \",\n                                    alfa, \" = \", 1)),\n              expression(paste(beta, \" = \", 0.75,\" \",\n                                    alfa, \" = \", 1))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---weibull",
    "href": "semanas/Aula03.html#taxa-de-falhas---weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas - Weibull",
    "text": "Taxa de Falhas - Weibull"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---weibull-1",
    "href": "semanas/Aula03.html#modelos-param√©tricos---weibull-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Weibull",
    "text": "Modelos Param√©tricos - Weibull\n\n\nweibSurv &lt;- function(x, shape, scale) {\n  pweibull(x, shape=shape, scale=scale,\n           lower.tail=F)\n}\ncurve(weibSurv(x, shape=1.5, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(weibSurv(x, shape=1, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"blue\", add=T)\ncurve(weibSurv(x, shape=0.75, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(beta, \" = \", 1.5,\" \",\n                                       alfa, \" = \", 1)),\n                  expression(paste(beta, \" = \", 1,\" \",\n                                       alfa, \" = \", 1)),\n         expression(paste(beta, \" = \", 0.75,\" \",\n                                      alfa, \" = \", 1))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobreviv√™ncia---weibull",
    "href": "semanas/Aula03.html#curva-de-sobreviv√™ncia---weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia - Weibull",
    "text": "Curva de Sobreviv√™ncia - Weibull"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---lognormal",
    "href": "semanas/Aula03.html#modelos-param√©tricos---lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Lognormal",
    "text": "Modelos Param√©tricos - Lognormal\n\n\nlogHaz &lt;- function(x, meanlog, sdlog) {\n  dlnorm(x, meanlog=meanlog, sdlog=sdlog)/\n  plnorm(x, meanlog=meanlog, sdlog=sdlog, \n         lower.tail=F)\n}\ncurve(logHaz(x, meanlog=0, sdlog=0.5), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"log(Tempo)\", \n      col=\"red\", ylim=c(0,3.0))\ncurve(logHaz(x, meanlog=1, sdlog=0.7), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(logHaz(x, meanlog=1, sdlog=1.0), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", \n      col=\"black\", add=T)\nlegend(\"topright\", c(\"lnorm(0,0.5)\", \"lnorm(1,0.7)\", \n                     \"lnorm(1,1)\"), lty=1, \n       col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---lognormal",
    "href": "semanas/Aula03.html#taxa-de-falhas---lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas - Lognormal",
    "text": "Taxa de Falhas - Lognormal"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---lognormal-1",
    "href": "semanas/Aula03.html#modelos-param√©tricos---lognormal-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Lognormal",
    "text": "Modelos Param√©tricos - Lognormal\n\n\nlogSurv &lt;- function(x, meanlog, sdlog) {\n  plnorm(x, meanlog=meanlog, sdlog=sdlog, \n         lower.tail=F)\n}\ncurve(logSurv(x, meanlog=0, sdlog=0.5), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\",\n      col=\"red\")\ncurve(logSurv(x, meanlog=1, sdlog=0.7), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(logSurv(x, meanlog=1, sdlog=1.0),\n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\",\n      col=\"black\", add=T)\nlegend(\"topright\", c(\"lnorm(0,0.5)\", \n                     \"lnorm(1,0.7)\", \n                     \"lnorm(1,1)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobreviv√™ncia---lognormal",
    "href": "semanas/Aula03.html#curva-de-sobreviv√™ncia---lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia - Lognormal",
    "text": "Curva de Sobreviv√™ncia - Lognormal"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---loglogistico",
    "href": "semanas/Aula03.html#modelos-param√©tricos---loglogistico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Loglogistico",
    "text": "Modelos Param√©tricos - Loglogistico\n\n\nllogisHaz &lt;- function(x, alfa, beta) {\n  haz &lt;- beta/alfa*(x/alfa)^(beta-1)/(1+(x/alfa)^beta)  \n}\ncurve(llogisHaz(x, alfa=1, beta=0.5), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"red\")\ncurve(llogisHaz(x, alfa=1., beta=1), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"blue\", add=T)\ncurve(llogisHaz(x, alfa=1., beta=3), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"black\", add=T)\nlegend(\"topright\", c(\"llogis(1, 0.5)\", \"llogis(1,1)\",\n                     \"llogis(1,3)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---loglogistico",
    "href": "semanas/Aula03.html#taxa-de-falhas---loglogistico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas - Loglogistico",
    "text": "Taxa de Falhas - Loglogistico"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-param√©tricos---loglogistico-1",
    "href": "semanas/Aula03.html#modelos-param√©tricos---loglogistico-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos - Loglogistico",
    "text": "Modelos Param√©tricos - Loglogistico\n\n\nllogisSurv &lt;- function(x, alfa, beta) {\n          surv &lt;- 1/(1+(x/alfa)^beta)  \n}\ncurve(llogisSurv(x, alfa=1, beta=0.5), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"red\", ylim=c(0,1))\ncurve(llogisSurv(x, alfa=1, beta=1), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(llogisSurv(x, alfa=1, beta=3), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"black\", add=T)\nlegend(\"topright\", c(\"llogis(1, 0.5)\", \n                     \"llogis(1,1)\", \n                     \"llogis(1,3)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobreviv√™ncia---loglogistico",
    "href": "semanas/Aula03.html#curva-de-sobreviv√™ncia---loglogistico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia - Loglogistico",
    "text": "Curva de Sobreviv√™ncia - Loglogistico\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula02B.html#an√°lise-de-sobreviv√™ncia-1",
    "href": "semanas/Aula02B.html#an√°lise-de-sobreviv√™ncia-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (1)",
    "text": "An√°lise de Sobreviv√™ncia (1)\nNesta apresenta√ß√£o vamos ver passo a passo como obter uma estimativa da curva de sobreviv√™ncia atrav√©s do m√©todo de Kaplan-Meier.\nVamos inicialmente utilizar o pacote survival que √© a principal refer√™ncia em modelos de an√°lise de sobreviv√™ncia."
  },
  {
    "objectID": "semanas/Aula02B.html#an√°lise-de-sobreviv√™ncia-2",
    "href": "semanas/Aula02B.html#an√°lise-de-sobreviv√™ncia-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (2)",
    "text": "An√°lise de Sobreviv√™ncia (2)\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo √© verificar se o tratamento proposto, 6MP, tem efeito sobre a doen√ßa.\nExistem dois grupos de pacientes:\n\n21 receberam 6MP que √© um medicamento para tratar leucemia\nOs outros 21 receberam placebo.\n\n\nO evento falha aqui √© ocorrer uma reca√≠da na doen√ßa."
  },
  {
    "objectID": "semanas/Aula02B.html#m√©todo-kaplan-meier",
    "href": "semanas/Aula02B.html#m√©todo-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Kaplan-Meier",
    "text": "M√©todo Kaplan-Meier\n\nAjusteGrafico\n\n\n\n```{r}\nlibrary(survival)\ntempo&lt;- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus&lt;- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ntempo2&lt;- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2&lt;- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ntempo2g &lt;- c(tempo,tempo2)\nstatus2g &lt;- c(status,status2)\ngrupos &lt;- c(rep(1,21),rep(2,21))\ndados &lt;- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados)\n```\n\n\n\n\n```{r}\nplot(ajusteKM, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 2:3)\n```"
  },
  {
    "objectID": "semanas/Aula02B.html#m√©todo-kaplan-meier-1",
    "href": "semanas/Aula02B.html#m√©todo-kaplan-meier-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Kaplan-Meier",
    "text": "M√©todo Kaplan-Meier\n\n```{r}\nsummary(ajusteKM)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados)\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula02B.html#teste-do-log-rank",
    "href": "semanas/Aula02B.html#teste-do-log-rank",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste do log-rank",
    "text": "Teste do log-rank\n\n```{r}\nsurvdiff(Surv(tempos, status) ~ grupos, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21        9     19.3      5.46      16.8\ngrupos=2 21       21     10.7      9.77      16.8\n\n Chisq= 16.8  on 1 degrees of freedom, p= 4e-05"
  },
  {
    "objectID": "semanas/Aula02B.html#teste-do-log-rank-usando-pesos",
    "href": "semanas/Aula02B.html#teste-do-log-rank-usando-pesos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste do log-rank usando pesos",
    "text": "Teste do log-rank usando pesos\nQuando usamo rho=0, o teste √© identico ao log-rank padr√£o\n\n```{r}\n# rho=0 √© o teste de log-rank\nsurvdiff(Surv(tempos, status) ~ grupos, rho=0, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados, \n    rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21        9     19.3      5.46      16.8\ngrupos=2 21       21     10.7      9.77      16.8\n\n Chisq= 16.8  on 1 degrees of freedom, p= 4e-05"
  },
  {
    "objectID": "semanas/Aula02B.html#usando-pesos-de-petopeto-hf",
    "href": "semanas/Aula02B.html#usando-pesos-de-petopeto-hf",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Usando pesos de Peto&Peto (HF)",
    "text": "Usando pesos de Peto&Peto (HF)\nQuando usamo rho=1, ele se torna do teste de log-rank usando os pesos de Peto&Peto\n\n```{r}\n# rho=1 √© o teste de Harrigton-Fleming\nsurvdiff(Surv(tempos, status) ~ grupos, rho=1, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados, \n    rho = 1)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21     5.12    12.00      3.94      14.5\ngrupos=2 21    14.55     7.68      6.16      14.5\n\n Chisq= 14.5  on 1 degrees of freedom, p= 1e-04"
  },
  {
    "objectID": "semanas/Aula02B.html#teste-do-log-rank-para-mais-de-2-grupos",
    "href": "semanas/Aula02B.html#teste-do-log-rank-para-mais-de-2-grupos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste do Log-rank para mais de 2 grupos",
    "text": "Teste do Log-rank para mais de 2 grupos\nVamos usar neste exemplo os dados de um estudo experimental com camundongos conduzido no Centro de Pesquisas Ren√© Rachou, FioCruz, MG.\n44 camundongos foram infectados pela malaria (Plasmodium berguei) e aleatoriamente alocados em tr√™s grupos:\nGrupo 1: Imunizados 30 dias antes da infec√ß√£o pela mal√°ria. Foram infetados tamb√©m por esquistossomose.\nGrupo 2: Controle (Somente infectado pela mal√°ria)\nGrupo 3: Infectado pela mal√°ria e ela esquistossomose."
  },
  {
    "objectID": "semanas/Aula02B.html#teste-do-log-rank-para-mais-de-2-grupos-1",
    "href": "semanas/Aula02B.html#teste-do-log-rank-para-mais-de-2-grupos-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste do Log-rank para mais de 2 grupos",
    "text": "Teste do Log-rank para mais de 2 grupos\nA resposta foi o tempo decorrido desde a infec√ß√£o pela mal√°ria at√© a morte do camundongo. O tempo foi medido em dias e o estudo foi acompanhado por 30 dias.\nVamos adotar um n√≠vel de signific√¢ncia de 0,05 para avaliar a diferen√ßa entre as curvas, ou seja, se a estat√≠stica de log-rank tiver um valor menor que 0,05, vamos rejeitar a hip√≥tese nula."
  },
  {
    "objectID": "semanas/Aula02B.html#m√©todo-kaplan-meier-2",
    "href": "semanas/Aula02B.html#m√©todo-kaplan-meier-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Kaplan-Meier",
    "text": "M√©todo Kaplan-Meier\n\nAjusteGrafico\n\n\n\n```{r}\ntempos &lt;- c(7,8,8,8,8,12,12,17,18,22,30,30,30,30,30,30,8,8,9,\n10,10,14,15,15,18,19,21,22,22,23,25,8,8,8,8,8,8,\n9,10,10,10,11,17,19)\nstatus &lt;- c(rep(1,10), rep(0,6), rep(1,15), rep(1,13))\ngrupos &lt;- c(rep(1,16), rep(2,15), rep(3,13))\ndados2 &lt;- data.frame(tempos, status, grupos)\najusteKM2&lt;- survfit(Surv(tempos, status) ~ grupos, data = dados2)\n```\n\n\n\n\nplot(ajusteKM2, xlab=\"T(dias)\",ylab=\"S(t)\", lty=1:3) \nlegend(\"topright\",c(\"G 1\",\"G 2\", \"G 3\"), lty = 1:3)"
  },
  {
    "objectID": "semanas/Aula02B.html#teste-do-log-rank-1",
    "href": "semanas/Aula02B.html#teste-do-log-rank-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste do log-rank",
    "text": "Teste do log-rank\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = dados2,  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados2, \n    rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10    17.00    2.8816    6.4111\ngrupos=2 15       15    14.51    0.0167    0.0317\ngrupos=3 13       13     6.49    6.5190   10.4447\n\n Chisq= 12.6  on 2 degrees of freedom, p= 0.002"
  },
  {
    "objectID": "semanas/Aula02B.html#obtendo-os-resultados-de-outra-forma",
    "href": "semanas/Aula02B.html#obtendo-os-resultados-de-outra-forma",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Obtendo os resultados de outra forma",
    "text": "Obtendo os resultados de outra forma\n\nteste_lr &lt;- survdiff(Surv(tempos, status) ~ grupos, data = dados2,  rho=0)\nw &lt;- teste_lr$obs[1:2] - teste_lr$exp[1:2]\nV &lt;- teste_lr$var[1:2,1:2]\nt(w) %*% solve(V) %*% w\n\n         [,1]\n[1,] 12.56497"
  },
  {
    "objectID": "semanas/Aula02B.html#avalia√ß√£o",
    "href": "semanas/Aula02B.html#avalia√ß√£o",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o",
    "text": "Avalia√ß√£o\nComo a hip√≥tese nula foi rejeitada precisamos avaliar se todas as curvas de sobreviv√™ncia s√£o diferentes. Para isto vamos fazer compara√ß√µes, duas a duas, utilizando o m√©todo de Bonferroni.\nComo existem tr√™s grupos, s√£o tr√™s as compara√ß√µes duas a duas.\nO n√≠vel de signific√¢ncia a ser adotado nestas compara√ß√µes √© de \\(\\alpha\\) = 0,05/3 = 0,017. Isto vai garantir uma conclus√£o geral ao n√≠vel m√°ximo de 0,05."
  },
  {
    "objectID": "semanas/Aula02B.html#grupos-1-e-2",
    "href": "semanas/Aula02B.html#grupos-1-e-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grupos 1 e 2",
    "text": "Grupos 1 e 2\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=3),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 3), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10     13.7      1.01      2.53\ngrupos=2 15       15     11.3      1.23      2.53\n\n Chisq= 2.5  on 1 degrees of freedom, p= 0.1"
  },
  {
    "objectID": "semanas/Aula02B.html#grupos-1-e-3",
    "href": "semanas/Aula02B.html#grupos-1-e-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grupos 1 e 3",
    "text": "Grupos 1 e 3\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=2),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 2), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10    15.34      1.86      7.86\ngrupos=3 13       13     7.66      3.72      7.86\n\n Chisq= 7.9  on 1 degrees of freedom, p= 0.005"
  },
  {
    "objectID": "semanas/Aula02B.html#grupos-2-e-3",
    "href": "semanas/Aula02B.html#grupos-2-e-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grupos 2 e 3",
    "text": "Grupos 2 e 3\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=1),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 1), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=2 15       15    20.53      1.49      7.98\ngrupos=3 13       13     7.47      4.08      7.98\n\n Chisq= 8  on 1 degrees of freedom, p= 0.005"
  },
  {
    "objectID": "semanas/Aula02B.html#curva-de-sobreviv√™ncia-estratificada",
    "href": "semanas/Aula02B.html#curva-de-sobreviv√™ncia-estratificada",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia estratificada",
    "text": "Curva de Sobreviv√™ncia estratificada\nNeste exemplo temos 2 tratamentos, mas queremos controlar os resultados considerando uma vari√°vel categ√≥rica (sexo).\nO evento estudado √© o tempo at√© a reca√≠da de leucemia.\nO conjunto de dados tem os seguintes informa√ß√£o:\n\ntempo (semanas)\nstatus (0 = censura e 1 = falha)\nsexo (0 = mulher e 1 = homem)\nlogwbc = log do n√∫mero de c√©lulas brancas\nRx (0 = Novo tratamento e 1 = Placebo)\n\nVamos ver como isto pode ser feito na fun√ß√£o survfit."
  },
  {
    "objectID": "semanas/Aula02B.html#curva-de-sobreviv√™ncia-estratificada-1",
    "href": "semanas/Aula02B.html#curva-de-sobreviv√™ncia-estratificada-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia estratificada",
    "text": "Curva de Sobreviv√™ncia estratificada\n\nAjusteGrafico\n\n\n\n```{r}\nlibrary(readxl)\ndados_a &lt;- read_xlsx(\"anderson.xlsx\", col_names=T)\najusteKM_S &lt;- survfit(Surv(tempo, status) ~ Rx + strata(sexo), data = dados_a)\n```\n\n\n\n\nplot(ajusteKM_S, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=1:4) \nlegend(\"topright\",c(\"Rx=0 e Sexo=M\",\"Rx=0 e Sexo=F\", \"Rx=1 e Sexo=M\", \"Rx=1 e Sexo=F\"), lty = 1:4)\n\n\n\n\n\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula01.html#an√°lise-de-sobreviv√™ncia-1",
    "href": "semanas/Aula01.html#an√°lise-de-sobreviv√™ncia-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (1)",
    "text": "An√°lise de Sobreviv√™ncia (1)\nNesta apresenta√ß√£o vamos ver passo a passo como obter uma estimativa da curva de sobreviv√™ncia atrav√©s do m√©todo de Kaplan-Meier.\nVamos inicialmente utilizar o pacote survival que √© a principal refer√™ncia em modelos de an√°lise de sobreviv√™ncia."
  },
  {
    "objectID": "semanas/Aula01.html#an√°lise-de-sobreviv√™ncia-2",
    "href": "semanas/Aula01.html#an√°lise-de-sobreviv√™ncia-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (2)",
    "text": "An√°lise de Sobreviv√™ncia (2)\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo √© verificar se o tratamento proposto, 6MP, tem efeito sobre a doen√ßa.\nExistem dois grupos de pacientes:\n\n21 receberam 6MP que √© um medicamento para tratar leucemia\nOs outros 21 receberam placebo.\n\n\nO evento falha aqui √© ocorrer uma reca√≠da na doen√ßa."
  },
  {
    "objectID": "semanas/Aula01.html#m√©todo-de-km---6mp",
    "href": "semanas/Aula01.html#m√©todo-de-km---6mp",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de KM - 6MP",
    "text": "M√©todo de KM - 6MP\n\nAjuste KMGrafico\n\n\n\n```{r}\n#| code-line-numbers: \"|4-5|7\"\nlibrary(survival)\ntempos&lt;- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus&lt;- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0)\ndados &lt;- data.frame(tempos=tempos, status=status)\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\n```\n\n\n\n\nplot(ajusteKM, xlab=\"Tempo (semanas)\",ylab=\"S(t)\", lty=1, col=1, lwd=2 ) \nlegend(\"topright\",\"6-MP\", lty = 1, col = 1, lwd=2)"
  },
  {
    "objectID": "semanas/Aula01.html#m√©todo-de-km---6mp-1",
    "href": "semanas/Aula01.html#m√©todo-de-km---6mp-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de KM - 6MP",
    "text": "M√©todo de KM - 6MP\n\n```{r}\n#| code-line-numbers: \"|3\"\nsummary(ajusteKM)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807"
  },
  {
    "objectID": "semanas/Aula01.html#m√©todo-de-km---placebo",
    "href": "semanas/Aula01.html#m√©todo-de-km---placebo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de KM - Placebo",
    "text": "M√©todo de KM - Placebo\n\nAjusteGr√°fico\n\n\n\n```{r}\ntempo2&lt;- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2&lt;- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ndados2 &lt;- data.frame(tempos=tempo2, status=status2)\najusteKM2 &lt;- survfit(Surv(tempos, status) ~ 1, data=dados2)\n```\n\n\n\n\nplot(ajusteKM2, xlab=\"t(semanas)\",ylab=\"S(t)\", lty=1, col=2, lwd=2 ) \nlegend(\"topright\",\"Placebo\", lty = 1, col=2, lwd=2)"
  },
  {
    "objectID": "semanas/Aula01.html#m√©todo-de-km---placebo-1",
    "href": "semanas/Aula01.html#m√©todo-de-km---placebo-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de KM - Placebo",
    "text": "M√©todo de KM - Placebo\n\n```{r}\nsummary(ajusteKM2)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados2)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#an√°lise-conjunta",
    "href": "semanas/Aula01.html#an√°lise-conjunta",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise conjunta",
    "text": "An√°lise conjunta\n\nAjuste conjuntoGr√°fico\n\n\n\ntempo2g &lt;- c(tempos,tempo2)\nstatus2g &lt;- c(status,status2)\ngrupos &lt;- c(rep(1,21),rep(2,21))\ndados3 &lt;- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM3 &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados3)\n\n\n\n\nplot(ajusteKM3, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=1, \n     col=c(1,2), lwd=2, conf.int=0.95) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 1:1, col=c(1,2), lwd=2)"
  },
  {
    "objectID": "semanas/Aula01.html#m√©todo-de-km---6mp-e-placebo",
    "href": "semanas/Aula01.html#m√©todo-de-km---6mp-e-placebo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de KM - 6MP e Placebo",
    "text": "M√©todo de KM - 6MP e Placebo\n\nsummary(ajusteKM3)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3)\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#diferentes-tipos-de-intervalo-de-confian√ßa",
    "href": "semanas/Aula01.html#diferentes-tipos-de-intervalo-de-confian√ßa",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diferentes Tipos de Intervalo de Confian√ßa",
    "text": "Diferentes Tipos de Intervalo de Confian√ßa\n\ntempo2g &lt;- c(tempos,tempo2)\nstatus2g &lt;- c(status,status2)\ngrupos &lt;- c(rep(1,21),rep(2,21))\ndados3 &lt;- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM4 &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"plain\")"
  },
  {
    "objectID": "semanas/Aula01.html#ic-pleno-aproxima√ß√£o-pela-normal",
    "href": "semanas/Aula01.html#ic-pleno-aproxima√ß√£o-pela-normal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "IC Pleno (Aproxima√ß√£o pela Normal)",
    "text": "IC Pleno (Aproxima√ß√£o pela Normal)\n\nsummary(ajusteKM4)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"plain\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.707        1.000\n    7     17       1    0.807  0.0869        0.636        0.977\n   10     15       1    0.753  0.0963        0.564        0.942\n   13     12       1    0.690  0.1068        0.481        0.900\n   16     11       1    0.627  0.1141        0.404        0.851\n   22      7       1    0.538  0.1282        0.286        0.789\n   23      6       1    0.448  0.1346        0.184        0.712\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641       0.7792        1.000\n    2     19       2   0.8095  0.0857       0.6416        0.977\n    3     17       1   0.7619  0.0929       0.5797        0.944\n    4     16       2   0.6667  0.1029       0.4650        0.868\n    5     14       2   0.5714  0.1080       0.3598        0.783\n    8     12       4   0.3810  0.1060       0.1733        0.589\n   11      8       2   0.2857  0.0986       0.0925        0.479\n   12      6       2   0.1905  0.0857       0.0225        0.358\n   15      4       1   0.1429  0.0764       0.0000        0.293\n   17      3       1   0.0952  0.0641       0.0000        0.221\n   22      2       1   0.0476  0.0465       0.0000        0.139\n   23      1       1   0.0000     NaN          NaN          NaN"
  },
  {
    "objectID": "semanas/Aula01.html#ic-log---padr√£o-do-r",
    "href": "semanas/Aula01.html#ic-log---padr√£o-do-r",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "IC log - Padr√£o do R",
    "text": "IC log - Padr√£o do R\n\najusteKM5 &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"log\")\nsummary(ajusteKM5)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#ic-log-log---kalbfleish-prentice",
    "href": "semanas/Aula01.html#ic-log-log---kalbfleish-prentice",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "IC log-log - Kalbfleish-Prentice",
    "text": "IC log-log - Kalbfleish-Prentice\n\najusteKM6 &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"log-log\")\nsummary(ajusteKM6)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"log-log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.620        0.952\n    7     17       1    0.807  0.0869        0.563        0.923\n   10     15       1    0.753  0.0963        0.503        0.889\n   13     12       1    0.690  0.1068        0.432        0.849\n   16     11       1    0.627  0.1141        0.368        0.805\n   22      7       1    0.538  0.1282        0.268        0.747\n   23      6       1    0.448  0.1346        0.188        0.680\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.67005        0.975\n    2     19       2   0.8095  0.0857      0.56891        0.924\n    3     17       1   0.7619  0.0929      0.51939        0.893\n    4     16       2   0.6667  0.1029      0.42535        0.825\n    5     14       2   0.5714  0.1080      0.33798        0.749\n    8     12       4   0.3810  0.1060      0.18307        0.578\n   11      8       2   0.2857  0.0986      0.11656        0.482\n   12      6       2   0.1905  0.0857      0.05948        0.377\n   15      4       1   0.1429  0.0764      0.03566        0.321\n   17      3       1   0.0952  0.0641      0.01626        0.261\n   22      2       1   0.0476  0.0465      0.00332        0.197\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#outra-forma-de-visualiza√ß√£o",
    "href": "semanas/Aula01.html#outra-forma-de-visualiza√ß√£o",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Outra forma de visualiza√ß√£o",
    "text": "Outra forma de visualiza√ß√£o\n\nSurvminerGr√°fico\n\n\n\nlibrary(survminer)\ndados &lt;- data.frame(tempo=tempo2g, status=status2g, grupo= grupos)\najusteKM4 &lt;- survfit(Surv(tempo2g, status2g) ~ grupo, data= dados, conf.type=\"log-log\")\ngraf &lt;- ggsurvplot(ajusteKM4, data = dados, \n           risk.table = TRUE, \n           pval = FALSE, \n           conf.int = TRUE, \n           xlim = c(0,40), \n           xlab = \"Tempo em meses\", \n           ylab = \"S(t)\",\n           break.time.by = 10, \n           ggtheme = theme_light(), \n           risk.table.y.text.col = T, risk.table.y.text = FALSE \n)"
  },
  {
    "objectID": "acesso-rstudio.html",
    "href": "acesso-rstudio.html",
    "title": "RStudio Cloud",
    "section": "",
    "text": "Para acessar as tarefas no RStudio Cloud, abra uma conta gratuita no mesmo e acesse o link abaixo\nRStudio"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Bom dia / Boa tarde / Boa Noite,\nSou o Professor Ricardo Accioly e esta √© a p√°gina principal do site da disciplina An√°lise de Sobreviv√™ncia IME05-12532 do Departamento de Estat√≠stica da UERJ.\nEste site foi constru√≠do usando Quarto e foi baseado em diversas fontes de informa√ß√£o obtidas na internet.\nSeguem algumas refer√™ncias √∫teis para o Quarto:\nQuarto\nCurso da Duke University\nComo criar um blog com o Quarto\nWebnar do Quarto"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IME05-12532 - An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Bom dia / Boa tarde / Boa Noite,\nAqui voc√™s v√£o encontrar alguns dos exemplos apresentados em aula, com uso do R. O objetivo √© mostrar as possibilidades de aplica√ß√£o do R nesta disciplina.\nOs c√≥digos apresentados em aula ser√£o colocado por aqui tamb√©m.\n[üìñ] Aula01\n[üìñ] Aula02A\n[üìñ] Aula02B\n[üìñ] Aula02C\n[üìñ] Aula03\n[üìñ] Aula04\n[üìñ] Aula05\n[üìñ] Aula06\n[üìñ] TFA1\n[üìñ] TFA2\n[üìñ] TFA3\n[üìñ] Cox 1\n[üìñ] Cox 2\n[üìñ] Cox 3\n[üìñ] Cox 4\n[üìñ] Cox 5"
  },
  {
    "objectID": "semanas/Aula02A.html#an√°lise-de-sobreviv√™ncia-1",
    "href": "semanas/Aula02A.html#an√°lise-de-sobreviv√™ncia-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (1)",
    "text": "An√°lise de Sobreviv√™ncia (1)\nNesta apresenta√ß√£o vamos ver passo a passo como obter uma estimativa da curva de sobreviv√™ncia atrav√©s do m√©todo de Kaplan-Meier.\nVamos inicialmente utilizar o pacote survival que √© a principal refer√™ncia em modelos de an√°lise de sobreviv√™ncia."
  },
  {
    "objectID": "semanas/Aula02A.html#an√°lise-de-sobreviv√™ncia-2",
    "href": "semanas/Aula02A.html#an√°lise-de-sobreviv√™ncia-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (2)",
    "text": "An√°lise de Sobreviv√™ncia (2)\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo √© verificar se o tratamento proposto, 6MP, tem efeito sobre a doen√ßa.\nExistem dois grupos de pacientes:\n\n21 receberam 6MP que √© um medicamento para tratar leucemia\nOs outros 21 receberam placebo.\n\n\nO evento falha aqui √© ocorrer uma reca√≠da na doen√ßa."
  },
  {
    "objectID": "semanas/Aula02A.html#m√©todo-kaplan-meier",
    "href": "semanas/Aula02A.html#m√©todo-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Kaplan-Meier",
    "text": "M√©todo Kaplan-Meier\n\nAjusteGrafico\n\n\n\n```{r}\nlibrary(survival)\ntempo&lt;- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus&lt;- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ntempo2&lt;- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2&lt;- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ntempo2g &lt;- c(tempo,tempo2)\nstatus2g &lt;- c(status,status2)\ngrupos &lt;- c(rep(1,21),rep(2,21))\ndados &lt;- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados, conf.type=\"log-log\")\n```"
  },
  {
    "objectID": "semanas/Aula02A.html#m√©todo-kaplan-meier-1",
    "href": "semanas/Aula02A.html#m√©todo-kaplan-meier-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Kaplan-Meier",
    "text": "M√©todo Kaplan-Meier\n\n```{r}\nsummary(ajusteKM)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados, \n    conf.type = \"log-log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.620        0.952\n    7     17       1    0.807  0.0869        0.563        0.923\n   10     15       1    0.753  0.0963        0.503        0.889\n   13     12       1    0.690  0.1068        0.432        0.849\n   16     11       1    0.627  0.1141        0.368        0.805\n   22      7       1    0.538  0.1282        0.268        0.747\n   23      6       1    0.448  0.1346        0.188        0.680\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.67005        0.975\n    2     19       2   0.8095  0.0857      0.56891        0.924\n    3     17       1   0.7619  0.0929      0.51939        0.893\n    4     16       2   0.6667  0.1029      0.42535        0.825\n    5     14       2   0.5714  0.1080      0.33798        0.749\n    8     12       4   0.3810  0.1060      0.18307        0.578\n   11      8       2   0.2857  0.0986      0.11656        0.482\n   12      6       2   0.1905  0.0857      0.05948        0.377\n   15      4       1   0.1429  0.0764      0.03566        0.321\n   17      3       1   0.0952  0.0641      0.01626        0.261\n   22      2       1   0.0476  0.0465      0.00332        0.197\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula02A.html#m√©todo-de-nelson-aalen",
    "href": "semanas/Aula02A.html#m√©todo-de-nelson-aalen",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo de Nelson-Aalen",
    "text": "M√©todo de Nelson-Aalen\n\ntempo&lt;- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus&lt;- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ntempo2&lt;- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2&lt;- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ntempo2g &lt;- c(tempo,tempo2)\nstatus2g &lt;- c(status,status2)\ngrupos &lt;- c(rep(1,21),rep(2,21))\ndados &lt;- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteNA &lt;- survfit(Surv(tempos, status)~grupos, data = dados, stype=2, ctype=1, conf.type=\"log-log\")"
  },
  {
    "objectID": "semanas/Aula02A.html#grafico-1",
    "href": "semanas/Aula02A.html#grafico-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grafico",
    "text": "Grafico\n\n```{r}\nplot(ajusteNA, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 2:3)\n```"
  },
  {
    "objectID": "semanas/Aula02A.html#m√©todo-nelson-aalen",
    "href": "semanas/Aula02A.html#m√©todo-nelson-aalen",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "M√©todo Nelson-Aalen",
    "text": "M√©todo Nelson-Aalen\n\n```{r}\nsummary(ajusteNA)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados, \n    stype = 2, ctype = 1, conf.type = \"log-log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.867  0.0715        0.642        0.955\n    7     17       1    0.817  0.0828        0.583        0.927\n   10     15       1    0.765  0.0927        0.522        0.895\n   13     12       1    0.704  0.1035        0.450        0.857\n   16     11       1    0.642  0.1111        0.386        0.814\n   22      7       1    0.557  0.1249        0.289        0.759\n   23      6       1    0.471  0.1317        0.211        0.696\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9092  0.0612     0.683312        0.976\n    2     19       2   0.8183  0.0821     0.585744        0.928\n    3     17       1   0.7716  0.0898     0.535382        0.898\n    4     16       2   0.6809  0.0995     0.445010        0.833\n    5     14       2   0.5903  0.1048     0.360455        0.762\n    8     12       4   0.4229  0.1030     0.223432        0.610\n   11      8       2   0.3294  0.0991     0.151236        0.521\n   12      6       2   0.2360  0.0902     0.088391        0.423\n   15      4       1   0.1838  0.0840     0.056501        0.368\n   17      3       1   0.1317  0.0745     0.030135        0.309\n   22      2       1   0.0799  0.0603     0.010694        0.245\n   23      1       1   0.0294  0.0368     0.000845        0.172\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula02A.html#ic-atrav√©s-da-normal",
    "href": "semanas/Aula02A.html#ic-atrav√©s-da-normal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "IC atrav√©s da Normal",
    "text": "IC atrav√©s da Normal\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados, conf.type=\"plain\")\nsummary(ajusteKM)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados, \n    conf.type = \"plain\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.707        1.000\n    7     17       1    0.807  0.0869        0.636        0.977\n   10     15       1    0.753  0.0963        0.564        0.942\n   13     12       1    0.690  0.1068        0.481        0.900\n   16     11       1    0.627  0.1141        0.404        0.851\n   22      7       1    0.538  0.1282        0.286        0.789\n   23      6       1    0.448  0.1346        0.184        0.712\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641       0.7792        1.000\n    2     19       2   0.8095  0.0857       0.6416        0.977\n    3     17       1   0.7619  0.0929       0.5797        0.944\n    4     16       2   0.6667  0.1029       0.4650        0.868\n    5     14       2   0.5714  0.1080       0.3598        0.783\n    8     12       4   0.3810  0.1060       0.1733        0.589\n   11      8       2   0.2857  0.0986       0.0925        0.479\n   12      6       2   0.1905  0.0857       0.0225        0.358\n   15      4       1   0.1429  0.0764       0.0000        0.293\n   17      3       1   0.0952  0.0641       0.0000        0.221\n   22      2       1   0.0476  0.0465       0.0000        0.139\n   23      1       1   0.0000     NaN          NaN          NaN"
  },
  {
    "objectID": "semanas/Aula02A.html#ic-usando-a-transforma√ß√£o-log-log",
    "href": "semanas/Aula02A.html#ic-usando-a-transforma√ß√£o-log-log",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "IC usando a transforma√ß√£o log-log",
    "text": "IC usando a transforma√ß√£o log-log\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ grupos, data=dados, conf.type=\"log-log\")\nsummary(ajusteKM)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados, \n    conf.type = \"log-log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.620        0.952\n    7     17       1    0.807  0.0869        0.563        0.923\n   10     15       1    0.753  0.0963        0.503        0.889\n   13     12       1    0.690  0.1068        0.432        0.849\n   16     11       1    0.627  0.1141        0.368        0.805\n   22      7       1    0.538  0.1282        0.268        0.747\n   23      6       1    0.448  0.1346        0.188        0.680\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.67005        0.975\n    2     19       2   0.8095  0.0857      0.56891        0.924\n    3     17       1   0.7619  0.0929      0.51939        0.893\n    4     16       2   0.6667  0.1029      0.42535        0.825\n    5     14       2   0.5714  0.1080      0.33798        0.749\n    8     12       4   0.3810  0.1060      0.18307        0.578\n   11      8       2   0.2857  0.0986      0.11656        0.482\n   12      6       2   0.1905  0.0857      0.05948        0.377\n   15      4       1   0.1429  0.0764      0.03566        0.321\n   17      3       1   0.0952  0.0641      0.01626        0.261\n   22      2       1   0.0476  0.0465      0.00332        0.197\n   23      1       1   0.0000     NaN           NA           NA\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula02C.html#an√°lise-de-sobreviv√™ncia-1",
    "href": "semanas/Aula02C.html#an√°lise-de-sobreviv√™ncia-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (1)",
    "text": "An√°lise de Sobreviv√™ncia (1)\nNesta apresenta√ß√£o vamos ver passo a passo como obter uma estimativa da curva de sobreviv√™ncia atrav√©s do m√©todo de Kaplan-Meier.\nVamos inicialmente utilizar o pacote survival que √© a principal refer√™ncia em modelos de an√°lise de sobreviv√™ncia."
  },
  {
    "objectID": "semanas/Aula02C.html#an√°lise-de-sobreviv√™ncia-2",
    "href": "semanas/Aula02C.html#an√°lise-de-sobreviv√™ncia-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "An√°lise de Sobreviv√™ncia (2)",
    "text": "An√°lise de Sobreviv√™ncia (2)\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo √© verificar se o tratamento proposto, 6MP, tem efeito sobre a doen√ßa.\nExistem dois grupos de pacientes:\n\n21 receberam 6MP que √© um medicamento para tratar leucemia\nOs outros 21 receberam placebo.\n\n\nO evento falha aqui √© ocorrer uma reca√≠da na doen√ßa."
  },
  {
    "objectID": "semanas/Aula02C.html#fun√ß√£o-taxa-de-falhas-e-quantis",
    "href": "semanas/Aula02C.html#fun√ß√£o-taxa-de-falhas-e-quantis",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fun√ß√£o taxa de falhas e quantis",
    "text": "Fun√ß√£o taxa de falhas e quantis\nVamos obter uma aproxima√ß√£o da fun√ß√£o taxa de falhas usando a fun√ß√£o density\nPosteriormente vamos obter o quantil usando uma fun√ß√£o do pacote survey"
  },
  {
    "objectID": "semanas/Aula02C.html#ht-n√£o-param√©trica---6mp",
    "href": "semanas/Aula02C.html#ht-n√£o-param√©trica---6mp",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "h(t) n√£o param√©trica - 6MP",
    "text": "h(t) n√£o param√©trica - 6MP\n\nCodigoGrafico\n\n\n\nlibrary(survival)\ntempo&lt;- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus&lt;- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ndados &lt;- data.frame(tempos=tempo, status=status)\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos,\nkernel = \"gaussian\", n = 100, from = 0, to = 35)\nlibrary(ggplot2)\ndata &lt;- data.frame(x=h$x, y=h$y)\n\n\n\n\nggplot(data, aes(x=x, y=y)) + geom_line() + scale_y_continuous(limits=c(0,0.20)) + theme_light() +\n  theme(axis.text = element_text(size = 12),\n        axis.title = element_text(size = 14)) +\n  labs(x = \"Tempo [semanas]\", y = \"Estimativa da taxa de falhas\", title = \"Estimativa da taxa de falhas - 6MP\")"
  },
  {
    "objectID": "semanas/Aula02C.html#ht-n√£o-param√©trica---placebo",
    "href": "semanas/Aula02C.html#ht-n√£o-param√©trica---placebo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "h(t) n√£o param√©trica - Placebo",
    "text": "h(t) n√£o param√©trica - Placebo\n\nCodigoGrafico\n\n\n\ntempo2&lt;- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2&lt;- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ndados &lt;- data.frame(tempos=tempo2, status=status2)\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos,\nkernel = \"gaussian\", n = 100, from = 0, to = 25)\ndata &lt;- data.frame(x=h$x, y=h$y)\n\n\n\n\nggplot(data, aes(x=x, y=y)) + geom_line() + scale_y_continuous(limits=c(0,0.20)) +  theme_light() +\n  theme(axis.text = element_text(size = 12),\n        axis.title = element_text(size = 14)) +\n  labs(x = \"Tempo [semanas]\", y = \"Estimativa da taxa de falhas\", title = \"Estimativa da taxa de falhas - Placebo\")"
  },
  {
    "objectID": "semanas/Aula02C.html#quantis-n√£o-param√©tricos",
    "href": "semanas/Aula02C.html#quantis-n√£o-param√©tricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis n√£o param√©tricos",
    "text": "Quantis n√£o param√©tricos\n\nlibrary(survey)\ndados_p &lt;- svydesign(ids = ~1, data=dados)\ndados_svykm &lt;- svykm(Surv(tempos, status) ~ 1, dados_p, se=TRUE)\nquantile(dados_svykm, 0.5, ci=TRUE)\n\n0.5 \n  8 \nattr(,\"ci\")\n    0.025 0.975\n0.5     5    12\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula04.html#modelos-param√©tricos",
    "href": "semanas/Aula04.html#modelos-param√©tricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos",
    "text": "Modelos Param√©tricos\nNeste exemplo s√£o considerados os tempos de reincid√™ncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser.\nVamos ver passo a passo como ajustar os modelos exponencial, Weibull e lognormal.\nAqui vamos utilizar as fun√ß√µes existentes no pacote survival.\nPara ajustar um modelo param√©trico usamo a fun√ß√£o survreg."
  },
  {
    "objectID": "semanas/Aula04.html#metodo-de-kaplan-meier",
    "href": "semanas/Aula04.html#metodo-de-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Metodo de Kaplan-Meier",
    "text": "Metodo de Kaplan-Meier\n\nlibrary(survival)\ntempos&lt;-c(3,5,6,7,8,9,10,10,12,15,15,18,19,20,22,25,28,30,40,45)\ncens&lt;-c(1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0)\ndados &lt;- data.frame(tempos=tempos, status=cens)\nekm &lt;- survfit(Surv(tempos,status)~1, data=dados)\nsummary(ekm)\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    3     20       1   0.9500  0.0487      0.85913        1.000\n    5     19       1   0.9000  0.0671      0.77767        1.000\n    6     18       1   0.8500  0.0798      0.70707        1.000\n    7     17       1   0.8000  0.0894      0.64257        0.996\n    8     16       1   0.7500  0.0968      0.58233        0.966\n    9     15       1   0.7000  0.1025      0.52541        0.933\n   10     14       1   0.6500  0.1067      0.47124        0.897\n   12     12       1   0.5958  0.1107      0.41402        0.857\n   15     11       1   0.5417  0.1131      0.35976        0.816\n   18      9       1   0.4815  0.1154      0.30096        0.770\n   19      8       1   0.4213  0.1156      0.24601        0.721\n   20      7       1   0.3611  0.1137      0.19481        0.669\n   22      6       1   0.3009  0.1095      0.14745        0.614\n   25      5       1   0.2407  0.1028      0.10422        0.556\n   28      4       1   0.1806  0.0931      0.06573        0.496\n   30      3       1   0.1204  0.0792      0.03317        0.437\n   40      2       1   0.0602  0.0581      0.00907        0.399"
  },
  {
    "objectID": "semanas/Aula04.html#curva-de-sobreviv√™ncia-n√£o-param√©trica",
    "href": "semanas/Aula04.html#curva-de-sobreviv√™ncia-n√£o-param√©trica",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia n√£o param√©trica",
    "text": "Curva de Sobreviv√™ncia n√£o param√©trica\n\nplot(ekm, xlab=\"Tempo (meses)\",ylab=\"S(t) estimada\")"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-n√£o-param√©trica",
    "href": "semanas/Aula04.html#taxa-de-falhas-n√£o-param√©trica",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas n√£o param√©trica",
    "text": "Taxa de Falhas n√£o param√©trica\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos, \n             kernel = \"gaussian\", n = 100, from = 0, to = 45)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo (meses)\", ylab = \"Taxa de Falhas\")"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-n√£o-parametricos",
    "href": "semanas/Aula04.html#quantis-n√£o-parametricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis n√£o parametricos",
    "text": "Quantis n√£o parametricos\n\nlibrary(survey)\ndados_p &lt;- svydesign(ids = ~1, data=dados)\ndados_svykm &lt;- svykm(Surv(tempos, status) ~ 1, dados_p, se=TRUE)\nmediana.km &lt;- quantile(dados_svykm, 0.5, ci=TRUE)\nmed.km &lt;- c(mediana.km[1], attr(mediana.km, \"ci\")[1], attr(mediana.km, \"ci\")[2])\nnames(med.km) &lt;- c(\"mediana KM\",\"ICI\",\"ICS\")\nmed.km\n\nmediana KM        ICI        ICS \n        18         10         28"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-exponencial",
    "href": "semanas/Aula04.html#modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Exponencial",
    "text": "Modelo Exponencial\n\najustExp &lt;- survreg(Surv(tempos,status)~1, \n                    data=dados, dist='exponential')\najustExp\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"exponential\")\n\nCoefficients:\n(Intercept) \n   3.016111 \n\nScale fixed at 1 \n\nLoglik(model)= -68.3   Loglik(intercept only)= -68.3\nn= 20 \n\nalfa &lt;- exp(ajustExp$coefficients[1])\nalfa\n\n(Intercept) \n   20.41176"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de falhas NP vs Exp",
    "text": "Taxa de falhas NP vs Exp\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos, \n             kernel = \"gaussian\", n = 100, from = 0, to = 45)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo (meses)\", ylab = \"Taxa de Falhas\")\nexpHaz &lt;- function(x, rate) { \n  dexp(x, rate=rate)/\n    pexp(x, rate=rate, lower.tail=F)\n}\ncurve(expHaz(x, rate=1/alfa), from=0, to=45,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"red\", ylim=c(0,1),\n      add=TRUE)"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp-1",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de falhas NP vs Exp",
    "text": "Taxa de falhas NP vs Exp"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-exponencial",
    "href": "semanas/Aula04.html#quantis-do-modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis do Modelo Exponencial",
    "text": "Quantis do Modelo Exponencial\n\nC√°lculosResultados\n\n\n\nest_med &lt;- predict(ajustExp,type=\"uquantile\",p=0.5,se.fit=T)\nest_med1 &lt;- est_med$fit[1]\nest_med1.ep &lt;- est_med$se.fit[1]\n\nIC.mediana_exp &lt;- c(exp(est_med1),exp(est_med1-1.96*est_med1.ep),\nexp(est_med1+1.96*est_med1.ep))\nnames(IC.mediana_exp) &lt;- c(\"mediana Exp\",\"ICI\",\"ICS\")\n\n\n\n\n#IC Mediana\nIC.mediana_exp\n\nmediana Exp         ICI         ICS \n  14.148357    8.795399   22.759175"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do modelo",
    "text": "Avalia√ß√£o do modelo\n\nlibrary(car)\nn.censurado &lt;- dados$tempos[dados$status == 1]\nqqPlot(n.censurado,\ndist = \"exp\",\nrate = 1/alfa,\nxlab = \"Quantis Teoricos (exponencial)\",\nylab = \"Quantis Empiricos\")\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-exponencial",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do modelo Exponencial",
    "text": "Avalia√ß√£o do modelo Exponencial\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-weibull",
    "href": "semanas/Aula04.html#modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\nAjuste do modeloParametros do modelo\n\n\n\najustWei &lt;- survreg(Surv(tempos,status)~1, data=dados, dist='weibull')\najustWei\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"weibull\")\n\nCoefficients:\n(Intercept) \n   3.060529 \n\nScale= 0.647922 \n\nLoglik(model)= -66.1   Loglik(intercept only)= -66.1\nn= 20 \n\nalfaw &lt;- exp(ajustWei$coefficients[1])\nbetaw &lt;- 1/ajustWei$scale\n\n\n\n\n# Alfa - parametro de escala\nalfaw\n\n(Intercept) \n   21.33885 \n\n# Beta - parametro de forma\nbetaw\n\n[1] 1.543396"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Weibull",
    "text": "Taxa de Falhas NP vs Weibull\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos, \n             kernel = \"gaussian\", n = 100, from = 0, to = 45)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo (meses)\", ylab = \"Taxa de Falhas\",\n     ylim=c(0,0.10))\nweibHaz &lt;- function(x, shape, scale) { \n  dweibull(x, shape=shape, scale=scale)/\n  pweibull(x, shape=shape, scale=scale,\n           lower.tail=F)\n}\ncurve(weibHaz(x, shape=betaw, scale=alfaw), \n      from=0, to=45,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"red\",\n      add=TRUE)"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull-1",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Weibull",
    "text": "Taxa de Falhas NP vs Weibull"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-weibull",
    "href": "semanas/Aula04.html#quantis-do-modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis do Modelo Weibull",
    "text": "Quantis do Modelo Weibull\n\nC√°lculosResultados\n\n\n\najustWei &lt;- survreg(Surv(tempos,status)~1, data=dados, dist='weibull')\nestmedw &lt;- predict(ajustWei,type=\"uquantile\",p=0.5,se.fit=T)\nestmedw1 &lt;- estmedw$fit[1]\nestmedw1.ep &lt;- estmedw$se.fit[1]\nIC.mediana_w &lt;- c(exp(estmedw1),exp(estmedw1-1.96*estmedw1.ep),\nexp(estmedw1+1.96*estmedw1.ep))\nnames(IC.mediana_w) &lt;- c(\"mediana Wei\",\"ICI\",\"ICS\")\n\n\n\n\n## Mediana\nIC.mediana_w\n\nmediana Wei         ICI         ICS \n   16.82823    11.95670    23.68456"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-1",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo",
    "text": "Avalia√ß√£o do Modelo\n\nn.censurado &lt;- dados$tempos[dados$status == 1]\nqqPlot(n.censurado,\ndist = \"weibull\",\nshape = betaw,\nscale = alfaw,\nxlab = \"Quantis Teoricos (Weibull)\",\nylab = \"Quantis Empiricos\")\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-weibull",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo Weibull",
    "text": "Avalia√ß√£o do Modelo Weibull\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-lognormal",
    "href": "semanas/Aula04.html#modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\nAjuste do modeloParametros do modelo\n\n\n\najustLog &lt;- survreg(Surv(tempos, status)~1, data=dados, dist='lognorm')\najustLog\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"lognorm\")\n\nCoefficients:\n(Intercept) \n   2.717176 \n\nScale= 0.7648167 \n\nLoglik(model)= -65.7   Loglik(intercept only)= -65.7\nn= 20 \n\nmulog &lt;- ajustLog$icoef[1]\nsigmalog &lt;- ajustLog$scale\n\n\n\n\n# Media\nmulog\n\n(Intercept) \n   2.717176 \n\n# Desvio padr√£o\nsigmalog\n\n[1] 0.7648167"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Lognormal",
    "text": "Taxa de Falhas NP vs Lognormal\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos, \n             kernel = \"gaussian\", n = 100, from = 0, to = 45)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo (meses)\", ylab = \"Taxa de Falhas\",\n     ylim=c(0,0.10))\nlogHaz &lt;- function(x, meanlog, sdlog) {\n  dlnorm(x, meanlog=meanlog, sdlog=sdlog)/\n  plnorm(x, meanlog=meanlog, sdlog=sdlog, \n         lower.tail=F)\n}\ncurve(logHaz(x, meanlog=mulog, sdlog=sigmalog), from=0, to=45,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"red\",\n      add=TRUE)"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal-1",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Lognormal",
    "text": "Taxa de Falhas NP vs Lognormal"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-lognormal",
    "href": "semanas/Aula04.html#quantis-do-modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis do Modelo Lognormal",
    "text": "Quantis do Modelo Lognormal\n\najustLog &lt;- survreg(Surv(tempos, status)~1, data=dados, dist='lognorm')\nestmedl &lt;- predict(ajustLog,type=\"uquantile\",p=0.5,se.fit=T)\nestmedl1 &lt;- estmedl$fit[1]\nestmedl1.ep &lt;- estmedl$se.fit[1]\nIC.mediana_log &lt;- c(exp(estmedl1),exp(estmedl1-1.96*estmedl1.ep),\nexp(estmedl1+1.96*estmedl1.ep))\nnames(IC.mediana_log) &lt;- c(\"mediana Logn\",\"ICI\",\"ICS\")\nIC.mediana_log\n\nmediana Logn          ICI          ICS \n    15.13751     10.71601     21.38334"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-2",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo",
    "text": "Avalia√ß√£o do Modelo\n\nn.censurado &lt;- dados$tempos[dados$status == 1]\nqqPlot(n.censurado,\ndist = \"lnorm\",\nmeanlog = mulog,\nsdlog = sigmalog,\nxlab = \"Quantis Teoricos (Lognormal)\",\nylab = \"Quantis Empiricos\")\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-lognormal",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo Lognormal",
    "text": "Avalia√ß√£o do Modelo Lognormal\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-loglog√≠stico",
    "href": "semanas/Aula04.html#modelo-loglog√≠stico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Loglog√≠stico",
    "text": "Modelo Loglog√≠stico\n\nAjuste do modeloParametros do modelo\n\n\n\najustLLog &lt;- survreg(Surv(tempos, status)~1, data=dados, dist='loglogistic')\najustLLog\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"loglogistic\")\n\nCoefficients:\n(Intercept) \n   2.737415 \n\nScale= 0.4496653 \n\nLoglik(model)= -66   Loglik(intercept only)= -66\nn= 20 \n\nbetall&lt;- ajustLLog$icoef[1]\nalfall &lt;- ajustLLog$scale\nmullog &lt;- betall\nsigmallog &lt;- alfall\n\n\n\n\n# Media\nbetall\n\n(Intercept) \n   2.737415 \n\n# Desvio padr√£o\nalfall\n\n[1] 0.4496653"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-loglog√≠stica",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-loglog√≠stica",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Loglog√≠stica",
    "text": "Taxa de Falhas NP vs Loglog√≠stica\n\najusteKM &lt;- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum &lt;- summary(ajusteKM)\npesos &lt;- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh &lt;- density(ajusteKM_sum$time, weights = pesos, \n             kernel = \"gaussian\", n = 100, from = 0, to = 45)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo (meses)\", ylab = \"Taxa de Falhas\",\n     ylim=c(0,0.15))\nlibrary(flexsurv)\nllogisHaz &lt;- function(x, alfa, beta) {\n  haz &lt;- hllogis(x, shape = beta, scale = alfa, log = FALSE)\n}\ncurve(llogisHaz(x, alfa=alfall, beta=betall), from=0, to=45,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"red\", add=TRUE)"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-loglog√≠stica-1",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-loglog√≠stica-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Taxa de Falhas NP vs Loglog√≠stica",
    "text": "Taxa de Falhas NP vs Loglog√≠stica"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-loglog√≠stico",
    "href": "semanas/Aula04.html#quantis-do-modelo-loglog√≠stico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis do Modelo LogLog√≠stico",
    "text": "Quantis do Modelo LogLog√≠stico\n\najustLLog &lt;- survreg(Surv(tempos, status)~1, data=dados, dist='loglogistic')\nestmedll &lt;- predict(ajustLLog,type=\"uquantile\",p=0.5,se.fit=T)\nestmedll1 &lt;- estmedll$fit[1]\nestmedll1.ep &lt;- estmedll$se.fit[1]\nIC.mediana_llog &lt;- c(exp(estmedll1),exp(estmedll1-1.96*estmedll1.ep),\nexp(estmedll1+1.96*estmedll1.ep))\nnames(IC.mediana_llog) &lt;- c(\"mediana LogL\",\"ICI\",\"ICS\")\nIC.mediana_llog\n\nmediana LogL          ICI          ICS \n    15.44700     10.85399     21.98361"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-3",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo",
    "text": "Avalia√ß√£o do Modelo\n\nn.censurado &lt;- dados$tempos[dados$status == 1]\nqqPlot(n.censurado,\n       dist = \"llogis\",\n       shape = betall,\n       scale = alfall,\n       xlab = \"Quantis Teoricos (LogLogistico)\",\n       ylab = \"Quantis Empiricos\")\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#avalia√ß√£o-do-modelo-loglog√≠stico",
    "href": "semanas/Aula04.html#avalia√ß√£o-do-modelo-loglog√≠stico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avalia√ß√£o do Modelo LogLog√≠stico",
    "text": "Avalia√ß√£o do Modelo LogLog√≠stico\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#curvas-de-sobreviv√™ncia",
    "href": "semanas/Aula04.html#curvas-de-sobreviv√™ncia",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curvas de Sobreviv√™ncia",
    "text": "Curvas de Sobreviv√™ncia\n\ntempo &lt;- ekm$time\nst &lt;- ekm$surv\nste &lt;- exp(-tempo/alfa)\nstw &lt;- exp(-(tempo/alfaw)^betaw)\nstln &lt;- pnorm((-log(tempo) + mulog)/sigmalog)\nstll &lt;- plogis((-log(tempo) + mullog)/sigmallog)\ncbind(tempo,st,ste,stw,stln, stll)\n\n      tempo         st       ste        stw       stln      stll\n [1,]     3 0.95000000 0.8633164 0.95274148 0.98283934 0.9745310\n [2,]     5 0.90000000 0.7827384 0.89897484 0.92624322 0.9247343\n [3,]     6 0.85000000 0.7453152 0.86839357 0.88685752 0.8911964\n [4,]     7 0.80000000 0.7096812 0.83609525 0.84337638 0.8532358\n [5,]     8 0.75000000 0.6757509 0.80253272 0.79781416 0.8120295\n [6,]     9 0.70000000 0.6434428 0.76809812 0.75169629 0.7687589\n [7,]    10 0.65000000 0.6126794 0.73313414 0.70611769 0.7245227\n [8,]    12 0.59583333 0.5554947 0.66278292 0.61931883 0.6368104\n [9,]    15 0.54166667 0.4795676 0.55966698 0.50475984 0.5163200\n[10,]    18 0.48148148 0.4140186 0.46346069 0.41042396 0.4157713\n[11,]    19 0.42129630 0.3942241 0.43345774 0.38317692 0.3868919\n[12,]    20 0.36111111 0.3753760 0.40461041 0.35784922 0.3602069\n[13,]    22 0.30092593 0.3403401 0.35056108 0.31248031 0.3129370\n[14,]    25 0.24074074 0.2938212 0.27891623 0.25592025 0.2552681\n[15,]    28 0.18055556 0.2536607 0.21851514 0.21065456 0.2103630\n[16,]    30 0.12037037 0.2299851 0.18419003 0.18556452 0.1860066\n[17,]    40 0.06018519 0.1409071 0.07154720 0.10195229 0.1075572\n[18,]    45 0.06018519 0.1102934 0.04229094 0.07714984 0.0848755"
  },
  {
    "objectID": "semanas/Aula04.html#quantis",
    "href": "semanas/Aula04.html#quantis",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Quantis",
    "text": "Quantis\n\nmed.km\n\nmediana KM        ICI        ICS \n        18         10         28 \n\nIC.mediana_exp\n\nmediana Exp         ICI         ICS \n  14.148357    8.795399   22.759175 \n\nIC.mediana_w\n\nmediana Wei         ICI         ICS \n   16.82823    11.95670    23.68456 \n\nIC.mediana_log\n\nmediana Logn          ICI          ICS \n    15.13751     10.71601     21.38334 \n\nIC.mediana_llog\n\nmediana LogL          ICI          ICS \n    15.44700     10.85399     21.98361"
  },
  {
    "objectID": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico",
    "href": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o NP vs Param√©trico",
    "text": "Compara√ß√£o NP vs Param√©trico\n\npar(mfrow=c(1,2))\nplot(st,ste,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): exponencial\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stw,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): Weibull\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)"
  },
  {
    "objectID": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-1",
    "href": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o NP vs Param√©trico",
    "text": "Compara√ß√£o NP vs Param√©trico\n\npar(mfrow=c(1,2))\nplot(st,stln,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): Log-normal\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stll,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): log-Logistica\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)"
  },
  {
    "objectID": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-2",
    "href": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o NP vs Param√©trico",
    "text": "Compara√ß√£o NP vs Param√©trico\n\npar(mfrow=c(1,2))\nplot(ekm, conf.int=F, xlab=\"Tempos\", ylab=\"S(t)\")\nlines(c(0,tempo),c(1,ste), lty=2)\nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\", \"Exponencial\"),bty=\"n\",cex=0.8)\nplot(ekm, conf.int=F, xlab=\"Tempos\", ylab=\"S(t)\")\nlines(c(0,tempo),c(1,stw), lty=2)\nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\", \"Weibull\"),bty=\"n\",cex=0.8)"
  },
  {
    "objectID": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-3",
    "href": "semanas/Aula04.html#compara√ß√£o-np-vs-param√©trico-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o NP vs Param√©trico",
    "text": "Compara√ß√£o NP vs Param√©trico\n\npar(mfrow=c(1,2))\nplot(ekm, conf.int=F, xlab=\"Tempos\", ylab=\"S(t)\")\nlines(c(0,tempo),c(1,stln), lty=2)\nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\", \"Lognormal\"),bty=\"n\",cex=0.8)\nplot(ekm, conf.int=F, xlab=\"Tempos\", ylab=\"S(t)\")\nlines(c(0,tempo),c(1,stll), lty=2)\nlegend(25,0.8,lty=c(1,2),c(\"Kaplan-Meier\", \"LogLogistica\"),bty=\"n\",cex=0.8)\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula06.html#modelos-param√©tricos",
    "href": "semanas/Aula06.html#modelos-param√©tricos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos Param√©tricos",
    "text": "Modelos Param√©tricos\nNeste exemplo s√£o considerados os tempos de reincid√™ncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser. Aqui vamos utilizar as fun√ß√µes existentes no pacote survival e flexsurv.\nPara ajustar um modelo param√©trico usamos a fun√ß√£o survreg."
  },
  {
    "objectID": "semanas/Aula06.html#metodo-de-kaplan-meier",
    "href": "semanas/Aula06.html#metodo-de-kaplan-meier",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Metodo de Kaplan-Meier",
    "text": "Metodo de Kaplan-Meier\n\nlibrary(survival)\ntempos&lt;-c(3,5,6,7,8,9,10,10,12,15,15,18,19,20,22,25,28,30,40,45)\ncens&lt;-c(1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0)\ndados &lt;- data.frame(tempos=tempos, status=cens)\nekm &lt;- survfit(Surv(tempos,status)~1, data=dados)\nst &lt;- ekm$surv\ntempost &lt;- ekm$time"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---exponencial",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Biblioteca Flexsurv - Exponencial",
    "text": "Biblioteca Flexsurv - Exponencial\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"exponential\")\n\nEstimates: \n      est     L95%    U95%    se    \nrate  0.0490  0.0305  0.0788  0.0119\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -68.27389, df = 1\nAIC = 138.5478"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---weibull",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Biblioteca Flexsurv - Weibull",
    "text": "Biblioteca Flexsurv - Weibull\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"weibull\")\n\nEstimates: \n       est     L95%    U95%    se    \nshape   1.543   1.066   2.235   0.291\nscale  21.339  15.591  29.206   3.417\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -66.13336, df = 2\nAIC = 136.2667"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---lognormal",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Biblioteca Flexsurv - Lognormal",
    "text": "Biblioteca Flexsurv - Lognormal\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"lognormal\")\n\nEstimates: \n         est    L95%   U95%   se   \nmeanlog  2.717  2.372  3.063  0.176\nsdlog    0.765  0.544  1.075  0.133\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -65.7399, df = 2\nAIC = 135.4798"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---loglog√≠stica",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---loglog√≠stica",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Biblioteca Flexsurv - LogLog√≠stica",
    "text": "Biblioteca Flexsurv - LogLog√≠stica\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"llogis\")\n\nEstimates: \n       est    L95%   U95%   se   \nshape   2.22   1.51   3.28   0.44\nscale  15.45  10.85  21.98   2.78\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -66.03053, df = 2\nAIC = 136.0611"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---gama-generalizada",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---gama-generalizada",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Biblioteca Flexsurv - Gama Generalizada",
    "text": "Biblioteca Flexsurv - Gama Generalizada\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"gengamma\")\n\nEstimates: \n       est     L95%    U95%    se    \nmu      2.805   2.168   3.442   0.325\nsigma   0.743   0.498   1.110   0.152\nQ       0.247  -1.291   1.786   0.785\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -65.69074, df = 3\nAIC = 137.3815"
  },
  {
    "objectID": "semanas/Aula06.html#teste-da-raz√£o-de-verossimilhan√ßa",
    "href": "semanas/Aula06.html#teste-da-raz√£o-de-verossimilhan√ßa",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Teste da Raz√£o de Verossimilhan√ßa",
    "text": "Teste da Raz√£o de Verossimilhan√ßa\n\najuste1$loglik # exponencial\n\n[1] -68.27389\n\najuste2$loglik # Weibull\n\n[1] -66.13336\n\najuste3$loglik # Lognormal\n\n[1] -65.7399\n\najuste4$loglik # LogLogistica\n\n[1] -66.03053\n\najuste5$loglik # Gama Generalizada\n\n[1] -65.69074\n\n# Exponencial q=œÉ=1\nTRVe &lt;- 2*(ajuste5$loglik - ajuste1$loglik)\npchisq(TRVe,2, lower.tail = F)\n\n[1] 0.07553559\n\n# Weibull q = 1\nTRVw &lt;- 2*(ajuste5$loglik - ajuste2$loglik)\npchisq(TRVw,1, lower.tail = F)\n\n[1] 0.3467719\n\n# Lognormal q = 0\nTRVlog &lt;- 2*(ajuste5$loglik - ajuste3$loglik)\npchisq(TRVlog,1, lower.tail = F)\n\n[1] 0.753858"
  },
  {
    "objectID": "semanas/Aula06.html#comparando-atrav√©s-do-aic",
    "href": "semanas/Aula06.html#comparando-atrav√©s-do-aic",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Comparando atrav√©s do AIC",
    "text": "Comparando atrav√©s do AIC\n\naic.exp &lt;- -2*ajuste1$loglik + 2*1\naic.exp\n\n[1] 138.5478\n\naic.wei &lt;- -2*ajuste2$loglik + 2*2\naic.wei\n\n[1] 136.2667\n\naic.ln &lt;- -2*ajuste3$loglik + 2*2\naic.ln\n\n[1] 135.4798\n\naic.ll &lt;- -2*ajuste4$loglik + 2*2\naic.ll\n\n[1] 136.0611\n\naic.gg &lt;- -2*ajuste5$loglik + 2*3\naic.gg\n\n[1] 137.3815\n\naic &lt;- c(aic.exp, aic.wei, aic.ln, aic.ll, aic.gg)\ndelta.aic &lt;- aic - min(aic)\ndelta.aic\n\n[1] 3.0679853 0.7869174 0.0000000 0.5812562 1.9016824\n\npeso.aic &lt;- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1"
  },
  {
    "objectID": "semanas/Aula06.html#peso-de-akaike",
    "href": "semanas/Aula06.html#peso-de-akaike",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Peso de Akaike",
    "text": "Peso de Akaike\n\n\n\n\n\n\n\n\n\nmodelos\np_Akaike\n\n\n\n\nExponencial\n0.0713062\n\n\nWeibull\n0.2230770\n\n\nLognormal\n0.3306221\n\n\nLoglogistico\n0.2472371\n\n\nGG\n0.1277576"
  },
  {
    "objectID": "semanas/Aula06.html#curvas-de-sobreviv√™ncia",
    "href": "semanas/Aula06.html#curvas-de-sobreviv√™ncia",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curvas de Sobreviv√™ncia",
    "text": "Curvas de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelos-tfa",
    "href": "semanas/Aula06x1.html#modelos-tfa",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelos TFA",
    "text": "Modelos TFA\nO conjunto de dados carregados a seguir s√£o de 238 pacientes viciados com hero√≠na.\nOs pacientes foram tratados em duas cl√≠nicas (1 e 2), al√©m disso foram coletadas informa√ß√µes sobre dose de medicamento ministrado no tratamento e se o paciente j√° havia sido preso ou n√£o.\nOs tempos (survt) s√£o em dias e o evento analisado foi o tempo at√© a sa√≠da da cl√≠nica (status=1) ou o tempo at√© o t√©rmino de estudo (tempo censurado (status=0).\n\nid: Identifica√ß√£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo at√© a sa√≠da da cl√≠nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se j√° foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula06x1.html#carregando-os-dados",
    "href": "semanas/Aula06x1.html#carregando-os-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\nlibrary(readxl)\ndados &lt;- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nsummary(dados)\n```\n\n       id             clinic          status           survt       \n Min.   :  1.00   Min.   :1.000   Min.   :0.0000   Min.   :   2.0  \n 1st Qu.: 65.25   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.: 171.2  \n Median :131.50   Median :1.000   Median :1.0000   Median : 367.5  \n Mean   :134.13   Mean   :1.315   Mean   :0.6303   Mean   : 402.6  \n 3rd Qu.:205.75   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.: 585.5  \n Max.   :266.00   Max.   :2.000   Max.   :1.0000   Max.   :1076.0  \n     prison            dose      \n Min.   :0.0000   Min.   : 20.0  \n 1st Qu.:0.0000   1st Qu.: 50.0  \n Median :0.0000   Median : 60.0  \n Mean   :0.4664   Mean   : 60.4  \n 3rd Qu.:1.0000   3rd Qu.: 70.0  \n Max.   :1.0000   Max.   :110.0"
  },
  {
    "objectID": "semanas/Aula06x1.html#avaliando-presen√ßa-de-dados-ausentes",
    "href": "semanas/Aula06x1.html#avaliando-presen√ßa-de-dados-ausentes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando presen√ßa de dados ausentes",
    "text": "Avaliando presen√ßa de dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 238\n[1] 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-exponencial",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-exponencial",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo Exponencial",
    "text": "Ajuste do Modelo Exponencial\n\n```{r}\najustExp &lt;- survreg(Surv(survt,status)~1,dist='exponential', data=dados)\najustExp\nalfa &lt;- exp(ajustExp$coefficients[1])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"exponential\")\n\nCoefficients:\n(Intercept) \n   6.459508 \n\nScale fixed at 1 \n\nLoglik(model)= -1118.9   Loglik(intercept only)= -1118.9\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-weibull",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo Weibull",
    "text": "Ajuste do Modelo Weibull\n\n```{r}\najustWei &lt;- survreg(Surv(survt, status)~1,dist='weibull', data=dados)\najustWei\nalfaw &lt;- exp(ajustWei$coefficients[1])\nbetaw &lt;- 1/ajustWei$scale\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"weibull\")\n\nCoefficients:\n(Intercept) \n   6.425148 \n\nScale= 0.8153819 \n\nLoglik(model)= -1114.9   Loglik(intercept only)= -1114.9\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-lognormal",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo Lognormal",
    "text": "Ajuste do Modelo Lognormal\n\n```{r}\najustLog &lt;- survreg(Surv(survt,status)~1,dist='lognorm', data=dados)\najustLog\nmu &lt;- ajustLog$icoef[1]\nsigma &lt;- exp(ajustLog$icoef[2])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"lognorm\")\n\nCoefficients:\n(Intercept) \n   6.059725 \n\nScale= 1.210284 \n\nLoglik(model)= -1123.7   Loglik(intercept only)= -1123.7\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-loglog√≠stico",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-loglog√≠stico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo Loglog√≠stico",
    "text": "Ajuste do Modelo Loglog√≠stico\n\n```{r}\najustLogl &lt;- survreg(Surv(survt,status)~1, data=dados, dist='loglogistic')\najustLogl\nmu1 &lt;- ajustLogl$icoef[1]\nsigma1 &lt;- exp(ajustLogl$icoef[2])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"loglogistic\")\n\nCoefficients:\n(Intercept) \n    6.09544 \n\nScale= 0.6637981 \n\nLoglik(model)= -1120   Loglik(intercept only)= -1120\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos",
    "href": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos Modelos",
    "text": "Compara√ß√£o dos Modelos\n\n```{r}\nekm &lt;- survfit(Surv(survt,status)~1, data=dados)\ntempo &lt;- ekm$time\nst &lt;- ekm$surv\nste &lt;- exp(-tempo/alfa)\nstw &lt;- exp(-(tempo/alfaw)^betaw)\nstln &lt;- pnorm((-log(tempo) + mu)/sigma)\nstll &lt;- plogis((-log(tempo) + mu1)/sigma1)\nknitr::kable(head(cbind(tempo,st,ste,stw,stln,stll),15))\n```\n\n\n\n\ntempo\nst\nste\nstw\nstln\nstll\n\n\n\n\n2\n1.0000000\n0.9968738\n0.9991153\n0.9999954\n0.9997080\n\n\n7\n0.9957627\n0.9891009\n0.9958947\n0.9996619\n0.9980756\n\n\n13\n0.9915254\n0.9798534\n0.9912492\n0.9980588\n0.9951244\n\n\n17\n0.9872881\n0.9737364\n0.9878608\n0.9961610\n0.9927140\n\n\n19\n0.9830508\n0.9706923\n0.9860991\n0.9949737\n0.9913963\n\n\n26\n0.9788136\n0.9601126\n0.9796444\n0.9896895\n0.9862708\n\n\n28\n0.9788136\n0.9571111\n0.9777293\n0.9878899\n0.9846741\n\n\n29\n0.9745393\n0.9556138\n0.9767614\n0.9869468\n0.9838555\n\n\n30\n0.9702650\n0.9541189\n0.9757869\n0.9859760\n0.9830239\n\n\n33\n0.9659907\n0.9496482\n0.9728257\n0.9829067\n0.9804540\n\n\n35\n0.9574421\n0.9466794\n0.9708222\n0.9807385\n0.9786809\n\n\n37\n0.9531678\n0.9437198\n0.9687968\n0.9784805\n0.9768624\n\n\n41\n0.9446192\n0.9378285\n0.9646851\n0.9737197\n0.9730969\n\n\n47\n0.9403449\n0.9290603\n0.9583814\n0.9660499\n0.9671529\n\n\n49\n0.9360706\n0.9261559\n0.9562475\n0.9633723\n0.9650990"
  },
  {
    "objectID": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-1",
    "href": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos Modelos",
    "text": "Compara√ß√£o dos Modelos\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow=c(2,2))\nplot(st,ste,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): exponencial\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stw,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): Weibull\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stln,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): log-normal\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stll,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), \n     xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): loglog√≠stica\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-1-output",
    "href": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-1-output",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos Modelos",
    "text": "Compara√ß√£o dos Modelos"
  },
  {
    "objectID": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-2",
    "href": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos Modelos",
    "text": "Compara√ß√£o dos Modelos\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow=c(1,3))\ntab.np &lt;- summary(ekm)\ninvst1 &lt;- qnorm(tab.np$surv)\ninvst2 &lt;- qlogis(tab.np$surv) \nplot(log(tab.np$time), log(-log(tab.np$surv)),\n     xlab=\"log(t)\", ylab=\"log(-log(S(t)))\", pch=20)\nplot(log(tab.np$time), invst1,\n     xlab=\"log(t)\", ylab=expression(Phi^-1*(S(t))), pch=20)\nplot(log(tab.np$time), invst2,\n     xlab=\"log(t)\", ylab=expression(Phi^-1*Logis*(S(t))), pch=20)\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-2-output",
    "href": "semanas/Aula06x1.html#compara√ß√£o-dos-modelos-2-output",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Compara√ß√£o dos Modelos",
    "text": "Compara√ß√£o dos Modelos"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelo-weibull",
    "href": "semanas/Aula06x1.html#modelo-weibull",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\n```{r}\nTFAWei &lt;- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"weibull\", \n                   data=dados)\nsummary(TFAWei)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"weibull\")\n                   Value Std. Error     z       p\n(Intercept)      4.10485    0.32806 12.51 &lt; 2e-16\nclinic           0.70904    0.15722  4.51 6.5e-06\nfactor(prison)1 -0.22947    0.12079 -1.90   0.057\ndose             0.02443    0.00459  5.32 1.0e-07\nLog(scale)      -0.31495    0.06756 -4.66 3.1e-06\n\nScale= 0.73 \n\nWeibull distribution\nLoglik(model)= -1084.5   Loglik(intercept only)= -1114.9\n    Chisq= 60.89 on 3 degrees of freedom, p= 3.8e-13 \nNumber of Newton-Raphson Iterations: 7 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previs√µes",
    "href": "semanas/Aula06x1.html#previs√µes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Previs√µes",
    "text": "Previs√µes\n\n```{r}\nnovosdados &lt;- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis &lt;- predict(TFAWei, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis &lt;- predict(TFAWei, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n200.9142 408.2661 \n       2 \n2.032042 \n       1        2 \n300.6186 610.8697 \n       2 \n2.032042"
  },
  {
    "objectID": "semanas/Aula06x1.html#fun√ß√£o-auxiliar",
    "href": "semanas/Aula06x1.html#fun√ß√£o-auxiliar",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Fun√ß√£o auxiliar",
    "text": "Fun√ß√£o auxiliar\n\nsmoothSEcurve &lt;- function(yy, xx) {\n# usar depois de chamar um grafico\n# Ajusta um curva lowess curve com IC de 95%\n## Facilita a avalia√ß√£o dos res√≠duos\nxx.list &lt;- min(xx) + ((0:100)/100)*(max(xx) - min(xx))\nyy.xx &lt;- predict(loess(yy ~ xx), se=T,\nnewdata=data.frame(xx=xx.list))\nlines(yy.xx$fit ~ xx.list, lwd=2)\nlines(yy.xx$fit -\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\nlines(yy.xx$fit +\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\n}"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\nlibrary(car)\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(TFAWei, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1/TFAWei$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Weibull\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-output",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-output",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n[1] 69  8"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelo-lognormal",
    "href": "semanas/Aula06x1.html#modelo-lognormal",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\n```{r}\nTFALn &lt;- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"lognormal\", \n                   data=dados)\nsummary(TFALn)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"lognormal\")\n                   Value Std. Error     z      p\n(Intercept)      3.40684    0.39769  8.57 &lt;2e-16\nclinic           0.57649    0.17648  3.27 0.0011\nfactor(prison)1 -0.30904    0.15431 -2.00 0.0452\ndose             0.03367    0.00568  5.93  3e-09\nLog(scale)       0.07476    0.05930  1.26 0.2074\n\nScale= 1.08 \n\nLog Normal distribution\nLoglik(model)= -1097.8   Loglik(intercept only)= -1123.7\n    Chisq= 51.85 on 3 degrees of freedom, p= 3.2e-11 \nNumber of Newton-Raphson Iterations: 4 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previs√µes-1",
    "href": "semanas/Aula06x1.html#previs√µes-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Previs√µes",
    "text": "Previs√µes\n\n```{r}\nnovosdados &lt;- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis &lt;- predict(TFALn, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis &lt;- predict(TFALn, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n227.5381 404.9681 \n       2 \n1.779782 \n       1        2 \n400.3836 712.5953 \n       2 \n1.779782"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-1",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(TFALn, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(log.resid, dist = \"norm\", sd=TFALn$scale, \nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Lognormal\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-1-output",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-1-output",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n[1]  86 110"
  },
  {
    "objectID": "semanas/Aula06x1.html#modeleo-loglogistico",
    "href": "semanas/Aula06x1.html#modeleo-loglogistico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modeleo Loglogistico",
    "text": "Modeleo Loglogistico\n\n```{r}\nTFALl &lt;- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"loglogistic\", \n                   data=dados)\nsummary(TFALl)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"loglogistic\")\n                   Value Std. Error     z       p\n(Intercept)      3.56327    0.38945  9.15 &lt; 2e-16\nclinic           0.58060    0.17157  3.38 0.00071\nfactor(prison)1 -0.29127    0.14396 -2.02 0.04305\ndose             0.03161    0.00552  5.73 1.0e-08\nLog(scale)      -0.53314    0.06863 -7.77 7.9e-15\n\nScale= 0.587 \n\nLog logistic distribution\nLoglik(model)= -1093.9   Loglik(intercept only)= -1120\n    Chisq= 52.18 on 3 degrees of freedom, p= 2.7e-11 \nNumber of Newton-Raphson Iterations: 4 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previs√µes-2",
    "href": "semanas/Aula06x1.html#previs√µes-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Previs√µes",
    "text": "Previs√µes\n\n```{r}\nnovosdados &lt;- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis &lt;- predict(TFALl, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis &lt;- predict(TFALl, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n235.1125 420.1710 \n       2 \n1.787106 \n       1        2 \n386.5353 690.7797 \n       2 \n1.787106"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-2",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin &lt;- predict(TFALl, type = \"lp\")[dados$status == 1]\nlog.resid &lt;- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(log.resid, dist = \"logis\", \nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Logistica\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-2-output",
    "href": "semanas/Aula06x1.html#diagn√≥stico-do-modelo-2-output",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Diagn√≥stico do Modelo",
    "text": "Diagn√≥stico do Modelo\n\n[1]  86 110"
  },
  {
    "objectID": "semanas/Aula06x1.html#usando-o-stepaic",
    "href": "semanas/Aula06x1.html#usando-o-stepaic",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Usando o stepAIC",
    "text": "Usando o stepAIC\n\n```{r}\nlibrary(MASS)\nTFAWei &lt;- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"weibull\", \n                   data=dados)\nTFAWei_AIC &lt;- stepAIC(TFAWei, trace=FALSE)\nsummary(TFAWei_AIC)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"weibull\")\n                   Value Std. Error     z       p\n(Intercept)      4.10485    0.32806 12.51 &lt; 2e-16\nclinic           0.70904    0.15722  4.51 6.5e-06\nfactor(prison)1 -0.22947    0.12079 -1.90   0.057\ndose             0.02443    0.00459  5.32 1.0e-07\nLog(scale)      -0.31495    0.06756 -4.66 3.1e-06\n\nScale= 0.73 \n\nWeibull distribution\nLoglik(model)= -1084.5   Loglik(intercept only)= -1114.9\n    Chisq= 60.89 on 3 degrees of freedom, p= 3.8e-13 \nNumber of Newton-Raphson Iterations: 7 \nn= 238"
  },
  {
    "objectID": "semanas/Aula08.html",
    "href": "semanas/Aula08.html",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Nesta etapa vamos come√ßar a trabalhar com o modelo semi-param√©trico de Cox\nO conjunto de dados a seguir chamado ‚Äúanderson.xlsx‚Äù consiste em tempos de remiss√£o (em semanas) em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padr√£o.\nA vari√°vel de exposi√ß√£o de interesse √© o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padr√£o).\nDuas outras vari√°veis para controle como potenciais confundidores s√£o a contagem de gl√≥bulos brancos (ou seja, logwbc) e sexo. O status de falha √© definido pela vari√°vel reca√≠da (0 se censurado, 1 se falhar)."
  },
  {
    "objectID": "semanas/Aula08.html#introdu√ß√£o",
    "href": "semanas/Aula08.html#introdu√ß√£o",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "",
    "text": "Nesta etapa vamos come√ßar a trabalhar com o modelo semi-param√©trico de Cox\nO conjunto de dados a seguir chamado ‚Äúanderson.xlsx‚Äù consiste em tempos de remiss√£o (em semanas) em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padr√£o.\nA vari√°vel de exposi√ß√£o de interesse √© o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padr√£o).\nDuas outras vari√°veis para controle como potenciais confundidores s√£o a contagem de gl√≥bulos brancos (ou seja, logwbc) e sexo. O status de falha √© definido pela vari√°vel reca√≠da (0 se censurado, 1 se falhar)."
  },
  {
    "objectID": "semanas/Aula08.html#carregando-os-dados",
    "href": "semanas/Aula08.html#carregando-os-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\nlibrary(survival)\nlibrary(readxl)\ndados &lt;- read_xlsx(\"anderson.xlsx\", col_names = TRUE )\nsummary(dados)\n\n     tempo           status            sexo            logwbc     \n Min.   : 1.00   Min.   :0.0000   Min.   :0.0000   Min.   :1.450  \n 1st Qu.: 6.00   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2.303  \n Median :10.50   Median :1.0000   Median :0.0000   Median :2.800  \n Mean   :12.88   Mean   :0.7143   Mean   :0.4762   Mean   :2.930  \n 3rd Qu.:18.50   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:3.490  \n Max.   :35.00   Max.   :1.0000   Max.   :1.0000   Max.   :5.000  \n       Rx     \n Min.   :0.0  \n 1st Qu.:0.0  \n Median :0.5  \n Mean   :0.5  \n 3rd Qu.:1.0  \n Max.   :1.0"
  },
  {
    "objectID": "semanas/Aula08.html#ajuste-n√£o-param√©trico",
    "href": "semanas/Aula08.html#ajuste-n√£o-param√©trico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste N√£o Param√©trico",
    "text": "Ajuste N√£o Param√©trico\n\nekm &lt;- survfit(Surv(tempo,status)~Rx, data=dados)\ntempo &lt;- ekm$time\nst &lt;- ekm$surv\nsummary(ekm)\n\nCall: survfit(formula = Surv(tempo, status) ~ Rx, data = dados)\n\n                Rx=0 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                Rx=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA\n\nplot(ekm, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3)\nlegend(\"topright\",c(\"Rx=0\",\"Rx=1\"), lty = 2:3)"
  },
  {
    "objectID": "semanas/Aula08.html#modelo-semi-param√©trico-de-cox",
    "href": "semanas/Aula08.html#modelo-semi-param√©trico-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo Semi-param√©trico de Cox",
    "text": "Modelo Semi-param√©trico de Cox\n\nleuc.cox1 &lt;- coxph(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados)\nsummary(leuc.cox1)\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados)\n\n  n= 42, number of events= 30 \n\n         coef exp(coef) se(coef)     z Pr(&gt;|z|)    \nsexo   0.3147    1.3698   0.4545 0.692  0.48872    \nlogwbc 1.6819    5.3760   0.3366 4.997 5.82e-07 ***\nRx     1.5036    4.4978   0.4615 3.258  0.00112 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n       exp(coef) exp(-coef) lower .95 upper .95\nsexo       1.370     0.7300    0.5621     3.338\nlogwbc     5.376     0.1860    2.7794    10.398\nRx         4.498     0.2223    1.8204    11.113\n\nConcordance= 0.851  (se = 0.041 )\nLikelihood ratio test= 47.19  on 3 df,   p=3e-10\nWald test            = 33.54  on 3 df,   p=2e-07\nScore (logrank) test = 48.01  on 3 df,   p=2e-10"
  },
  {
    "objectID": "semanas/Aula08.html#automatizando-ajuste",
    "href": "semanas/Aula08.html#automatizando-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\nleuc.cox2 &lt;- stepAIC(leuc.cox1, direction=\"backward\", trace=FALSE)\nsummary(leuc.cox2)\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados)\n\n  n= 42, number of events= 30 \n\n         coef exp(coef) se(coef)     z Pr(&gt;|z|)    \nlogwbc 1.6909    5.4243   0.3359 5.034  4.8e-07 ***\nRx     1.3861    3.9991   0.4248 3.263   0.0011 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n       exp(coef) exp(-coef) lower .95 upper .95\nlogwbc     5.424     0.1844     2.808    10.478\nRx         3.999     0.2501     1.739     9.195\n\nConcordance= 0.852  (se = 0.04 )\nLikelihood ratio test= 46.71  on 2 df,   p=7e-11\nWald test            = 33.6  on 2 df,   p=5e-08\nScore (logrank) test = 46.07  on 2 df,   p=1e-10"
  },
  {
    "objectID": "semanas/Aula08.html#informa√ß√µes-do-ajuste",
    "href": "semanas/Aula08.html#informa√ß√µes-do-ajuste",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Informa√ß√µes do Ajuste",
    "text": "Informa√ß√µes do Ajuste\n\ncoef(leuc.cox2)\n\n  logwbc       Rx \n1.690890 1.386076 \n\nlogLik(leuc.cox2)\n\n'log Lik.' -69.8281 (df=2)"
  },
  {
    "objectID": "semanas/Aula08.html#avaliando-o-ajuste-1",
    "href": "semanas/Aula08.html#avaliando-o-ajuste-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando o ajuste 1",
    "text": "Avaliando o ajuste 1\n\nlibrary(rms)\nsurvplot(npsurv(Surv(tempo, status) ~ Rx, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula08.html#avaliando-o-ajuste-2",
    "href": "semanas/Aula08.html#avaliando-o-ajuste-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Avaliando o ajuste 2",
    "text": "Avaliando o ajuste 2\n\nlibrary(survminer)\nponto &lt;- surv_cutpoint(dados, time = \"tempo\", event = \"status\", variables = \"logwbc\")\nponto$cutpoint[1]\n\n       cutpoint\nlogwbc     2.73\n\ndados$grupolwbc &lt;- cut(dados$logwbc,ponto$cutpoint[1])\nsurvplot(npsurv(Surv(tempo, status) ~ grupolwbc, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula08.html#curva-de-sobreviv√™ncia",
    "href": "semanas/Aula08.html#curva-de-sobreviv√™ncia",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Curva de Sobreviv√™ncia",
    "text": "Curva de Sobreviv√™ncia\n\namostra &lt;- data.frame(\nRx = c(0, 1), logwbc = rep(mean(dados$logwbc), 2))\namostra.surv &lt;- survfit(leuc.cox2, newdata = amostra)\nplot(amostra.surv, col = c(1, 2), conf.int = TRUE,\nxlab = \"Tempo\", ylab = \"S(t)\")\nlegend(\"bottomleft\", bty = \"n\", lty = 1, col = 1:2,\nlegend = sprintf(\"Rx %d\", 0:1))"
  },
  {
    "objectID": "semanas/Aula10.html#modelo-semiparam√©trico-de-cox",
    "href": "semanas/Aula10.html#modelo-semiparam√©trico-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo SemiParam√©trico de Cox",
    "text": "Modelo SemiParam√©trico de Cox\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo √© verificar se o novo tratamento proposto, 6MP, tem efeito sobre a doen√ßa. (Rx=1 ou Rx=0)\nExistem dois grupos de pacientes. 21 receberam 6MP que √© um medicamento para tratar leucemia (Rx=0) e os outros 21 receberam placebo (Rx=1).\nAl√©m do tipo de tratamento foram coletadas informa√ß√µes sobre o sexo dos pacientes e do log do n√∫mero de c√©lulas brancas (logwbc).\nO evento falha aqui √© ocorrer uma reca√≠da na doen√ßa."
  },
  {
    "objectID": "semanas/Aula10.html#leitura-dos-dados",
    "href": "semanas/Aula10.html#leitura-dos-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Leitura dos Dados",
    "text": "Leitura dos Dados\n\nlibrary(survival)\nlibrary(readxl)\ndados &lt;- read_xlsx(\"anderson.xlsx\")\ngt::gt(head(dados))\n\n\n\n\n\n\n\n\ntempo\nstatus\nsexo\nlogwbc\nRx\n\n\n\n\n35\n0\n1\n1.45\n0\n\n\n34\n0\n1\n1.47\n0\n\n\n32\n0\n1\n2.20\n0\n\n\n32\n0\n1\n2.53\n0\n\n\n25\n0\n1\n1.78\n0\n\n\n23\n1\n1\n2.57\n0"
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Somente com a vari√°vel Rx\najuste1 &lt;- coxph(Surv(tempo,status) ~ Rx,data=dados)\najuste1\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx, data = dados)\n\n     coef exp(coef) se(coef)     z        p\nRx 1.5721    4.8169   0.4124 3.812 0.000138\n\nLikelihood ratio test=16.35  on 1 df, p=5.261e-05\nn= 42, number of events= 30 \n\n\nComo Rx √© uma vari√°vel bin√°ria, a mudan√ßa de 0 para 1 implica num aumenta da taxa de falhas."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-1",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Com a vari√°vel Rx e logwbc\najuste2 &lt;- coxph(Surv(tempo,status) ~ Rx + logwbc,data=dados)\najuste2\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc, data = dados)\n\n         coef exp(coef) se(coef)     z       p\nRx     1.3861    3.9991   0.4248 3.263  0.0011\nlogwbc 1.6909    5.4243   0.3359 5.034 4.8e-07\n\nLikelihood ratio test=46.71  on 2 df, p=7.187e-11\nn= 42, number of events= 30 \n\n\nO aumento do log do n√∫mero de c√©lulas brancas tamb√©m aumenta a taxa de falhas."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-2",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-2",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Com a vari√°vel Rx, logwbc e sexo\najuste3 &lt;- coxph(Surv(tempo,status) ~ Rx + logwbc + sexo,data=dados)\najuste3\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc + sexo, data = dados)\n\n         coef exp(coef) se(coef)     z        p\nRx     1.5036    4.4978   0.4615 3.258  0.00112\nlogwbc 1.6819    5.3760   0.3366 4.997 5.82e-07\nsexo   0.3147    1.3698   0.4545 0.692  0.48872\n\nLikelihood ratio test=47.19  on 3 df, p=3.171e-10\nn= 42, number of events= 30 \n\n\nO modelo n√£o indicou que a vari√°vel sexo √© estat√≠sticamente significativa."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-3",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-3",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n## Ajuste do Modelo de Cox com sexo como fator\najuste4 &lt;- coxph(Surv(tempo,status) ~ Rx + logwbc + factor(sexo), data=dados)\najuste4\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc + factor(sexo), \n    data = dados)\n\n                coef exp(coef) se(coef)     z        p\nRx            1.5036    4.4978   0.4615 3.258  0.00112\nlogwbc        1.6819    5.3760   0.3366 4.997 5.82e-07\nfactor(sexo)1 0.3147    1.3698   0.4545 0.692  0.48872\n\nLikelihood ratio test=47.19  on 3 df, p=3.171e-10\nn= 42, number of events= 30 \n\n\nMesmo transformado a vari√°vel sexo em fator, ela permaneceu sem signific√¢ncia estat√≠stica."
  },
  {
    "objectID": "semanas/Aula10.html#outro-conjunto-de-dados",
    "href": "semanas/Aula10.html#outro-conjunto-de-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Outro conjunto de dados",
    "text": "Outro conjunto de dados\nNeste exemplo os dados considerados referem-se a um estudo, descrito em Klein e Moeschberger (1997), realizado com 90 pacientes do sexo masculino diagnosticados no per√≠odo de 1970-1978 com cancer de laringe e que foram acompanhados at√© 01/01/1983.\nPara cada paciente foram registrados, no diagn√≥stico, a idade (em anos) e o est√°gio da doen√ßa (I = tumor prim√°rio, II = desenvolvimento de n√≥dulos, III = met√°stases e IV = combina√ß√£o dos 3 est√°giosanteriores) bem como seus respectivos tempos de falha ou censura (em meses).\nOs est√°gios encontram-se ordenados pelo grau de seriedade da doen√ßa (menos s√©rio para mais s√©rio)."
  },
  {
    "objectID": "semanas/Aula10.html#leitura-dos-dados-1",
    "href": "semanas/Aula10.html#leitura-dos-dados-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Leitura dos dados",
    "text": "Leitura dos dados\n\nlibrary(tidyverse)\ndados2 &lt;- read_table(\"laringe.txt\")\ngt::gt(head(dados2))\n\n\n\n\n\n\n\n\nid\ntempos\ncens\nidade\nestagio\n\n\n\n\n1\n0.6\n1\n77\n1\n\n\n2\n1.3\n1\n53\n1\n\n\n3\n2.4\n1\n45\n1\n\n\n4\n3.2\n1\n58\n1\n\n\n5\n3.3\n1\n76\n1\n\n\n6\n3.5\n1\n43\n1"
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-4",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-4",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\najuste5 &lt;- coxph(Surv(tempos,cens) ~ factor(estagio),data=dados2)\najuste5\n\nCall:\ncoxph(formula = Surv(tempos, cens) ~ factor(estagio), data = dados2)\n\n                    coef exp(coef) se(coef)     z        p\nfactor(estagio)2 0.06481   1.06696  0.45843 0.141   0.8876\nfactor(estagio)3 0.61481   1.84930  0.35519 1.731   0.0835\nfactor(estagio)4 1.73490   5.66838  0.41939 4.137 3.52e-05\n\nLikelihood ratio test=16.49  on 3 df, p=0.0009016\nn= 90, number of events= 50 \n   (1 observation deleted due to missingness)\n\n\nA medida que o est√°gio aumenta, aumenta a taxa de mortalidade dos pacientes."
  },
  {
    "objectID": "semanas/Aula12.html#estratifica√ß√£o-no-modelo-de-cox",
    "href": "semanas/Aula12.html#estratifica√ß√£o-no-modelo-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Estratifica√ß√£o no Modelo de Cox",
    "text": "Estratifica√ß√£o no Modelo de Cox\nVamos usar o conjunto de dados da biblioteca survival denominado veteran.\nOs dados s√£o de um estudo cl√≠nico realizado pela Administra√ß√£o de Veteranos sobre veteranos do sexo masculino com c√¢ncer de pulm√£o avan√ßado e inoper√°vel.\nNo ensaio, os pacientes foram randomizados para receber uma quimioterapia padr√£o ou uma quimioterapia experimental, e o tempo final foi o tempo at√© a morte\nOs dados coletados foram:\n\ntrt: tratamento padr√£o=1 experimental=2\ncelltype: tipo de tumor (1=squamous, 2=celula pequena, 3=adenocarcinoma, 4=grande)\ntime: tempo de sobreviv√™ncia (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nkarno: Karnofsky score, um m√©todo de quantificar o status b√°sico do paciente\ndiagtime: tempo em meses do diagn√≥stico at√© a aleatoriza√ß√£o\nage: idade em anos na aleatoriza√ß√£o\nprior: terapia anterior 0=n√£o e 10=sim"
  },
  {
    "objectID": "semanas/Aula12.html#carregando-os-dados",
    "href": "semanas/Aula12.html#carregando-os-dados",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\ndados &lt;- veteran\nsummary(dados)\nstr(dados)\n```\n\n      trt             celltype       time           status      \n Min.   :1.000   squamous :35   Min.   :  1.0   Min.   :0.0000  \n 1st Qu.:1.000   smallcell:48   1st Qu.: 25.0   1st Qu.:1.0000  \n Median :1.000   adeno    :27   Median : 80.0   Median :1.0000  \n Mean   :1.496   large    :27   Mean   :121.6   Mean   :0.9343  \n 3rd Qu.:2.000                  3rd Qu.:144.0   3rd Qu.:1.0000  \n Max.   :2.000                  Max.   :999.0   Max.   :1.0000  \n     karno          diagtime           age            prior      \n Min.   :10.00   Min.   : 1.000   Min.   :34.00   Min.   : 0.00  \n 1st Qu.:40.00   1st Qu.: 3.000   1st Qu.:51.00   1st Qu.: 0.00  \n Median :60.00   Median : 5.000   Median :62.00   Median : 0.00  \n Mean   :58.57   Mean   : 8.774   Mean   :58.31   Mean   : 2.92  \n 3rd Qu.:75.00   3rd Qu.:11.000   3rd Qu.:66.00   3rd Qu.:10.00  \n Max.   :99.00   Max.   :87.000   Max.   :81.00   Max.   :10.00  \n'data.frame':   137 obs. of  8 variables:\n $ trt     : num  1 1 1 1 1 1 1 1 1 1 ...\n $ celltype: Factor w/ 4 levels \"squamous\",\"smallcell\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ time    : num  72 411 228 126 118 10 82 110 314 100 ...\n $ status  : num  1 1 1 1 1 1 1 1 1 0 ...\n $ karno   : num  60 70 60 60 70 20 40 80 50 70 ...\n $ diagtime: num  7 5 3 9 11 5 10 29 18 6 ...\n $ age     : num  69 64 38 63 65 49 69 68 43 70 ...\n $ prior   : num  0 10 0 10 10 0 10 0 0 0 ..."
  },
  {
    "objectID": "semanas/Aula12.html#verificando-dados-ausentes",
    "href": "semanas/Aula12.html#verificando-dados-ausentes",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Verificando dados ausentes",
    "text": "Verificando dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 137\n[1] 137"
  },
  {
    "objectID": "semanas/Aula12.html#visualizando",
    "href": "semanas/Aula12.html#visualizando",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Visualizando",
    "text": "Visualizando\n\n```{r}\najusteKM &lt;- survfit(Surv(time/365.25, status) ~ trt, data=dados)\nplot(ajusteKM, mark.time=FALSE, col=c(1:2), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='Sobreviv√™ncia')\nlegend(\"topright\", c('Padr√£o', 'Experimental'), lwd=3, col=c(1:2))\n```"
  },
  {
    "objectID": "semanas/Aula12.html#modelo-de-cox",
    "href": "semanas/Aula12.html#modelo-de-cox",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Modelo de Cox",
    "text": "Modelo de Cox\n\n```{r}\najusteCox &lt;- coxph(Surv(time/365.25, status) ~ trt + karno + diagtime + age + prior + celltype, data=dados)\nsummary(ajusteCox)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ trt + karno + diagtime + \n    age + prior + celltype, data = dados)\n\n  n= 137, number of events= 128 \n\n                        coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    \ntrt                2.946e-01  1.343e+00  2.075e-01  1.419  0.15577    \nkarno             -3.282e-02  9.677e-01  5.508e-03 -5.958 2.55e-09 ***\ndiagtime           8.132e-05  1.000e+00  9.136e-03  0.009  0.99290    \nage               -8.706e-03  9.913e-01  9.300e-03 -0.936  0.34920    \nprior              7.159e-03  1.007e+00  2.323e-02  0.308  0.75794    \ncelltypesmallcell  8.616e-01  2.367e+00  2.753e-01  3.130  0.00175 ** \ncelltypeadeno      1.196e+00  3.307e+00  3.009e-01  3.975 7.05e-05 ***\ncelltypelarge      4.013e-01  1.494e+00  2.827e-01  1.420  0.15574    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\ntrt                  1.3426     0.7448    0.8939    2.0166\nkarno                0.9677     1.0334    0.9573    0.9782\ndiagtime             1.0001     0.9999    0.9823    1.0182\nage                  0.9913     1.0087    0.9734    1.0096\nprior                1.0072     0.9929    0.9624    1.0541\ncelltypesmallcell    2.3669     0.4225    1.3799    4.0597\ncelltypeadeno        3.3071     0.3024    1.8336    5.9647\ncelltypelarge        1.4938     0.6695    0.8583    2.5996\n\nConcordance= 0.736  (se = 0.021 )\nLikelihood ratio test= 62.1  on 8 df,   p=2e-10\nWald test            = 62.37  on 8 df,   p=2e-10\nScore (logrank) test = 66.74  on 8 df,   p=2e-11"
  },
  {
    "objectID": "semanas/Aula12.html#usando-o-stepaic",
    "href": "semanas/Aula12.html#usando-o-stepaic",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Usando o stepAIC",
    "text": "Usando o stepAIC\n\n```{r}\nlibrary(MASS)\najuste_AIC &lt;- stepAIC(ajusteCox, trace=FALSE)\nsummary(ajuste_AIC)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ karno + celltype, \n    data = dados)\n\n  n= 137, number of events= 128 \n\n                       coef exp(coef)  se(coef)      z Pr(&gt;|z|)    \nkarno             -0.031057  0.969421  0.005177 -5.999 1.99e-09 ***\ncelltypesmallcell  0.715334  2.044870  0.252686  2.831  0.00464 ** \ncelltypeadeno      1.157733  3.182711  0.292937  3.952 7.74e-05 ***\ncelltypelarge      0.325645  1.384923  0.276680  1.177  0.23921    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\nkarno                0.9694     1.0315    0.9596    0.9793\ncelltypesmallcell    2.0449     0.4890    1.2462    3.3555\ncelltypeadeno        3.1827     0.3142    1.7925    5.6513\ncelltypelarge        1.3849     0.7221    0.8052    2.3820\n\nConcordance= 0.734  (se = 0.023 )\nLikelihood ratio test= 59.37  on 4 df,   p=4e-12\nWald test            = 61.26  on 4 df,   p=2e-12\nScore (logrank) test = 63.94  on 4 df,   p=4e-13"
  },
  {
    "objectID": "semanas/Aula12.html#res√≠duos-de-schoenfeld",
    "href": "semanas/Aula12.html#res√≠duos-de-schoenfeld",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Res√≠duos de Schoenfeld",
    "text": "Res√≠duos de Schoenfeld\n\n```{r}\ncox.zph(ajuste_AIC)\nresid.sch &lt;- cox.zph(ajuste_AIC)\npar(mfrow=c(1,2))\nplot(resid.sch)\n```\n\n         chisq df       p\nkarno     14.4  1 0.00015\ncelltype  14.1  3 0.00282\nGLOBAL    23.6  4 9.4e-05"
  },
  {
    "objectID": "semanas/Aula12.html#estratifica√ß√£o",
    "href": "semanas/Aula12.html#estratifica√ß√£o",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Estratifica√ß√£o",
    "text": "Estratifica√ß√£o\n\n```{r}\najusteCoxE &lt;- coxph(Surv(time/365.25, status) ~ karno + strata(celltype), data=dados)\nsummary(ajusteCoxE)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ karno + strata(celltype), \n    data = dados)\n\n  n= 137, number of events= 128 \n\n          coef exp(coef) se(coef)      z Pr(&gt;|z|)    \nkarno -0.03562   0.96501  0.00554 -6.429 1.28e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n      exp(coef) exp(-coef) lower .95 upper .95\nkarno     0.965      1.036    0.9546    0.9755\n\nConcordance= 0.695  (se = 0.025 )\nLikelihood ratio test= 40.97  on 1 df,   p=2e-10\nWald test            = 41.33  on 1 df,   p=1e-10\nScore (logrank) test = 43.97  on 1 df,   p=3e-11"
  },
  {
    "objectID": "semanas/Aula12.html#grafico",
    "href": "semanas/Aula12.html#grafico",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grafico",
    "text": "Grafico\n\najuste_aux &lt;- survfit(ajusteCoxE)\nplot(ajuste_aux, mark.time=FALSE, col=c(1:4), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='Sobreviv√™ncia')\nlegend(\"topright\", levels(dados$celltype), lwd=3, col=c(1:4))"
  },
  {
    "objectID": "semanas/Aula12.html#estratifica√ß√£o-de-karno",
    "href": "semanas/Aula12.html#estratifica√ß√£o-de-karno",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Estratifica√ß√£o de Karno",
    "text": "Estratifica√ß√£o de Karno\n\n```{r}\n# Karno 100 bom\n# Karno &gt;60 o paciente est√° apto a viver sozinho\n# karno 30-60 requer assint√™ncia m√©dica\n# karno &lt; 30 paciente hospitalizado\ndados$fkarno &lt;- cut(dados$karno, c(0, 30, 60, 100))\najusteCoxE1 &lt;- coxph(Surv(time/365.25, status) ~ strata(fkarno) + celltype, data=dados)\nsummary(ajusteCoxE1)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ strata(fkarno) + \n    celltype, data = dados)\n\n  n= 137, number of events= 128 \n\n                    coef exp(coef) se(coef)     z Pr(&gt;|z|)    \ncelltypesmallcell 0.8849    2.4228   0.2729 3.243  0.00118 ** \ncelltypeadeno     1.2427    3.4651   0.3007 4.133 3.58e-05 ***\ncelltypelarge     0.2804    1.3237   0.2816 0.996  0.31937    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\ncelltypesmallcell     2.423     0.4128    1.4191     4.136\ncelltypeadeno         3.465     0.2886    1.9220     6.247\ncelltypelarge         1.324     0.7555    0.7622     2.299\n\nConcordance= 0.624  (se = 0.029 )\nLikelihood ratio test= 21.35  on 3 df,   p=9e-05\nWald test            = 20.68  on 3 df,   p=1e-04\nScore (logrank) test = 22.03  on 3 df,   p=6e-05"
  },
  {
    "objectID": "semanas/Aula12.html#grafico-1",
    "href": "semanas/Aula12.html#grafico-1",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Grafico",
    "text": "Grafico\n\n```{r}\najuste_aux1 &lt;- survfit(ajusteCoxE1)\nplot(ajuste_aux1, mark.time=FALSE, col=c(1:3), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='Sobreviv√™ncia')\nlegend(\"topright\", levels(dados$fkarno), lwd=3, col=c(1:3))\n```"
  },
  {
    "objectID": "semanas/Aula01.html#outra-forma-de-sum√°rio",
    "href": "semanas/Aula01.html#outra-forma-de-sum√°rio",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Outra forma de sum√°rio",
    "text": "Outra forma de sum√°rio\n\nsurv_summary(ajusteKM4)\n\n   time n.risk n.event n.censor       surv    std.err     upper       lower\n1     6     21       3        1 0.85714286 0.08908708 0.9515517 0.619717955\n2     7     17       1        0 0.80672269 0.10776353 0.9228090 0.563146565\n3     9     16       0        1 0.80672269 0.10776353 0.9228090 0.563146565\n4    10     15       1        1 0.75294118 0.12796438 0.8893618 0.503199511\n5    11     13       0        1 0.75294118 0.12796438 0.8893618 0.503199511\n6    13     12       1        0 0.69019608 0.15475995 0.8490660 0.431610222\n7    16     11       1        0 0.62745098 0.18177335 0.8049122 0.367510856\n8    17     10       0        1 0.62745098 0.18177335 0.8049122 0.367510856\n9    19      9       0        1 0.62745098 0.18177335 0.8049122 0.367510856\n10   20      8       0        1 0.62745098 0.18177335 0.8049122 0.367510856\n11   22      7       1        0 0.53781513 0.23843463 0.7467907 0.267778937\n12   23      6       1        0 0.44817927 0.30030719 0.6801426 0.188052006\n13   25      5       0        1 0.44817927 0.30030719 0.6801426 0.188052006\n14   32      4       0        2 0.44817927 0.30030719 0.6801426 0.188052006\n15   34      2       0        1 0.44817927 0.30030719 0.6801426 0.188052006\n16   35      1       0        1 0.44817927 0.30030719 0.6801426 0.188052006\n17    1     21       2        0 0.90476190 0.07079923 0.9752941 0.670045882\n18    2     19       2        0 0.80952381 0.10585122 0.9238888 0.568905060\n19    3     17       1        0 0.76190476 0.12198751 0.8932571 0.519391415\n20    4     16       2        0 0.66666667 0.15430335 0.8250440 0.425350436\n21    5     14       2        0 0.57142857 0.18898224 0.7492407 0.337976954\n22    8     12       4        0 0.38095238 0.27817432 0.5777887 0.183066549\n23   11      8       2        0 0.28571429 0.34503278 0.4818196 0.116561326\n24   12      6       2        0 0.19047619 0.44986771 0.3774349 0.059481701\n25   15      4       1        0 0.14285714 0.53452248 0.3211616 0.035657355\n26   17      3       1        0 0.09523810 0.67259271 0.2612500 0.016259260\n27   22      2       1        0 0.04761905 0.97590007 0.1970449 0.003324463\n28   23      1       1        0 0.00000000        Inf        NA          NA\n    strata grupo\n1  grupo=1     1\n2  grupo=1     1\n3  grupo=1     1\n4  grupo=1     1\n5  grupo=1     1\n6  grupo=1     1\n7  grupo=1     1\n8  grupo=1     1\n9  grupo=1     1\n10 grupo=1     1\n11 grupo=1     1\n12 grupo=1     1\n13 grupo=1     1\n14 grupo=1     1\n15 grupo=1     1\n16 grupo=1     1\n17 grupo=2     2\n18 grupo=2     2\n19 grupo=2     2\n20 grupo=2     2\n21 grupo=2     2\n22 grupo=2     2\n23 grupo=2     2\n24 grupo=2     2\n25 grupo=2     2\n26 grupo=2     2\n27 grupo=2     2\n28 grupo=2     2\n\n\n\n\nIME05-12532 - An√°lise de Sobreviv√™ncia"
  },
  {
    "objectID": "semanas/Aula02A.html#gr√°fico-m√©todo-nelson-aalen",
    "href": "semanas/Aula02A.html#gr√°fico-m√©todo-nelson-aalen",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Gr√°fico M√©todo Nelson-Aalen",
    "text": "Gr√°fico M√©todo Nelson-Aalen\n\n```{r}\nlibrary(survminer)\ngraf &lt;- ggsurvplot(ajusteNA, data = dados, \n           risk.table = TRUE, \n           pval = FALSE, \n           conf.int = TRUE, \n           xlim = c(0,40), \n           xlab = \"Tempo em meses\", \n           ylab = \"S(t)\",\n           break.time.by = 10, \n           ggtheme = theme_light(), \n           risk.table.y.text.col = T, risk.table.y.text = FALSE \n)\n```"
  },
  {
    "objectID": "semanas/Aula02A.html#gr√°fico-do-m√©todo-nelson-aalen",
    "href": "semanas/Aula02A.html#gr√°fico-do-m√©todo-nelson-aalen",
    "title": "An√°lise de Sobreviv√™ncia",
    "section": "Gr√°fico do M√©todo Nelson-Aalen",
    "text": "Gr√°fico do M√©todo Nelson-Aalen\n\ngraf"
  }
]