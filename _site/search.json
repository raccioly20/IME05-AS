[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Bom dia / Boa tarde / Boa Noite,\nSou o Professor Ricardo Accioly e esta Ã© a pÃ¡gina principal do site da disciplina AnÃ¡lise de SobrevivÃªncia IME05-12532 do Departamento de EstatÃ­stica da UERJ.\nEste site foi construÃ­do usando Quarto e foi baseado em diversas fontes de informaÃ§Ã£o obtidas na internet.\nSeguem algumas referÃªncias Ãºteis para o Quarto:\nQuarto\nCurso da Duke University\nComo criar um blog com o Quarto\nWebnar do Quarto"
  },
  {
    "objectID": "acesso-rstudio.html",
    "href": "acesso-rstudio.html",
    "title": "RStudio Cloud",
    "section": "",
    "text": "Para acessar as tarefas no RStudio Cloud, abra uma conta gratuita no mesmo e acesse o link abaixo\nRStudio"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IME05-12532 - AnÃ¡lise de SobrevivÃªncia",
    "section": "",
    "text": "Bom dia / Boa tarde / Boa Noite,\nAqui vocÃªs vÃ£o encontrar alguns dos exemplos apresentados em aula, com uso do R. O objetivo Ã© mostrar as possibilidades de aplicaÃ§Ã£o do R nesta disciplina.\nOs cÃ³digos apresentados em aula serÃ£o colocado por aqui tambÃ©m.\n[ğŸ“–] Aula01\n[ğŸ“–] Aula02\n[ğŸ“–] Aula03\n[ğŸ“–] Aula04\n[ğŸ“–] Aula05\n[ğŸ“–] Aula06\n[ğŸ“–] TFA1\n[ğŸ“–] TFA2\n[ğŸ“–] TFA3\n[ğŸ“–] Cox 1\n[ğŸ“–] Cox 2\n[ğŸ“–] Cox 3\n[ğŸ“–] Cox 4\n[ğŸ“–] Cox 5"
  },
  {
    "objectID": "semanas/Aula01.html#anÃ¡lise-de-sobrevivÃªncia",
    "href": "semanas/Aula01.html#anÃ¡lise-de-sobrevivÃªncia",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AnÃ¡lise de SobrevivÃªncia",
    "text": "AnÃ¡lise de SobrevivÃªncia\nNesta apresentaÃ§Ã£o vamos ver passo a passo como obter uma estimativa da curva de sobrevivÃªncia atravÃ©s do mÃ©todo de Kaplan-Meier.\nVamos inicialmente utilizar o pacote survival que Ã© a principal referÃªncia em modelos de anÃ¡lise de sobrevivÃªncia.\nVamos usar neste exemplo dados de pacientes com leucemia. O objetivo Ã© verificar se o tratamento proposto, 6MP, tem efeito sobre a doenÃ§a. Existem dois grupos de pacientes. 21 receberam 6MP que Ã© um medicamento para tratar leucemia e os outros 21 receberam placebo.\nO evento falha aqui Ã© ocorrer uma recaÃ­da na doenÃ§a."
  },
  {
    "objectID": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier",
    "href": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\n\n```{r}\n#| code-line-numbers: \"|8-9\"\n#| output-location: column\nlibrary(survival)\ntempo<- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus<- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0)\ndados <- data.frame(tempos=tempo, status=status)\najusteKM <- survfit(Surv(tempos, status) ~ 1, data=dados)\nplot(ajusteKM, xlab=\"Tempo (semanas)\",ylab=\"S(t)\", lty=2) \nlegend(\"topright\",\"6-MP\", lty = 2)\n```"
  },
  {
    "objectID": "semanas/Aula01.html#grafico",
    "href": "semanas/Aula01.html#grafico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\nplot(ajusteKM, xlab=\"Tempo (semanas)\",ylab=\"S(t)\", lty=2) \nlegend(\"topright\",\"6-MP\", lty = 2)"
  },
  {
    "objectID": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-1",
    "href": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\n```{r}\n#| code-line-numbers: \"|3\"\nsummary(ajusteKM)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807"
  },
  {
    "objectID": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-2",
    "href": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\n```{r}\ntempo2<- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2<- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ndados2 <- data.frame(tempos=tempo2, status=status2)\najusteKM2 <- survfit(Surv(tempos, status) ~ 1, data=dados2)\nplot(ajusteKM2, xlab=\"t(semanas)\",ylab=\"S(t)\", lty=3) \nlegend(\"topright\",\"Placebo\", lty = 3)\n```"
  },
  {
    "objectID": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-3",
    "href": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\n```{r}\nsummary(ajusteKM2)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados2)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#anÃ¡lise-conjunta",
    "href": "semanas/Aula01.html#anÃ¡lise-conjunta",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AnÃ¡lise conjunta",
    "text": "AnÃ¡lise conjunta\n\n\ntempo2g <- c(tempo,tempo2)\nstatus2g <- c(status,status2)\ngrupos <- c(rep(1,21),rep(2,21))\ndados3 <- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM3 <- survfit(Surv(tempos, status) ~ grupos, data=dados3)\nplot(ajusteKM3, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=1:2, \n     col=c(1,4), conf.int=0.95) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 1:2, col=c(1,4))"
  },
  {
    "objectID": "semanas/Aula01.html#grafico-1",
    "href": "semanas/Aula01.html#grafico-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\nplot(ajusteKM3, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=1:2, \n     col=c(1,4), conf.int=0.95) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 1:2, col=c(1,4))"
  },
  {
    "objectID": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-4",
    "href": "semanas/Aula01.html#mÃ©todo-de-kaplan-meier-4",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\nsummary(ajusteKM3)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3)\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#diferentes-tipos-de-intervalo-de-confianÃ§a",
    "href": "semanas/Aula01.html#diferentes-tipos-de-intervalo-de-confianÃ§a",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Diferentes Tipos de Intervalo de ConfianÃ§a",
    "text": "Diferentes Tipos de Intervalo de ConfianÃ§a\n\ntempo2g <- c(tempo,tempo2)\nstatus2g <- c(status,status2)\ngrupos <- c(rep(1,21),rep(2,21))\ndados3 <- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM4 <- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"plain\")"
  },
  {
    "objectID": "semanas/Aula01.html#ic-pleno-aproximaÃ§Ã£o-pela-normal",
    "href": "semanas/Aula01.html#ic-pleno-aproximaÃ§Ã£o-pela-normal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "IC Pleno (AproximaÃ§Ã£o pela Normal)",
    "text": "IC Pleno (AproximaÃ§Ã£o pela Normal)\n\nsummary(ajusteKM4)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"plain\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.707        1.000\n    7     17       1    0.807  0.0869        0.636        0.977\n   10     15       1    0.753  0.0963        0.564        0.942\n   13     12       1    0.690  0.1068        0.481        0.900\n   16     11       1    0.627  0.1141        0.404        0.851\n   22      7       1    0.538  0.1282        0.286        0.789\n   23      6       1    0.448  0.1346        0.184        0.712\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641       0.7792        1.000\n    2     19       2   0.8095  0.0857       0.6416        0.977\n    3     17       1   0.7619  0.0929       0.5797        0.944\n    4     16       2   0.6667  0.1029       0.4650        0.868\n    5     14       2   0.5714  0.1080       0.3598        0.783\n    8     12       4   0.3810  0.1060       0.1733        0.589\n   11      8       2   0.2857  0.0986       0.0925        0.479\n   12      6       2   0.1905  0.0857       0.0225        0.358\n   15      4       1   0.1429  0.0764       0.0000        0.293\n   17      3       1   0.0952  0.0641       0.0000        0.221\n   22      2       1   0.0476  0.0465       0.0000        0.139\n   23      1       1   0.0000     NaN          NaN          NaN"
  },
  {
    "objectID": "semanas/Aula01.html#ic-log---padrÃ£o-do-r",
    "href": "semanas/Aula01.html#ic-log---padrÃ£o-do-r",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "IC log - PadrÃ£o do R",
    "text": "IC log - PadrÃ£o do R\n\najusteKM5 <- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"log\")\nsummary(ajusteKM5)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#ic-log-log---kalbfleish-prentice",
    "href": "semanas/Aula01.html#ic-log-log---kalbfleish-prentice",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "IC log-log - Kalbfleish-Prentice",
    "text": "IC log-log - Kalbfleish-Prentice\n\najusteKM6 <- survfit(Surv(tempos, status) ~ grupos, data=dados3,\n                     conf.type=\"log-log\")\n\nsummary(ajusteKM6)\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados3, \n    conf.type = \"log-log\")\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.620        0.952\n    7     17       1    0.807  0.0869        0.563        0.923\n   10     15       1    0.753  0.0963        0.503        0.889\n   13     12       1    0.690  0.1068        0.432        0.849\n   16     11       1    0.627  0.1141        0.368        0.805\n   22      7       1    0.538  0.1282        0.268        0.747\n   23      6       1    0.448  0.1346        0.188        0.680\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.67005        0.975\n    2     19       2   0.8095  0.0857      0.56891        0.924\n    3     17       1   0.7619  0.0929      0.51939        0.893\n    4     16       2   0.6667  0.1029      0.42535        0.825\n    5     14       2   0.5714  0.1080      0.33798        0.749\n    8     12       4   0.3810  0.1060      0.18307        0.578\n   11      8       2   0.2857  0.0986      0.11656        0.482\n   12      6       2   0.1905  0.0857      0.05948        0.377\n   15      4       1   0.1429  0.0764      0.03566        0.321\n   17      3       1   0.0952  0.0641      0.01626        0.261\n   22      2       1   0.0476  0.0465      0.00332        0.197\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula01.html#vamos-usar-o-pacote-survminer-para-incrementar-a-visualizaÃ§Ã£o",
    "href": "semanas/Aula01.html#vamos-usar-o-pacote-survminer-para-incrementar-a-visualizaÃ§Ã£o",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Vamos usar o pacote survminer para incrementar a visualizaÃ§Ã£o",
    "text": "Vamos usar o pacote survminer para incrementar a visualizaÃ§Ã£o\n\nlibrary(survminer)\ndados <- data.frame(tempo=tempo2g, status=status2g, grupo= grupos)\najusteKM4 <- survfit(Surv(tempo2g, status2g) ~ grupo, data= dados, conf.type=\"log-log\")"
  },
  {
    "objectID": "semanas/Aula01.html#grÃ¡fico",
    "href": "semanas/Aula01.html#grÃ¡fico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "GrÃ¡fico",
    "text": "GrÃ¡fico\n\nggsurvplot(ajusteKM4, data = dados, risk.table = TRUE, pval = FALSE, conf.int = TRUE,\n           xlim = c(0,40), xlab = \"Tempo em meses\",  ylab = \"S(t)\",break.time.by = 10,\n           ggtheme = theme_light(), risk.table.y.text.col = T, risk.table.y.text = FALSE \n)"
  },
  {
    "objectID": "semanas/Aula02.html#anÃ¡lise-de-sobrevivÃªncia",
    "href": "semanas/Aula02.html#anÃ¡lise-de-sobrevivÃªncia",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AnÃ¡lise de SobrevivÃªncia",
    "text": "AnÃ¡lise de SobrevivÃªncia\nNesta apresentaÃ§Ã£o vamos ver passo a passo como obter comparar as curvas de sobrevivÃªncia utilizando o teste de log-rank. Vamos utilizar o pacote survival que Ã© a principal referÃªncia em modelos de anÃ¡lise de sobrevivÃªncia.\nVamos usar neste exemplo dados de pacientes com leucemia. O objetivo Ã© verificar se o tratamento proposto, 6MP, tem efeito sobre a doenÃ§a. Existem dois grupos de pacientes. 21 receberam 6MP que Ã© um medicamento para tratar leucemia e os outros 21 receberam placebo.\nO evento falha aqui Ã© ocorrer uma recaÃ­da na doenÃ§a."
  },
  {
    "objectID": "semanas/Aula02.html#mÃ©todo-kaplan-meier",
    "href": "semanas/Aula02.html#mÃ©todo-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo Kaplan-Meier",
    "text": "MÃ©todo Kaplan-Meier\n\n\n```{r}\n#| output-location: column\nlibrary(survival)\ntempo<- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus<- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ntempo2<- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2<- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ntempo2g <- c(tempo,tempo2)\nstatus2g <- c(status,status2)\ngrupos <- c(rep(1,21),rep(2,21))\ndados <- data.frame(tempos=tempo2g, status=status2g, grupos=grupos)\najusteKM <- survfit(Surv(tempos, status) ~ grupos, data=dados)\nplot(ajusteKM, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 2:3)\n```"
  },
  {
    "objectID": "semanas/Aula02.html#grafico",
    "href": "semanas/Aula02.html#grafico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\n```{r}\nplot(ajusteKM, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3) \nlegend(\"topright\",c(\"6-MP\",\"Placebo\"), lty = 2:3)\n```"
  },
  {
    "objectID": "semanas/Aula02.html#mÃ©todo-kaplan-meier-1",
    "href": "semanas/Aula02.html#mÃ©todo-kaplan-meier-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo Kaplan-Meier",
    "text": "MÃ©todo Kaplan-Meier\n\n```{r}\nsummary(ajusteKM)\n```\n\nCall: survfit(formula = Surv(tempos, status) ~ grupos, data = dados)\n\n                grupos=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                grupos=2 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA"
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank",
    "href": "semanas/Aula02.html#teste-do-log-rank",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do log-rank",
    "text": "Teste do log-rank\n\n```{r}\nsurvdiff(Surv(tempo2g, status2g) ~ grupos, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempo2g, status2g) ~ grupos, data = dados)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21        9     19.3      5.46      16.8\ngrupos=2 21       21     10.7      9.77      16.8\n\n Chisq= 16.8  on 1 degrees of freedom, p= 4e-05"
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank-usando-pesos",
    "href": "semanas/Aula02.html#teste-do-log-rank-usando-pesos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do log-rank usando pesos",
    "text": "Teste do log-rank usando pesos\nQuando usamo rho=0, o teste Ã© identico ao log-rank padrÃ£o\n\n```{r}\n# rho=0 Ã© o teste de log-rank\nsurvdiff(Surv(tempos, status) ~ grupos, rho=0, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados, \n    rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21        9     19.3      5.46      16.8\ngrupos=2 21       21     10.7      9.77      16.8\n\n Chisq= 16.8  on 1 degrees of freedom, p= 4e-05"
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank-usando-pesos-de-harrington-fleming",
    "href": "semanas/Aula02.html#teste-do-log-rank-usando-pesos-de-harrington-fleming",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do log-rank usando pesos de Harrington-Fleming",
    "text": "Teste do log-rank usando pesos de Harrington-Fleming\nQuando usamo rho=1, ele se torna do teste de log-rank usando os pesos de Harrington-Fleming\n\n```{r}\n# rho=1 Ã© o teste de Harrigton-Fleming\nsurvdiff(Surv(tempos, status) ~ grupos, rho=1, data=dados)\n```\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados, \n    rho = 1)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 21     5.12    12.00      3.94      14.5\ngrupos=2 21    14.55     7.68      6.16      14.5\n\n Chisq= 14.5  on 1 degrees of freedom, p= 1e-04"
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank-para-mais-de-2-grupos",
    "href": "semanas/Aula02.html#teste-do-log-rank-para-mais-de-2-grupos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do Log-rank para mais de 2 grupos",
    "text": "Teste do Log-rank para mais de 2 grupos\nVamos usar neste exemplo os dados de um estudo experimental com camundongos conduzido no Centro de Pesquisas RenÃ© Rachou, FioCruz, MG.\n44 camundongos foram infectados pela malaria (Plasmodium berguei) e aleatoriamente alocados em trÃªs grupos:\nGrupo 1: Imunizados 30 dias antes da infecÃ§Ã£o pela malÃ¡ria. Foram infetados tambÃ©m por esquistossomose.\nGrupo 2: Controle (Somente infectado pela malÃ¡ria)\nGrupo 3: Infectado pela malÃ¡ria e ela esquistossomose."
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank-para-mais-de-2-grupos-1",
    "href": "semanas/Aula02.html#teste-do-log-rank-para-mais-de-2-grupos-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do Log-rank para mais de 2 grupos",
    "text": "Teste do Log-rank para mais de 2 grupos\nA resposta foi o tempo decorrido desde a infecÃ§Ã£o pela malÃ¡ria atÃ© a morte do camundongo. O tempo foi medido em dias e o estudo foi acompanhado por 30 dias.\nVamos adotar um nÃ­vel de significÃ¢ncia de 0,05 para avaliar a diferenÃ§a entre as curvas, ou seja, se a estatÃ­stica de log-rank tiver um valor menor que 0,05, vamos rejeitar a hipÃ³tese nula."
  },
  {
    "objectID": "semanas/Aula02.html#mÃ©todo-kaplan-meier-2",
    "href": "semanas/Aula02.html#mÃ©todo-kaplan-meier-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo Kaplan-Meier",
    "text": "MÃ©todo Kaplan-Meier\n\n```{r}\ntempos <- c(7,8,8,8,8,12,12,17,18,22,30,30,30,30,30,30,8,8,9,\n10,10,14,15,15,18,19,21,22,22,23,25,8,8,8,8,8,8,\n9,10,10,10,11,17,19)\nstatus <- c(rep(1,10), rep(0,6), rep(1,15), rep(1,13))\ngrupos <- c(rep(1,16), rep(2,15), rep(3,13))\ndados2 <- data.frame(tempos, status, grupos)\najusteKM2<- survfit(Surv(tempos, status) ~ grupos, data = dados2)\nplot(ajusteKM2, xlab=\"T(dias)\",ylab=\"S(t)\", lty=1:3) \nlegend(\"topright\",c(\"G 1\",\"G 2\", \"G 3\"), lty = 1:3)\n```"
  },
  {
    "objectID": "semanas/Aula02.html#grafico-1",
    "href": "semanas/Aula02.html#grafico-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\nplot(ajusteKM2, xlab=\"T(dias)\",ylab=\"S(t)\", lty=1:3) \nlegend(\"topright\",c(\"G 1\",\"G 2\", \"G 3\"), lty = 1:3)"
  },
  {
    "objectID": "semanas/Aula02.html#teste-do-log-rank-1",
    "href": "semanas/Aula02.html#teste-do-log-rank-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste do log-rank",
    "text": "Teste do log-rank\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = dados2,  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = dados2, \n    rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10    17.00    2.8816    6.4111\ngrupos=2 15       15    14.51    0.0167    0.0317\ngrupos=3 13       13     6.49    6.5190   10.4447\n\n Chisq= 12.6  on 2 degrees of freedom, p= 0.002"
  },
  {
    "objectID": "semanas/Aula02.html#obtendo-os-resultados-de-outra-forma",
    "href": "semanas/Aula02.html#obtendo-os-resultados-de-outra-forma",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Obtendo os resultados de outra forma",
    "text": "Obtendo os resultados de outra forma\n\nteste_lr <- survdiff(Surv(tempos, status) ~ grupos, data = dados2,  rho=0)\nw <- teste_lr$obs[1:2] - teste_lr$exp[1:2]\nV <- teste_lr$var[1:2,1:2]\nt(w) %*% solve(V) %*% w\n\n         [,1]\n[1,] 12.56497"
  },
  {
    "objectID": "semanas/Aula02.html#avaliaÃ§Ã£o",
    "href": "semanas/Aula02.html#avaliaÃ§Ã£o",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o",
    "text": "AvaliaÃ§Ã£o\nComo a hipÃ³tese nula foi rejeitada precisamos avaliar se todas as curvas de sobrevivÃªncia sÃ£o diferentes. Para isto vamos fazer comparaÃ§Ãµes, duas a duas, utilizando o mÃ©todo de Bonferroni.\nComo existem trÃªs grupos, sÃ£o trÃªs as comparaÃ§Ãµes duas a duas.\nO nÃ­vel de significÃ¢ncia a ser adotado nestas comparaÃ§Ãµes Ã© de \\(\\alpha\\) = 0,05/3 = 0,017. Isto vai garantir uma conclusÃ£o geral ao nÃ­vel mÃ¡ximo de 0,05."
  },
  {
    "objectID": "semanas/Aula02.html#grupos-1-e-2",
    "href": "semanas/Aula02.html#grupos-1-e-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grupos 1 e 2",
    "text": "Grupos 1 e 2\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=3),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 3), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10     13.7      1.01      2.53\ngrupos=2 15       15     11.3      1.23      2.53\n\n Chisq= 2.5  on 1 degrees of freedom, p= 0.1"
  },
  {
    "objectID": "semanas/Aula02.html#grupos-1-e-3",
    "href": "semanas/Aula02.html#grupos-1-e-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grupos 1 e 3",
    "text": "Grupos 1 e 3\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=2),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 2), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=1 16       10    15.34      1.86      7.86\ngrupos=3 13       13     7.66      3.72      7.86\n\n Chisq= 7.9  on 1 degrees of freedom, p= 0.005"
  },
  {
    "objectID": "semanas/Aula02.html#grupos-2-e-3",
    "href": "semanas/Aula02.html#grupos-2-e-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grupos 2 e 3",
    "text": "Grupos 2 e 3\n\nsurvdiff(Surv(tempos, status) ~ grupos, data = subset(dados2, grupos!=1),  rho=0)\n\nCall:\nsurvdiff(formula = Surv(tempos, status) ~ grupos, data = subset(dados2, \n    grupos != 1), rho = 0)\n\n          N Observed Expected (O-E)^2/E (O-E)^2/V\ngrupos=2 15       15    20.53      1.49      7.98\ngrupos=3 13       13     7.47      4.08      7.98\n\n Chisq= 8  on 1 degrees of freedom, p= 0.005"
  },
  {
    "objectID": "semanas/Aula02.html#curva-de-sobrevivÃªncia-estratificada",
    "href": "semanas/Aula02.html#curva-de-sobrevivÃªncia-estratificada",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia estratificada",
    "text": "Curva de SobrevivÃªncia estratificada\nNeste exemplo temos 2 tratamentos, mas queremos controlar os resultados considerando uma variÃ¡vel categÃ³rica (sexo).\nO evento estudado Ã© o tempo atÃ© a recaÃ­da de leucemia.\nO conjunto de dados tem os seguintes informaÃ§Ã£o:\n\ntempo (semanas)\nstatus (0 = censura e 1 = falha)\nsexo (0 = mulher e 1 = homem)\nlogwbc = log do nÃºmero de cÃ©lulas brancas\nRx (0 = Novo tratamento e 1 = Placebo)\n\nVamos ver como isto pode ser feito na funÃ§Ã£o survfit."
  },
  {
    "objectID": "semanas/Aula02.html#curva-de-sobrevivÃªncia-estratificada-1",
    "href": "semanas/Aula02.html#curva-de-sobrevivÃªncia-estratificada-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia estratificada",
    "text": "Curva de SobrevivÃªncia estratificada\n\n```{r}\n#| fig-width: 10\n#| fig-height: 4.5\nlibrary(readxl)\ndados_a <- read_xlsx(\"anderson.xlsx\", col_names=T)\najusteKM_S <- survfit(Surv(tempo, status) ~ Rx + strata(sexo), data = dados_a)\nplot(ajusteKM_S, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=1:4) \nlegend(\"topright\",c(\"Rx=0 e Sexo=M\",\"Rx=0 e Sexo=H\", \"Rx=1 e Sexo=M\",\n                    \"Rx=1 e Sexo=H\"), lty = 1:4)\n```"
  },
  {
    "objectID": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-e-quantis",
    "href": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-e-quantis",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "FunÃ§Ã£o taxa de falhas e quantis",
    "text": "FunÃ§Ã£o taxa de falhas e quantis\nVamos obter uma aproximaÃ§Ã£o da funÃ§aÃµ taxa de falhas usando a funÃ§Ã£o density\nPosteriormente vamos obter o quantil usando uma funÃ§Ã£o do pacote survey"
  },
  {
    "objectID": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-nÃ£o-paramÃ©trica",
    "href": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-nÃ£o-paramÃ©trica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "FunÃ§Ã£o taxa de falhas nÃ£o paramÃ©trica",
    "text": "FunÃ§Ã£o taxa de falhas nÃ£o paramÃ©trica\n\ntempo<- c(6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35)\nstatus<- c(1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0) \ndados <- data.frame(tempos=tempo, status=status)\najusteKM <- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum <- summary(ajusteKM)\npesos <- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh <- density(ajusteKM_sum$time, weights = pesos,\nkernel = \"gaussian\", n = 100, from = 0, to = 35)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo [semanas]\", ylab = \"Taxa de Falhas\")"
  },
  {
    "objectID": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-nÃ£o-paramÃ©trica-1",
    "href": "semanas/Aula02.html#funÃ§Ã£o-taxa-de-falhas-nÃ£o-paramÃ©trica-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "FunÃ§Ã£o taxa de falhas nÃ£o paramÃ©trica",
    "text": "FunÃ§Ã£o taxa de falhas nÃ£o paramÃ©trica\n\ntempo2<- c(1,1,2,2,3,4,4,5,5,8,8,8,8,11,11,12,12,15,17,22,23)\nstatus2<- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1) \ndados <- data.frame(tempos=tempo2, status=status2)\najusteKM <- survfit(Surv(tempos, status) ~ 1, data=dados)\najusteKM_sum <- summary(ajusteKM)\npesos <- ajusteKM_sum$n.event/ajusteKM_sum$n.risk\nh <- density(ajusteKM_sum$time, weights = pesos,\nkernel = \"gaussian\", n = 100, from = 0, to = 25)\nplot(h$x, h$y, type = \"l\", xlab = \"Tempo [semanas]\", ylab = \"Taxa de Falhas\")"
  },
  {
    "objectID": "semanas/Aula02.html#quantis-nÃ£o-paramÃ©tricos",
    "href": "semanas/Aula02.html#quantis-nÃ£o-paramÃ©tricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis nÃ£o paramÃ©tricos",
    "text": "Quantis nÃ£o paramÃ©tricos\n\nlibrary(survey)\ndados_p <- svydesign(ids = ~1, data=dados)\ndados_svykm <- svykm(Surv(tempos, status) ~ 1, dados_p, se=TRUE)\nquantile(dados_svykm, 0.5, ci=TRUE)\n\n0.5 \n  8 \nattr(,\"ci\")\n    0.025 0.975\n0.5     5    12"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos",
    "text": "Modelos ParamÃ©tricos\nNesta apresentaÃ§Ã£o vamos ver passo a passo como obter a funÃ§Ã£o taxa de falhas e de sobrevivÃªncia para alguns modelos de probabilidade.\nAqui vamos utilizar as funÃ§Ãµes existentes no pacote stats que vem com a instalaÃ§Ã£o padrÃ£o do R."
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---exponencial",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Exponencial",
    "text": "Modelos ParamÃ©tricos - Exponencial\n\nexpHaz <- function(x, rate) { \n  dexp(x, rate=rate)/\n    pexp(x, rate=rate, lower.tail=F)\n}\ncurve(expHaz(x, rate=0.5), from=0, to=50,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"red\", ylim=c(0,1))\ncurve(expHaz(x, rate=0.3), from=0, to=50, \n      ylab=\"h(t)\", xlab=\"Tempo\",\n      col=\"blue\", add = T)\ncurve(expHaz(x, rate=0.1), from=0, to=50,\n      ylab=\"h(t)\", xlab=\"Tempo\", \n      col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(alfa, \" = \", 2)),\n                  expression(paste(alfa, \" = \", 3)),\n                  expression(paste(alfa, \" = \", 10))),\n                   lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---exponencial",
    "href": "semanas/Aula03.html#taxa-de-falhas---exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas - Exponencial",
    "text": "Taxa de Falhas - Exponencial"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---exponencial-1",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---exponencial-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Exponencial",
    "text": "Modelos ParamÃ©tricos - Exponencial\n\nexpSurv <- function(x, rate) { \n  pexp(x, rate=rate, lower.tail=F)\n}\ncurve(expSurv(x, rate=0.5), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(expSurv(x, rate=0.3), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"blue\", add=T)\ncurve(expSurv(x, rate=0.1), from=0, to=50,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(alfa, \" = \", 2)),\n                  expression(paste(alfa, \" = \", 3)),\n                  expression(paste(alfa, \" = \", 10))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobrevivÃªncia---exponencial",
    "href": "semanas/Aula03.html#curva-de-sobrevivÃªncia---exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia - Exponencial",
    "text": "Curva de SobrevivÃªncia - Exponencial"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---weibull",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Weibull",
    "text": "Modelos ParamÃ©tricos - Weibull\n\nweibHaz <- function(x, shape, scale) { \n  dweibull(x, shape=shape, scale=scale)/\n  pweibull(x, shape=shape, scale=scale,\n           lower.tail=F)\n}\ncurve(weibHaz(x, shape=1.5, scale=1), \n      from=0, to=2,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(weibHaz(x, shape=1, scale=1), \n      from=0, to=2, \n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"blue\", \n      add = T)\ncurve(weibHaz(x, shape=0.75, scale=1), \n      from=0, to=2,\n      ylab=\"h(t)\", xlab=\"Tempo\", col=\"black\", \n      add=T)\nlegend(\"topright\", \n   legend = c(expression(paste(beta, \" = \", 1.5,\" \",\n                                   alfa, \" = \", 1)),\n              expression(paste(beta, \" = \", 1,\" \",\n                                    alfa, \" = \", 1)),\n              expression(paste(beta, \" = \", 0.75,\" \",\n                                    alfa, \" = \", 1))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---weibull",
    "href": "semanas/Aula03.html#taxa-de-falhas---weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas - Weibull",
    "text": "Taxa de Falhas - Weibull"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---weibull-1",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---weibull-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Weibull",
    "text": "Modelos ParamÃ©tricos - Weibull\n\nweibSurv <- function(x, shape, scale) {\n  pweibull(x, shape=shape, scale=scale,\n           lower.tail=F)\n}\ncurve(weibSurv(x, shape=1.5, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"red\")\ncurve(weibSurv(x, shape=1, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"blue\", add=T)\ncurve(weibSurv(x, shape=0.75, scale=1), from=0, to=2,\n      ylab=\"S(t)\", xlab=\"Tempo\", col=\"black\", add=T)\nlegend(\"topright\", \n       legend = c(expression(paste(beta, \" = \", 1.5,\" \",\n                                       alfa, \" = \", 1)),                                    expression(paste(beta, \" = \", 1,\" \",\n                                       alfa, \" = \", 1)),\n         expression(paste(beta, \" = \", 0.75,\" \",\n                                      alfa, \" = \", 1))),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobrevivÃªncia---weibull",
    "href": "semanas/Aula03.html#curva-de-sobrevivÃªncia---weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia - Weibull",
    "text": "Curva de SobrevivÃªncia - Weibull"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---lognormal",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Lognormal",
    "text": "Modelos ParamÃ©tricos - Lognormal\n\nlogHaz <- function(x, meanlog, sdlog) {\n  dlnorm(x, meanlog=meanlog, sdlog=sdlog)/\n  plnorm(x, meanlog=meanlog, sdlog=sdlog, \n         lower.tail=F)\n}\ncurve(logHaz(x, meanlog=0, sdlog=0.5), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"log(Tempo)\", \n      col=\"red\", ylim=c(0,3.0))\ncurve(logHaz(x, meanlog=1, sdlog=0.7), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(logHaz(x, meanlog=1, sdlog=1.0), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", \n      col=\"black\", add=T)\nlegend(\"topright\", c(\"lnorm(0,0.5)\", \"lnorm(1,0.7)\", \n                     \"lnorm(1,1)\"), lty=1, \n       col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---lognormal",
    "href": "semanas/Aula03.html#taxa-de-falhas---lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas - Lognormal",
    "text": "Taxa de Falhas - Lognormal"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---lognormal-1",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---lognormal-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Lognormal",
    "text": "Modelos ParamÃ©tricos - Lognormal\n\nlogSurv <- function(x, meanlog, sdlog) {\n  plnorm(x, meanlog=meanlog, sdlog=sdlog, \n         lower.tail=F)\n}\ncurve(logSurv(x, meanlog=0, sdlog=0.5), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\",\n      col=\"red\")\ncurve(logSurv(x, meanlog=1, sdlog=0.7), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(logSurv(x, meanlog=1, sdlog=1.0),\n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\",\n      col=\"black\", add=T)\nlegend(\"topright\", c(\"lnorm(0,0.5)\", \n                     \"lnorm(1,0.7)\", \n                     \"lnorm(1,1)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobrevivÃªncia---lognormal",
    "href": "semanas/Aula03.html#curva-de-sobrevivÃªncia---lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia - Lognormal",
    "text": "Curva de SobrevivÃªncia - Lognormal"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---loglogistico",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---loglogistico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Loglogistico",
    "text": "Modelos ParamÃ©tricos - Loglogistico\n\nllogisHaz <- function(x, alfa, beta) {\n  haz <- beta/alfa*(x/alfa)^(beta-1)/(1+(x/alfa)^beta)  \n}\ncurve(llogisHaz(x, alfa=1, beta=0.5), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"red\")\ncurve(llogisHaz(x, alfa=1., beta=1), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"blue\", add=T)\ncurve(llogisHaz(x, alfa=1., beta=3), from=0, to=log(80),\n      ylab=\"h(t)\", xlab=\"Log(Tempo)\", col=\"black\", add=T)\nlegend(\"topright\", c(\"llogis(1, 0.5)\", \"llogis(1,1)\",\n                     \"llogis(1,3)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#taxa-de-falhas---loglogistico",
    "href": "semanas/Aula03.html#taxa-de-falhas---loglogistico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas - Loglogistico",
    "text": "Taxa de Falhas - Loglogistico"
  },
  {
    "objectID": "semanas/Aula03.html#modelos-paramÃ©tricos---loglogistico-1",
    "href": "semanas/Aula03.html#modelos-paramÃ©tricos---loglogistico-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos - Loglogistico",
    "text": "Modelos ParamÃ©tricos - Loglogistico\n\nllogisSurv <- function(x, alfa, beta) {\n          surv <- 1/(1+(x/alfa)^beta)  \n}\ncurve(llogisSurv(x, alfa=1, beta=0.5), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"red\", ylim=c(0,1))\ncurve(llogisSurv(x, alfa=1, beta=1), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"blue\", add=T)\ncurve(llogisSurv(x, alfa=1, beta=3), \n      from=0, to=log(80),\n      ylab=\"S(t)\", xlab=\"Log(Tempo)\", \n      col=\"black\", add=T)\nlegend(\"topright\", c(\"llogis(1, 0.5)\", \n                     \"llogis(1,1)\", \n                     \"llogis(1,3)\"),\n       lty=1, col = c(\"red\",\"blue\",\"black\"))"
  },
  {
    "objectID": "semanas/Aula03.html#curva-de-sobrevivÃªncia---loglogistico",
    "href": "semanas/Aula03.html#curva-de-sobrevivÃªncia---loglogistico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia - Loglogistico",
    "text": "Curva de SobrevivÃªncia - Loglogistico"
  },
  {
    "objectID": "semanas/Aula04.html#modelos-paramÃ©tricos",
    "href": "semanas/Aula04.html#modelos-paramÃ©tricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos",
    "text": "Modelos ParamÃ©tricos\nNeste exemplo sÃ£o considerados os tempos de reincidÃªncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser.\nVamos ver passo a passo como ajustar os modelos exponencial, Weibull e lognormal.\nAqui vamos utilizar as funÃ§Ãµes existentes no pacote survival.\nPara ajustar um modelo paramÃ©trico usamo a funÃ§Ã£o survreg."
  },
  {
    "objectID": "semanas/Aula04.html#metodo-de-kaplan-meier",
    "href": "semanas/Aula04.html#metodo-de-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Metodo de Kaplan-Meier",
    "text": "Metodo de Kaplan-Meier\n\nlibrary(survival)\ntempos<-c(3,5,6,7,8,9,10,10,12,15,15,18,19,20,22,25,28,30,40,45)\ncens<-c(1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0)\ndados <- data.frame(tempos=tempos, status=cens)\nekm <- survfit(Surv(tempos,status)~1, data=dados)\nsummary(ekm)\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    3     20       1   0.9500  0.0487      0.85913        1.000\n    5     19       1   0.9000  0.0671      0.77767        1.000\n    6     18       1   0.8500  0.0798      0.70707        1.000\n    7     17       1   0.8000  0.0894      0.64257        0.996\n    8     16       1   0.7500  0.0968      0.58233        0.966\n    9     15       1   0.7000  0.1025      0.52541        0.933\n   10     14       1   0.6500  0.1067      0.47124        0.897\n   12     12       1   0.5958  0.1107      0.41402        0.857\n   15     11       1   0.5417  0.1131      0.35976        0.816\n   18      9       1   0.4815  0.1154      0.30096        0.770\n   19      8       1   0.4213  0.1156      0.24601        0.721\n   20      7       1   0.3611  0.1137      0.19481        0.669\n   22      6       1   0.3009  0.1095      0.14745        0.614\n   25      5       1   0.2407  0.1028      0.10422        0.556\n   28      4       1   0.1806  0.0931      0.06573        0.496\n   30      3       1   0.1204  0.0792      0.03317        0.437\n   40      2       1   0.0602  0.0581      0.00907        0.399"
  },
  {
    "objectID": "semanas/Aula04.html#curva-de-sobrevivÃªncia-nÃ£o-paramÃ©trica",
    "href": "semanas/Aula04.html#curva-de-sobrevivÃªncia-nÃ£o-paramÃ©trica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia nÃ£o paramÃ©trica",
    "text": "Curva de SobrevivÃªncia nÃ£o paramÃ©trica\n\nplot(ekm, xlab=\"Tempo (meses)\",ylab=\"S(t) estimada\")"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-nÃ£o-paramÃ©trica",
    "href": "semanas/Aula04.html#taxa-de-falhas-nÃ£o-paramÃ©trica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas nÃ£o paramÃ©trica",
    "text": "Taxa de Falhas nÃ£o paramÃ©trica"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-nÃ£o-parametricos",
    "href": "semanas/Aula04.html#quantis-nÃ£o-parametricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis nÃ£o parametricos",
    "text": "Quantis nÃ£o parametricos\n\n\nmediana KM        ICI        ICS \n        18         10         28"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-exponencial",
    "href": "semanas/Aula04.html#modelo-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Exponencial",
    "text": "Modelo Exponencial\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"exponential\")\n\nCoefficients:\n(Intercept) \n   3.016111 \n\nScale fixed at 1 \n\nLoglik(model)= -68.3   Loglik(intercept only)= -68.3\nn= 20 \n\n\n(Intercept) \n   20.41176"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-exp",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de falhas NP vs Exp",
    "text": "Taxa de falhas NP vs Exp"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-exponencial",
    "href": "semanas/Aula04.html#quantis-do-modelo-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis do Modelo Exponencial",
    "text": "Quantis do Modelo Exponencial\n\n\n   media      ICI      ICS \n20.41176 12.68908 32.83455 \n\n\n[1] 14.14836\n\n\nmediana Exp         ICI         ICS \n  14.148357    8.795399   22.759175"
  },
  {
    "objectID": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo",
    "href": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do modelo",
    "text": "AvaliaÃ§Ã£o do modelo\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-weibull",
    "href": "semanas/Aula04.html#modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"weibull\")\n\nCoefficients:\n(Intercept) \n   3.060529 \n\nScale= 0.647922 \n\nLoglik(model)= -66.1   Loglik(intercept only)= -66.1\nn= 20 \n\n\n(Intercept) \n   21.33885 \n\n\n[1] 1.543396"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas NP vs Weibull",
    "text": "Taxa de Falhas NP vs Weibull"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-weibull",
    "href": "semanas/Aula04.html#quantis-do-modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis do Modelo Weibull",
    "text": "Quantis do Modelo Weibull\n\n\n[1] 16.82823\n\n\nmediana Wei         ICI         ICS \n   16.82823    11.95670    23.68456"
  },
  {
    "objectID": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-1",
    "href": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo",
    "text": "AvaliaÃ§Ã£o do Modelo\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modelo-lognormal",
    "href": "semanas/Aula04.html#modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"lognorm\")\n\nCoefficients:\n(Intercept) \n   2.717176 \n\nScale= 0.7648167 \n\nLoglik(model)= -65.7   Loglik(intercept only)= -65.7\nn= 20 \n\n\n(Intercept) \n   2.717176 \n\n\n[1] 0.7648167"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas NP vs Lognormal",
    "text": "Taxa de Falhas NP vs Lognormal"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-lognormal",
    "href": "semanas/Aula04.html#quantis-do-modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis do Modelo Lognormal",
    "text": "Quantis do Modelo Lognormal\n\n\n[1] 15.13751\n\n\nmediana Logn          ICI          ICS \n    15.13751     10.71601     21.38334"
  },
  {
    "objectID": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-2",
    "href": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo",
    "text": "AvaliaÃ§Ã£o do Modelo\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#modleo-loglogÃ­stico",
    "href": "semanas/Aula04.html#modleo-loglogÃ­stico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modleo LoglogÃ­stico",
    "text": "Modleo LoglogÃ­stico\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"loglogistic\")\n\nCoefficients:\n(Intercept) \n   2.737415 \n\nScale= 0.4496653 \n\nLoglik(model)= -66   Loglik(intercept only)= -66\nn= 20 \n\n\n(Intercept) \n   2.737415 \n\n\n[1] 0.4496653"
  },
  {
    "objectID": "semanas/Aula04.html#taxa-de-falhas-np-vs-lologÃ­stica",
    "href": "semanas/Aula04.html#taxa-de-falhas-np-vs-lologÃ­stica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Taxa de Falhas NP vs LologÃ­stica",
    "text": "Taxa de Falhas NP vs LologÃ­stica"
  },
  {
    "objectID": "semanas/Aula04.html#quantis-do-modelo-loglogÃ­stico",
    "href": "semanas/Aula04.html#quantis-do-modelo-loglogÃ­stico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis do Modelo LogLogÃ­stico",
    "text": "Quantis do Modelo LogLogÃ­stico\n\n\n[1] 15.447\n\n\nmediana LogL          ICI          ICS \n    15.44700     10.85399     21.98361"
  },
  {
    "objectID": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-3",
    "href": "semanas/Aula04.html#avaliaÃ§Ã£o-do-modelo-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo",
    "text": "AvaliaÃ§Ã£o do Modelo\n\n\n\n[1] 17 16"
  },
  {
    "objectID": "semanas/Aula04.html#curvas-de-sobrevivÃªncia",
    "href": "semanas/Aula04.html#curvas-de-sobrevivÃªncia",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curvas de SobrevivÃªncia",
    "text": "Curvas de SobrevivÃªncia\n\n\n      tempo         st       ste        stw       stln      stll\n [1,]     3 0.95000000 0.8633164 0.95274148 0.98283934 0.9745310\n [2,]     5 0.90000000 0.7827384 0.89897484 0.92624322 0.9247343\n [3,]     6 0.85000000 0.7453152 0.86839357 0.88685752 0.8911964\n [4,]     7 0.80000000 0.7096812 0.83609525 0.84337638 0.8532358\n [5,]     8 0.75000000 0.6757509 0.80253272 0.79781416 0.8120295\n [6,]     9 0.70000000 0.6434428 0.76809812 0.75169629 0.7687589\n [7,]    10 0.65000000 0.6126794 0.73313414 0.70611769 0.7245227\n [8,]    12 0.59583333 0.5554947 0.66278292 0.61931883 0.6368104\n [9,]    15 0.54166667 0.4795676 0.55966698 0.50475984 0.5163200\n[10,]    18 0.48148148 0.4140186 0.46346069 0.41042396 0.4157713\n[11,]    19 0.42129630 0.3942241 0.43345774 0.38317692 0.3868919\n[12,]    20 0.36111111 0.3753760 0.40461041 0.35784922 0.3602069\n[13,]    22 0.30092593 0.3403401 0.35056108 0.31248031 0.3129370\n[14,]    25 0.24074074 0.2938212 0.27891623 0.25592025 0.2552681\n[15,]    28 0.18055556 0.2536607 0.21851514 0.21065456 0.2103630\n[16,]    30 0.12037037 0.2299851 0.18419003 0.18556452 0.1860066\n[17,]    40 0.06018519 0.1409071 0.07154720 0.10195229 0.1075572\n[18,]    45 0.06018519 0.1102934 0.04229094 0.07714984 0.0848755"
  },
  {
    "objectID": "semanas/Aula04.html#quantis",
    "href": "semanas/Aula04.html#quantis",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Quantis",
    "text": "Quantis\n\n\nmediana KM        ICI        ICS \n        18         10         28 \n\n\nmediana Exp         ICI         ICS \n  14.148357    8.795399   22.759175 \n\n\nmediana Wei         ICI         ICS \n   16.82823    11.95670    23.68456 \n\n\nmediana Logn          ICI          ICS \n    15.13751     10.71601     21.38334 \n\n\nmediana LogL          ICI          ICS \n    15.44700     10.85399     21.98361"
  },
  {
    "objectID": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico",
    "href": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o NP vs ParamÃ©trico",
    "text": "ComparaÃ§Ã£o NP vs ParamÃ©trico"
  },
  {
    "objectID": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-1",
    "href": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o NP vs ParamÃ©trico",
    "text": "ComparaÃ§Ã£o NP vs ParamÃ©trico"
  },
  {
    "objectID": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-2",
    "href": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o NP vs ParamÃ©trico",
    "text": "ComparaÃ§Ã£o NP vs ParamÃ©trico"
  },
  {
    "objectID": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-3",
    "href": "semanas/Aula04.html#comparaÃ§Ã£o-np-vs-paramÃ©trico-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o NP vs ParamÃ©trico",
    "text": "ComparaÃ§Ã£o NP vs ParamÃ©trico"
  },
  {
    "objectID": "semanas/Aula05.html#modelos-paramÃ©tricos",
    "href": "semanas/Aula05.html#modelos-paramÃ©tricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos",
    "text": "Modelos ParamÃ©tricos\nNeste exemplo sÃ£o considerados os tempos de reincidÃªncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser.\nNesta apresentaÃ§Ã£o vamos verificar graficamente atravÃ©s de grÃ¡ficos Q-Q se os modelos exponencial, Weibull, lognormal e log-logÃ­stico parecem ser adequados.\nAqui vamos utilizar as funÃ§Ãµes existentes no pacote survival.\nPara ajustar um modelo paramÃ©trico usamos a funÃ§Ã£o survreg."
  },
  {
    "objectID": "semanas/Aula05.html#metodo-kaplan-meier",
    "href": "semanas/Aula05.html#metodo-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Metodo Kaplan-Meier",
    "text": "Metodo Kaplan-Meier\n\n\nCall: survfit(formula = Surv(tempos, status) ~ 1, data = dados)\n\n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    3     20       1   0.9500  0.0487      0.85913        1.000\n    5     19       1   0.9000  0.0671      0.77767        1.000\n    6     18       1   0.8500  0.0798      0.70707        1.000\n    7     17       1   0.8000  0.0894      0.64257        0.996\n    8     16       1   0.7500  0.0968      0.58233        0.966\n    9     15       1   0.7000  0.1025      0.52541        0.933\n   10     14       1   0.6500  0.1067      0.47124        0.897\n   12     12       1   0.5958  0.1107      0.41402        0.857\n   15     11       1   0.5417  0.1131      0.35976        0.816\n   18      9       1   0.4815  0.1154      0.30096        0.770\n   19      8       1   0.4213  0.1156      0.24601        0.721\n   20      7       1   0.3611  0.1137      0.19481        0.669\n   22      6       1   0.3009  0.1095      0.14745        0.614\n   25      5       1   0.2407  0.1028      0.10422        0.556\n   28      4       1   0.1806  0.0931      0.06573        0.496\n   30      3       1   0.1204  0.0792      0.03317        0.437\n   40      2       1   0.0602  0.0581      0.00907        0.399"
  },
  {
    "objectID": "semanas/Aula05.html#curva-de-sobrevivÃªncia-nÃ£o-paramÃ©trica",
    "href": "semanas/Aula05.html#curva-de-sobrevivÃªncia-nÃ£o-paramÃ©trica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia NÃ£o paramÃ©trica",
    "text": "Curva de SobrevivÃªncia NÃ£o paramÃ©trica"
  },
  {
    "objectID": "semanas/Aula05.html#modelos-paramÃ©tricos-1",
    "href": "semanas/Aula05.html#modelos-paramÃ©tricos-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos",
    "text": "Modelos ParamÃ©tricos\n\n\n\n`"
  },
  {
    "objectID": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-weibull",
    "href": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo Weibull",
    "text": "AvaliaÃ§Ã£o do Modelo Weibull\n\n\n\n                     2.5 %    97.5 %\n(Intercept)      -4.763998 -4.318050\nlog(tab.np$time)  1.442427  1.609615"
  },
  {
    "objectID": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-lognormal",
    "href": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo Lognormal",
    "text": "AvaliaÃ§Ã£o do Modelo Lognormal"
  },
  {
    "objectID": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-loglogÃ­stico",
    "href": "semanas/Aula05.html#avaliaÃ§Ã£o-do-modelo-loglogÃ­stico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o do Modelo LogLogÃ­stico",
    "text": "AvaliaÃ§Ã£o do Modelo LogLogÃ­stico"
  },
  {
    "objectID": "semanas/Aula05.html#teste-de-razÃ£o-de-verossimilhanÃ§a",
    "href": "semanas/Aula05.html#teste-de-razÃ£o-de-verossimilhanÃ§a",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste de RazÃ£o de VerossimilhanÃ§a",
    "text": "Teste de RazÃ£o de VerossimilhanÃ§a\nNo nÃ­vel de significÃ¢ncia de ğ›¼=0,05 eu rejeito a hipÃ³tese de que o parametro de forma seja igual a 1.\n\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"exponential\")\n            Value Std. Error    z      p\n(Intercept) 3.016      0.243 12.4 <2e-16\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -68.3   Loglik(intercept only)= -68.3\nNumber of Newton-Raphson Iterations: 4 \nn= 20 \n\n\n\nCall:\nsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, dist = \"weibull\")\n             Value Std. Error    z      p\n(Intercept)  3.061      0.160 19.1 <2e-16\nLog(scale)  -0.434      0.189 -2.3  0.022\n\nScale= 0.648 \n\nWeibull distribution\nLoglik(model)= -66.1   Loglik(intercept only)= -66.1\nNumber of Newton-Raphson Iterations: 6 \nn= 20 \n\n\n[1] 0.03853913"
  },
  {
    "objectID": "semanas/Aula05.html#comparando-modelos-atravÃ©s-do-aic",
    "href": "semanas/Aula05.html#comparando-modelos-atravÃ©s-do-aic",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando modelos atravÃ©s do AIC",
    "text": "Comparando modelos atravÃ©s do AIC\n\ntab.exp <- summary(ajustExp)\ntab.wei <- summary(ajustWei)\ntab.ln <- summary(ajustLog)\ntab.ll <- summary(ajustLogl)\naic.exp <- -2*tab.exp$loglik[1] + 2*1\naic.exp\n\n[1] 138.5478\n\naic.wei <- -2*tab.wei$loglik[1] + 2*2\naic.wei\n\n[1] 136.2667\n\naic.ln <- -2*tab.ln$loglik[1] + 2*2\naic.ln\n\n[1] 135.4798\n\naic.ll <- -2*tab.ll$loglik[1] + 2*2\naic.ll\n\n[1] 136.0611\n\naic <- c(aic.exp, aic.wei, aic.ln, aic.ll)\ndelta.aic <- aic - min(aic)\ndelta.aic\n\n[1] 3.0679853 0.7869174 0.0000000 0.5812562\n\npeso.aic <- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1"
  },
  {
    "objectID": "semanas/Aula05.html#comparando-modleos-atravÃ©s-do-peso-de-akaike",
    "href": "semanas/Aula05.html#comparando-modleos-atravÃ©s-do-peso-de-akaike",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando modleos atravÃ©s do Peso de Akaike",
    "text": "Comparando modleos atravÃ©s do Peso de Akaike\n\n\n\n\n\n\n  \n  \n    \n      modelos\n      p_Akaike\n    \n  \n  \n    Exponencial\n0.08175044\n    Weibull\n0.25575120\n    Lognormal\n0.37904837\n    Loglogistico\n0.28344999"
  },
  {
    "objectID": "semanas/Aula06.html#modelos-paramÃ©tricos",
    "href": "semanas/Aula06.html#modelos-paramÃ©tricos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos ParamÃ©tricos",
    "text": "Modelos ParamÃ©tricos\nNeste exemplo sÃ£o considerados os tempos de reincidÃªncia, em meses, de um grupo de 20 pacientes com cancer de bexiga que foram submetidos a um procedimento cirurgico feito por laser. Aqui vamos utilizar as funÃ§Ãµes existentes no pacote survival e flexsurv.\nPara ajustar um modelo paramÃ©trico usamos a funÃ§Ã£o survreg."
  },
  {
    "objectID": "semanas/Aula06.html#metodo-de-kaplan-meier",
    "href": "semanas/Aula06.html#metodo-de-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Metodo de Kaplan-Meier",
    "text": "Metodo de Kaplan-Meier\n\nlibrary(survival)\ntempos<-c(3,5,6,7,8,9,10,10,12,15,15,18,19,20,22,25,28,30,40,45)\ncens<-c(1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0)\ndados <- data.frame(tempos=tempos, status=cens)\nekm <- survfit(Surv(tempos,status)~1, data=dados)\nst <- ekm$surv\ntempost <- ekm$time"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---exponencial",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Biblioteca Flexsurv - Exponencial",
    "text": "Biblioteca Flexsurv - Exponencial\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"exponential\")\n\nEstimates: \n      est     L95%    U95%    se    \nrate  0.0490  0.0305  0.0788  0.0119\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -68.27389, df = 1\nAIC = 138.5478"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---weibull",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Biblioteca Flexsurv - Weibull",
    "text": "Biblioteca Flexsurv - Weibull\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"weibull\")\n\nEstimates: \n       est     L95%    U95%    se    \nshape   1.543   1.066   2.235   0.291\nscale  21.339  15.591  29.206   3.417\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -66.13336, df = 2\nAIC = 136.2667"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---lognormal",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Biblioteca Flexsurv - Lognormal",
    "text": "Biblioteca Flexsurv - Lognormal\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"lognormal\")\n\nEstimates: \n         est    L95%   U95%   se   \nmeanlog  2.717  2.372  3.063  0.176\nsdlog    0.765  0.544  1.075  0.133\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -65.7399, df = 2\nAIC = 135.4798"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---loglogÃ­stica",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---loglogÃ­stica",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Biblioteca Flexsurv - LogLogÃ­stica",
    "text": "Biblioteca Flexsurv - LogLogÃ­stica\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"llogis\")\n\nEstimates: \n       est    L95%   U95%   se   \nshape   2.22   1.51   3.28   0.44\nscale  15.45  10.85  21.98   2.78\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -66.03053, df = 2\nAIC = 136.0611"
  },
  {
    "objectID": "semanas/Aula06.html#biblioteca-flexsurv---gama-generalizada",
    "href": "semanas/Aula06.html#biblioteca-flexsurv---gama-generalizada",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Biblioteca Flexsurv - Gama Generalizada",
    "text": "Biblioteca Flexsurv - Gama Generalizada\n\n\nCall:\nflexsurvreg(formula = Surv(tempos, status) ~ 1, data = dados, \n    dist = \"gengamma\")\n\nEstimates: \n       est     L95%    U95%    se    \nmu      2.805   2.168   3.442   0.325\nsigma   0.743   0.498   1.110   0.152\nQ       0.247  -1.291   1.786   0.785\n\nN = 20,  Events: 17,  Censored: 3\nTotal time at risk: 347\nLog-likelihood = -65.69074, df = 3\nAIC = 137.3815"
  },
  {
    "objectID": "semanas/Aula06.html#teste-da-razÃ£o-de-verossimilhanÃ§a",
    "href": "semanas/Aula06.html#teste-da-razÃ£o-de-verossimilhanÃ§a",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Teste da RazÃ£o de VerossimilhanÃ§a",
    "text": "Teste da RazÃ£o de VerossimilhanÃ§a\n\najuste1$loglik # exponencial\n\n[1] -68.27389\n\najuste2$loglik # Weibull\n\n[1] -66.13336\n\najuste3$loglik # Lognormal\n\n[1] -65.7399\n\najuste4$loglik # LogLogistica\n\n[1] -66.03053\n\najuste5$loglik # Gama Generalizada\n\n[1] -65.69074\n\n# Exponencial q=Ïƒ=1\nTRVe <- 2*(ajuste5$loglik - ajuste1$loglik)\npchisq(TRVe,2, lower.tail = F)\n\n[1] 0.07553559\n\n# Weibull q = 1\nTRVw <- 2*(ajuste5$loglik - ajuste2$loglik)\npchisq(TRVw,1, lower.tail = F)\n\n[1] 0.3467719\n\n# Lognormal q = 0\nTRVlog <- 2*(ajuste5$loglik - ajuste3$loglik)\npchisq(TRVlog,1, lower.tail = F)\n\n[1] 0.753858"
  },
  {
    "objectID": "semanas/Aula06.html#comparando-atravÃ©s-do-aic",
    "href": "semanas/Aula06.html#comparando-atravÃ©s-do-aic",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando atravÃ©s do AIC",
    "text": "Comparando atravÃ©s do AIC\n\naic.exp <- -2*ajuste1$loglik + 2*1\naic.exp\n\n[1] 138.5478\n\naic.wei <- -2*ajuste2$loglik + 2*2\naic.wei\n\n[1] 136.2667\n\naic.ln <- -2*ajuste3$loglik + 2*2\naic.ln\n\n[1] 135.4798\n\naic.ll <- -2*ajuste4$loglik + 2*2\naic.ll\n\n[1] 136.0611\n\naic.gg <- -2*ajuste5$loglik + 2*3\naic.gg\n\n[1] 137.3815\n\naic <- c(aic.exp, aic.wei, aic.ln, aic.ll, aic.gg)\ndelta.aic <- aic - min(aic)\ndelta.aic\n\n[1] 3.0679853 0.7869174 0.0000000 0.5812562 1.9016824\n\npeso.aic <- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1"
  },
  {
    "objectID": "semanas/Aula06.html#peso-de-akaike",
    "href": "semanas/Aula06.html#peso-de-akaike",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Peso de Akaike",
    "text": "Peso de Akaike\n\n\n\n\n\n\n  \n  \n    \n      modelos\n      p_Akaike\n    \n  \n  \n    Exponencial\n0.0713062\n    Weibull\n0.2230770\n    Lognormal\n0.3306221\n    Loglogistico\n0.2472371\n    GG\n0.1277576"
  },
  {
    "objectID": "semanas/Aula06.html#curvas-de-sobrevivÃªncia",
    "href": "semanas/Aula06.html#curvas-de-sobrevivÃªncia",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curvas de SobrevivÃªncia",
    "text": "Curvas de SobrevivÃªncia"
  },
  {
    "objectID": "semanas/Aula06x.html#modelo-tfa-exponencial",
    "href": "semanas/Aula06x.html#modelo-tfa-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo TFA Exponencial",
    "text": "Modelo TFA Exponencial\nO conjunto de dados carregados a seguir sÃ£o de 238 pacientes viciados com heroÃ­na.\nOs pacientes foram tratados em duas clÃ­nicas (1 e 2), alÃ©m disso foram coletadas informaÃ§Ãµes sobre dose de medicamento ministrado no tratamento e se o paciente jÃ¡ havia sido preso ou nÃ£o.\nOs tempos (survt) sÃ£o em dias e o evento analisado foi o tempo atÃ© a saÃ­da da clÃ­nica (status=1) ou o tempo atÃ© o tÃ©rmino de estudo (tempo censurado (status=0).\n\nid: IdentificaÃ§Ã£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo atÃ© a saÃ­da da clÃ­nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se jÃ¡ foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula06x.html#carregando-os-dados",
    "href": "semanas/Aula06x.html#carregando-os-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\nlibrary(readxl)\ndados <- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nsummary(dados)\n```\n\n       id             clinic          status           survt       \n Min.   :  1.00   Min.   :1.000   Min.   :0.0000   Min.   :   2.0  \n 1st Qu.: 65.25   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.: 171.2  \n Median :131.50   Median :1.000   Median :1.0000   Median : 367.5  \n Mean   :134.13   Mean   :1.315   Mean   :0.6303   Mean   : 402.6  \n 3rd Qu.:205.75   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.: 585.5  \n Max.   :266.00   Max.   :2.000   Max.   :1.0000   Max.   :1076.0  \n     prison            dose      \n Min.   :0.0000   Min.   : 20.0  \n 1st Qu.:0.0000   1st Qu.: 50.0  \n Median :0.0000   Median : 60.0  \n Mean   :0.4664   Mean   : 60.4  \n 3rd Qu.:1.0000   3rd Qu.: 70.0  \n Max.   :1.0000   Max.   :110.0"
  },
  {
    "objectID": "semanas/Aula06x.html#avaliando-presenÃ§a-de-dados-ausentes",
    "href": "semanas/Aula06x.html#avaliando-presenÃ§a-de-dados-ausentes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando presenÃ§a de dados ausentes",
    "text": "Avaliando presenÃ§a de dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 238\n[1] 238"
  },
  {
    "objectID": "semanas/Aula06x.html#ajuste-do-modelo-exponencial",
    "href": "semanas/Aula06x.html#ajuste-do-modelo-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo Exponencial",
    "text": "Ajuste do Modelo Exponencial\n\n```{r}\nTFAExp <- survreg(Surv(survt, status) ~ clinic + prison + dose,\n                   dist = \"exponential\", \n                   data=dados)\nsummary(TFAExp)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + prison + dose, \n    data = dados, dist = \"exponential\")\n               Value Std. Error     z       p\n(Intercept)  3.68434    0.43072  8.55 < 2e-16\nclinic       0.88058    0.21063  4.18 2.9e-05\nprison      -0.25265    0.16489 -1.53    0.13\ndose         0.02892    0.00614  4.71 2.5e-06\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -1094   Loglik(intercept only)= -1118.9\n    Chisq= 49.91 on 3 degrees of freedom, p= 8.3e-11 \nNumber of Newton-Raphson Iterations: 5 \nn= 238 \n\n\nA variÃ¡vel prison Ã© marginalmente significativa considerando um nÃ­vel de significÃ¢ncia de 0,10."
  },
  {
    "objectID": "semanas/Aula06x.html#modelo-reajustado",
    "href": "semanas/Aula06x.html#modelo-reajustado",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Reajustado",
    "text": "Modelo Reajustado\n\n```{r}\nTFAExp1 <- survreg(Surv(survt, status) ~ clinic + dose,\n                   dist = \"exponential\", \n                   data=dados)\nsummary(TFAExp1)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + dose, data = dados, \n    dist = \"exponential\")\n              Value Std. Error    z       p\n(Intercept) 3.64522    0.42393 8.60 < 2e-16\nclinic      0.85494    0.21014 4.07 4.7e-05\ndose        0.02825    0.00606 4.66 3.2e-06\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -1095.1   Loglik(intercept only)= -1118.9\n    Chisq= 47.58 on 2 degrees of freedom, p= 4.7e-11 \nNumber of Newton-Raphson Iterations: 5 \nn= 238 \n\n\nModelo sem a variÃ¡vel prison."
  },
  {
    "objectID": "semanas/Aula06x.html#mÃ©todo-de-kaplan-meier",
    "href": "semanas/Aula06x.html#mÃ©todo-de-kaplan-meier",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "MÃ©todo de Kaplan-Meier",
    "text": "MÃ©todo de Kaplan-Meier\n\n```{r}\najusteKM <- survfit(Surv(survt, status) ~ clinic, data = dados)\nplot(ajusteKM, xlab=\"T(dias)\",ylab=\"S(t)\", lty=1:2, col = 1:2) \nlegend(\"topright\", bty = \"n\", lty = 1:2, col = 1:2,\nlegend = sprintf(\"clinic %d\", 1:2))\n```"
  },
  {
    "objectID": "semanas/Aula06x.html#avaliaÃ§Ã£o-dos-resultados",
    "href": "semanas/Aula06x.html#avaliaÃ§Ã£o-dos-resultados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "AvaliaÃ§Ã£o dos resultados",
    "text": "AvaliaÃ§Ã£o dos resultados\n\n```{r}\ncoefExp <- coef(TFAExp1)\nexp(coefExp[2])\nexp(coefExp[3])\n```\n\n  clinic \n2.351231 \n   dose \n1.02865 \n\n\nA mudanÃ§a da clinica 1 para a clinica 2 teve um fator de aceleraÃ§Ã£o de 2,35, ou seja, na mesma probabilidade o tempo atÃ© o evento na clinica 2 Ã© 2,35 vezes maior do que na clÃ­nica 1.\nA mudanÃ§a na dose aumentou ligeiramente o tempo atÃ© o evento, o fator de aceleraÃ§Ã£o foi de 1,02"
  },
  {
    "objectID": "semanas/Aula06x.html#novos-dados",
    "href": "semanas/Aula06x.html#novos-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Novos dados",
    "text": "Novos dados\n\n```{r}\nnovosdados <- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = c(\"no\", \"no\"), dose = c(60, 60))\nprevis <- predict(TFAExp1, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis <- predict(TFAExp1, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n144.5357 339.8368 \n       2 \n2.351231 \n       1        2 \n251.0535 590.2849 \n       2 \n2.351231 \n\n\nVeja que no modelo TFA a proporcionalidade Ã© verificada em diferentes quantis da curva de sobrevivÃªncia"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelos-tfa",
    "href": "semanas/Aula06x1.html#modelos-tfa",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelos TFA",
    "text": "Modelos TFA\nO conjunto de dados carregados a seguir sÃ£o de 238 pacientes viciados com heroÃ­na.\nOs pacientes foram tratados em duas clÃ­nicas (1 e 2), alÃ©m disso foram coletadas informaÃ§Ãµes sobre dose de medicamento ministrado no tratamento e se o paciente jÃ¡ havia sido preso ou nÃ£o.\nOs tempos (survt) sÃ£o em dias e o evento analisado foi o tempo atÃ© a saÃ­da da clÃ­nica (status=1) ou o tempo atÃ© o tÃ©rmino de estudo (tempo censurado (status=0).\n\nid: IdentificaÃ§Ã£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo atÃ© a saÃ­da da clÃ­nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se jÃ¡ foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula06x1.html#carregando-os-dados",
    "href": "semanas/Aula06x1.html#carregando-os-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\nlibrary(readxl)\ndados <- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nsummary(dados)\n```\n\n       id             clinic          status           survt       \n Min.   :  1.00   Min.   :1.000   Min.   :0.0000   Min.   :   2.0  \n 1st Qu.: 65.25   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.: 171.2  \n Median :131.50   Median :1.000   Median :1.0000   Median : 367.5  \n Mean   :134.13   Mean   :1.315   Mean   :0.6303   Mean   : 402.6  \n 3rd Qu.:205.75   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.: 585.5  \n Max.   :266.00   Max.   :2.000   Max.   :1.0000   Max.   :1076.0  \n     prison            dose      \n Min.   :0.0000   Min.   : 20.0  \n 1st Qu.:0.0000   1st Qu.: 50.0  \n Median :0.0000   Median : 60.0  \n Mean   :0.4664   Mean   : 60.4  \n 3rd Qu.:1.0000   3rd Qu.: 70.0  \n Max.   :1.0000   Max.   :110.0"
  },
  {
    "objectID": "semanas/Aula06x1.html#avaliando-presenÃ§a-de-dados-ausentes",
    "href": "semanas/Aula06x1.html#avaliando-presenÃ§a-de-dados-ausentes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando presenÃ§a de dados ausentes",
    "text": "Avaliando presenÃ§a de dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 238\n[1] 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-exponencial",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo Exponencial",
    "text": "Ajuste do Modelo Exponencial\n\n```{r}\najustExp <- survreg(Surv(survt,status)~1,dist='exponential', data=dados)\najustExp\nalfa <- exp(ajustExp$coefficients[1])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"exponential\")\n\nCoefficients:\n(Intercept) \n   6.459508 \n\nScale fixed at 1 \n\nLoglik(model)= -1118.9   Loglik(intercept only)= -1118.9\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-weibull",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo Weibull",
    "text": "Ajuste do Modelo Weibull\n\n```{r}\najustWei <- survreg(Surv(survt, status)~1,dist='weibull', data=dados)\najustWei\nalfaw <- exp(ajustWei$coefficients[1])\nbetaw <- 1/ajustWei$scale\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"weibull\")\n\nCoefficients:\n(Intercept) \n   6.425148 \n\nScale= 0.8153819 \n\nLoglik(model)= -1114.9   Loglik(intercept only)= -1114.9\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-lognormal",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo Lognormal",
    "text": "Ajuste do Modelo Lognormal\n\n```{r}\najustLog <- survreg(Surv(survt,status)~1,dist='lognorm', data=dados)\najustLog\nmu <- ajustLog$icoef[1]\nsigma <- exp(ajustLog$icoef[2])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"lognorm\")\n\nCoefficients:\n(Intercept) \n   6.059725 \n\nScale= 1.210284 \n\nLoglik(model)= -1123.7   Loglik(intercept only)= -1123.7\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#ajuste-do-modelo-loglogÃ­stico",
    "href": "semanas/Aula06x1.html#ajuste-do-modelo-loglogÃ­stico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo LoglogÃ­stico",
    "text": "Ajuste do Modelo LoglogÃ­stico\n\n```{r}\najustLogl <- survreg(Surv(survt,status)~1, data=dados, dist='loglogistic')\najustLogl\nmu1 <- ajustLogl$icoef[1]\nsigma1 <- exp(ajustLogl$icoef[2])\n```\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ 1, data = dados, dist = \"loglogistic\")\n\nCoefficients:\n(Intercept) \n    6.09544 \n\nScale= 0.6637981 \n\nLoglik(model)= -1120   Loglik(intercept only)= -1120\nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos",
    "href": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos Modelos",
    "text": "ComparaÃ§Ã£o dos Modelos\n\n```{r}\nekm <- survfit(Surv(survt,status)~1, data=dados)\ntempo <- ekm$time\nst <- ekm$surv\nste <- exp(-tempo/alfa)\nstw <- exp(-(tempo/alfaw)^betaw)\nstln <- pnorm((-log(tempo) + mu)/sigma)\nstll <- plogis((-log(tempo) + mu1)/sigma1)\nknitr::kable(head(cbind(tempo,st,ste,stw,stln,stll),15))\n```\n\n\n\n\ntempo\nst\nste\nstw\nstln\nstll\n\n\n\n\n2\n1.0000000\n0.9968738\n0.9991153\n0.9999954\n0.9997080\n\n\n7\n0.9957627\n0.9891009\n0.9958947\n0.9996619\n0.9980756\n\n\n13\n0.9915254\n0.9798534\n0.9912492\n0.9980588\n0.9951244\n\n\n17\n0.9872881\n0.9737364\n0.9878608\n0.9961610\n0.9927140\n\n\n19\n0.9830508\n0.9706923\n0.9860991\n0.9949737\n0.9913963\n\n\n26\n0.9788136\n0.9601126\n0.9796444\n0.9896895\n0.9862708\n\n\n28\n0.9788136\n0.9571111\n0.9777293\n0.9878899\n0.9846741\n\n\n29\n0.9745393\n0.9556138\n0.9767614\n0.9869468\n0.9838555\n\n\n30\n0.9702650\n0.9541189\n0.9757869\n0.9859760\n0.9830239\n\n\n33\n0.9659907\n0.9496482\n0.9728257\n0.9829067\n0.9804540\n\n\n35\n0.9574421\n0.9466794\n0.9708222\n0.9807385\n0.9786809\n\n\n37\n0.9531678\n0.9437198\n0.9687968\n0.9784805\n0.9768624\n\n\n41\n0.9446192\n0.9378285\n0.9646851\n0.9737197\n0.9730969\n\n\n47\n0.9403449\n0.9290603\n0.9583814\n0.9660499\n0.9671529\n\n\n49\n0.9360706\n0.9261559\n0.9562475\n0.9633723\n0.9650990"
  },
  {
    "objectID": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-1",
    "href": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos Modelos",
    "text": "ComparaÃ§Ã£o dos Modelos\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow=c(2,2))\nplot(st,ste,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): exponencial\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stw,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): Weibull\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stln,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), xlab = \"S(t): Kaplan-Meier\",\n     ylab=\"S(t): log-normal\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\nplot(st,stll,pch=16,ylim=range(c(0.0,1)), xlim=range(c(0,1)), \n     xlab = \"S(t): Kaplan-Meier\", ylab=\"S(t): loglogÃ­stica\")\nlines(c(0,1), c(0,1), type=\"l\", lty=1)\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-1-output",
    "href": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-1-output",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos Modelos",
    "text": "ComparaÃ§Ã£o dos Modelos"
  },
  {
    "objectID": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-2",
    "href": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos Modelos",
    "text": "ComparaÃ§Ã£o dos Modelos\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow=c(1,3))\ntab.np <- summary(ekm)\ninvst1 <- qnorm(tab.np$surv)\ninvst2 <- qlogis(tab.np$surv) \nplot(log(tab.np$time), log(-log(tab.np$surv)),\n     xlab=\"log(t)\", ylab=\"log(-log(S(t)))\", pch=20)\nplot(log(tab.np$time), invst1,\n     xlab=\"log(t)\", ylab=expression(Phi^-1*(S(t))), pch=20)\nplot(log(tab.np$time), invst2,\n     xlab=\"log(t)\", ylab=expression(Phi^-1*Logis*(S(t))), pch=20)\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-2-output",
    "href": "semanas/Aula06x1.html#comparaÃ§Ã£o-dos-modelos-2-output",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos Modelos",
    "text": "ComparaÃ§Ã£o dos Modelos"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelo-weibull",
    "href": "semanas/Aula06x1.html#modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\n```{r}\nTFAWei <- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"weibull\", \n                   data=dados)\nsummary(TFAWei)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"weibull\")\n                   Value Std. Error     z       p\n(Intercept)      4.10485    0.32806 12.51 < 2e-16\nclinic           0.70904    0.15722  4.51 6.5e-06\nfactor(prison)1 -0.22947    0.12079 -1.90   0.057\ndose             0.02443    0.00459  5.32 1.0e-07\nLog(scale)      -0.31495    0.06756 -4.66 3.1e-06\n\nScale= 0.73 \n\nWeibull distribution\nLoglik(model)= -1084.5   Loglik(intercept only)= -1114.9\n    Chisq= 60.89 on 3 degrees of freedom, p= 3.8e-13 \nNumber of Newton-Raphson Iterations: 7 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previsÃµes",
    "href": "semanas/Aula06x1.html#previsÃµes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "PrevisÃµes",
    "text": "PrevisÃµes\n\n```{r}\nnovosdados <- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis <- predict(TFAWei, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis <- predict(TFAWei, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n200.9142 408.2661 \n       2 \n2.032042 \n       1        2 \n300.6186 610.8697 \n       2 \n2.032042"
  },
  {
    "objectID": "semanas/Aula06x1.html#funÃ§Ã£o-auxiliar",
    "href": "semanas/Aula06x1.html#funÃ§Ã£o-auxiliar",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "FunÃ§Ã£o auxiliar",
    "text": "FunÃ§Ã£o auxiliar\n\nsmoothSEcurve <- function(yy, xx) {\n# usar depois de chamar um grafico\n# Ajusta um curva lowess curve com IC de 95%\n## Facilita a avaliaÃ§Ã£o dos resÃ­duos\nxx.list <- min(xx) + ((0:100)/100)*(max(xx) - min(xx))\nyy.xx <- predict(loess(yy ~ xx), se=T,\nnewdata=data.frame(xx=xx.list))\nlines(yy.xx$fit ~ xx.list, lwd=2)\nlines(yy.xx$fit -\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\nlines(yy.xx$fit +\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\n}"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\nlibrary(car)\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(TFAWei, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1/TFAWei$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Weibull\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-output",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-output",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n[1] 69  8"
  },
  {
    "objectID": "semanas/Aula06x1.html#modelo-lognormal",
    "href": "semanas/Aula06x1.html#modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\n```{r}\nTFALn <- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"lognormal\", \n                   data=dados)\nsummary(TFALn)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"lognormal\")\n                   Value Std. Error     z      p\n(Intercept)      3.40684    0.39769  8.57 <2e-16\nclinic           0.57649    0.17648  3.27 0.0011\nfactor(prison)1 -0.30904    0.15431 -2.00 0.0452\ndose             0.03367    0.00568  5.93  3e-09\nLog(scale)       0.07476    0.05930  1.26 0.2074\n\nScale= 1.08 \n\nLog Normal distribution\nLoglik(model)= -1097.8   Loglik(intercept only)= -1123.7\n    Chisq= 51.85 on 3 degrees of freedom, p= 3.2e-11 \nNumber of Newton-Raphson Iterations: 4 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previsÃµes-1",
    "href": "semanas/Aula06x1.html#previsÃµes-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "PrevisÃµes",
    "text": "PrevisÃµes\n\n```{r}\nnovosdados <- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis <- predict(TFALn, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis <- predict(TFALn, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n227.5381 404.9681 \n       2 \n1.779782 \n       1        2 \n400.3836 712.5953 \n       2 \n1.779782"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-1",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(TFALn, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(log.resid, dist = \"norm\", sd=TFALn$scale, \nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Lognormal\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-1-output",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-1-output",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n[1]  86 110"
  },
  {
    "objectID": "semanas/Aula06x1.html#modeleo-loglogistico",
    "href": "semanas/Aula06x1.html#modeleo-loglogistico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modeleo Loglogistico",
    "text": "Modeleo Loglogistico\n\n```{r}\nTFALl <- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"loglogistic\", \n                   data=dados)\nsummary(TFALl)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"loglogistic\")\n                   Value Std. Error     z       p\n(Intercept)      3.56327    0.38945  9.15 < 2e-16\nclinic           0.58060    0.17157  3.38 0.00071\nfactor(prison)1 -0.29127    0.14396 -2.02 0.04305\ndose             0.03161    0.00552  5.73 1.0e-08\nLog(scale)      -0.53314    0.06863 -7.77 7.9e-15\n\nScale= 0.587 \n\nLog logistic distribution\nLoglik(model)= -1093.9   Loglik(intercept only)= -1120\n    Chisq= 52.18 on 3 degrees of freedom, p= 2.7e-11 \nNumber of Newton-Raphson Iterations: 4 \nn= 238"
  },
  {
    "objectID": "semanas/Aula06x1.html#previsÃµes-2",
    "href": "semanas/Aula06x1.html#previsÃµes-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "PrevisÃµes",
    "text": "PrevisÃµes\n\n```{r}\nnovosdados <- data.frame(clinic = c(\"1\", \"2\"),\n                         prison = factor(c(0, 0)), dose = c(60, 60))\nprevis <- predict(TFALl, type = \"quantile\", \n                  newdata = novosdados, p = 0.5)\nprevis\nprevis[2]/previs[1]\nprevis <- predict(TFALl, type = \"quantile\", \n                  newdata = novosdados, p = 0.7)\nprevis\nprevis[2]/previs[1]\n```\n\n       1        2 \n235.1125 420.1710 \n       2 \n1.787106 \n       1        2 \n386.5353 690.7797 \n       2 \n1.787106"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-2",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n```{r}\n#| output-location: slide\n#| fig-width: 15\n#| fig-height: 8\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(TFALl, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$survt[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(log.resid, dist = \"logis\", \nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos Logistica\", ylab = \"Quantis empiricos\")\n```"
  },
  {
    "objectID": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-2-output",
    "href": "semanas/Aula06x1.html#diagnÃ³stico-do-modelo-2-output",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do Modelo",
    "text": "DiagnÃ³stico do Modelo\n\n[1]  86 110"
  },
  {
    "objectID": "semanas/Aula06x1.html#usando-o-stepaic",
    "href": "semanas/Aula06x1.html#usando-o-stepaic",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Usando o stepAIC",
    "text": "Usando o stepAIC\n\n```{r}\nlibrary(MASS)\nTFAWei <- survreg(Surv(survt, status) ~ clinic + factor(prison) + dose,\n                   dist = \"weibull\", \n                   data=dados)\nTFAWei_AIC <- stepAIC(TFAWei, trace=FALSE)\nsummary(TFAWei_AIC)\n```\n\n\nCall:\nsurvreg(formula = Surv(survt, status) ~ clinic + factor(prison) + \n    dose, data = dados, dist = \"weibull\")\n                   Value Std. Error     z       p\n(Intercept)      4.10485    0.32806 12.51 < 2e-16\nclinic           0.70904    0.15722  4.51 6.5e-06\nfactor(prison)1 -0.22947    0.12079 -1.90   0.057\ndose             0.02443    0.00459  5.32 1.0e-07\nLog(scale)      -0.31495    0.06756 -4.66 3.1e-06\n\nScale= 0.73 \n\nWeibull distribution\nLoglik(model)= -1084.5   Loglik(intercept only)= -1114.9\n    Chisq= 60.89 on 3 degrees of freedom, p= 3.8e-13 \nNumber of Newton-Raphson Iterations: 7 \nn= 238"
  },
  {
    "objectID": "semanas/Aula07.html",
    "href": "semanas/Aula07.html",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "",
    "text": "Nesta etapa vamos comeÃ§ar a trabalhar com modelos de regressÃ£o paramÃ©tricos.\nOs modelos que vamos ver se denominam modelos de tempo de falha (vida) acelerado TFA (AFT).\nO conjunto de dados a seguir chamado â€œanderson.xlsxâ€ consiste em tempos de remissÃ£o (em semanas) em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padrÃ£o. A variÃ¡vel de exposiÃ§Ã£o de interesse Ã© o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padrÃ£o).\nDuas outras variÃ¡veis para controle como potenciais confundidores sÃ£o a contagem de glÃ³bulos brancos (ou seja, logwbc) e sexo. O status de falha Ã© definido pela variÃ¡vel recaÃ­da (0 se censurado, 1 se falhar)."
  },
  {
    "objectID": "semanas/Aula07.html#modelo-exponencial",
    "href": "semanas/Aula07.html#modelo-exponencial",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Exponencial",
    "text": "Modelo Exponencial\n\nleuc.exp.comp <- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"exponential\")\nsummary(leuc.exp.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"exponential\")\n              Value Std. Error     z      p\n(Intercept)  5.9741     0.6965  8.58 <2e-16\nsexo        -0.0859     0.3834 -0.22  0.823\nlogwbc      -0.8723     0.2212 -3.94  8e-05\nRx          -1.1156     0.4270 -2.61  0.009\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.7   Loglik(intercept only)= -116.8\n    Chisq= 32.04 on 3 degrees of freedom, p= 5.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#automatizando-ajuste",
    "href": "semanas/Aula07.html#automatizando-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\nleuc.exp.sel <- stepAIC(leuc.exp.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.exp.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"exponential\")\n             Value Std. Error     z       p\n(Intercept)  5.958      0.699  8.52 < 2e-16\nlogwbc      -0.884      0.216 -4.10 4.2e-05\nRx          -1.093      0.413 -2.65  0.0082\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.8   Loglik(intercept only)= -116.8\n    Chisq= 31.99 on 2 degrees of freedom, p= 1.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previsÃµes",
    "href": "semanas/Aula07.html#fazendo-previsÃµes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Fazendo PrevisÃµes",
    "text": "Fazendo PrevisÃµes\n\nnovosdados <- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.exp.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n4.189084 3.096010"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano",
    "href": "semanas/Aula07.html#tempo-mediano",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 <-predict(leuc.exp.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n45.72161 15.32518 \n\nprev1[1]/prev1[2]\n\n       1 \n2.983431"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 <-predict(leuc.exp.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n79.41687 26.61931 \n\nprev2[1]/prev2[2]\n\n       1 \n2.983431"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo",
    "href": "semanas/Aula07.html#verificando-o-modelo",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\nsmoothSEcurve <- function(yy, xx) {\n# usar depois de chamar um grafico\n# Ajusta um curva lowess curve com IC de 95%\n## Facilita a avaliaÃ§Ã£o dos resÃ­duos\nxx.list <- min(xx) + ((0:100)/100)*(max(xx) - min(xx))\nyy.xx <- predict(loess(yy ~ xx), se=T,\nnewdata=data.frame(xx=xx.list))\nlines(yy.xx$fit ~ xx.list, lwd=2)\nlines(yy.xx$fit -\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\nlines(yy.xx$fit +\nqt(0.975, yy.xx$df)*yy.xx$se.fit ~ xx.list, lty=2)\n}\n\n\nlibrary(car)\n\nCarregando pacotes exigidos: carData\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(leuc.exp.sel, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 16"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-weibull",
    "href": "semanas/Aula07.html#modelo-weibull",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Weibull",
    "text": "Modelo Weibull\n\nleuc.wei.comp <- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"weibull\")\nsummary(leuc.wei.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.462      0.351 15.58 < 2e-16\nsexo        -0.156      0.179 -0.87 0.38350\nlogwbc      -0.792      0.105 -7.54 4.8e-14\nRx          -0.722      0.201 -3.59 0.00034\nLog(scale)  -0.815      0.144 -5.65 1.6e-08\n\nScale= 0.443 \n\nWeibull distribution\nLoglik(model)= -89.7   Loglik(intercept only)= -116.4\n    Chisq= 53.42 on 3 degrees of freedom, p= 1.5e-11 \nNumber of Newton-Raphson Iterations: 7 \nn= 42 \n\n\n\nleuc.wei.sel <- stepAIC(leuc.wei.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.wei.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.399      0.364 14.84 < 2e-16\nlogwbc      -0.807      0.108 -7.45 9.7e-14\nRx          -0.659      0.189 -3.49 0.00049\nLog(scale)  -0.793      0.142 -5.58 2.5e-08\n\nScale= 0.452 \n\nWeibull distribution\nLoglik(model)= -90.1   Loglik(intercept only)= -116.4\n    Chisq= 52.68 on 2 degrees of freedom, p= 3.6e-12 \nNumber of Newton-Raphson Iterations: 7 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previsÃµes-1",
    "href": "semanas/Aula07.html#fazendo-previsÃµes-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Fazendo PrevisÃµes",
    "text": "Fazendo PrevisÃµes\n\nnovosdados <- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.wei.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.784108 3.125137"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-1",
    "href": "semanas/Aula07.html#tempo-mediano-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 <-predict(leuc.wei.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n37.27311 19.28448 \n\nprev1[1]/prev1[2]\n\n       1 \n1.932804"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-1",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 <-predict(leuc.wei.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n47.85133 24.75747 \n\nprev2[1]/prev2[2]\n\n       1 \n1.932804"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-1",
    "href": "semanas/Aula07.html#verificando-o-modelo-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(leuc.wei.sel, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"weibull\",\nshape = 1/leuc.wei.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 16"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-lognormal",
    "href": "semanas/Aula07.html#modelo-lognormal",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Lognormal",
    "text": "Modelo Lognormal\n\nleuc.logn.comp <- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"lognormal\")\nsummary(leuc.logn.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n              Value Std. Error     z       p\n(Intercept)  4.9975     0.3924 12.74 < 2e-16\nsexo        -0.0947     0.2211 -0.43 0.66862\nlogwbc      -0.7051     0.1251 -5.64 1.7e-08\nRx          -0.8539     0.2311 -3.69 0.00022\nLog(scale)  -0.4424     0.1293 -3.42 0.00062\n\nScale= 0.642 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 43.08 on 3 degrees of freedom, p= 2.4e-09 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\n\n\nleuc.logn.sel <- stepAIC(leuc.logn.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.logn.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n             Value Std. Error     z       p\n(Intercept)  4.982      0.394 12.65 < 2e-16\nlogwbc      -0.716      0.123 -5.80 6.6e-09\nRx          -0.848      0.232 -3.66 0.00025\nLog(scale)  -0.437      0.129 -3.39 0.00070\n\nScale= 0.646 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 42.9 on 2 degrees of freedom, p= 4.8e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previsÃµes-2",
    "href": "semanas/Aula07.html#fazendo-previsÃµes-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Fazendo PrevisÃµes",
    "text": "Fazendo PrevisÃµes\n\nnovosdados <- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.logn.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.549821 2.702019"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-2",
    "href": "semanas/Aula07.html#tempo-mediano-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 <-predict(leuc.logn.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n34.80708 14.90980 \n\nprev1[1]/prev1[2]\n\n      1 \n2.33451"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-2",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 <-predict(leuc.logn.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n48.83742 20.91977 \n\nprev2[1]/prev2[2]\n\n      1 \n2.33451"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-2",
    "href": "semanas/Aula07.html#verificando-o-modelo-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(leuc.logn.sel, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"norm\",\nsd = leuc.logn.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 12"
  },
  {
    "objectID": "semanas/Aula07.html#modelo-loglogistico",
    "href": "semanas/Aula07.html#modelo-loglogistico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Loglogistico",
    "text": "Modelo Loglogistico\n\nleuc.logl.comp <- survreg(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, dist = \"loglogistic\")\nsummary(leuc.logl.comp)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n              Value Std. Error     z       p\n(Intercept)  5.0190     0.3518 14.27 < 2e-16\nsexo        -0.0408     0.2027 -0.20 0.84065\nlogwbc      -0.7278     0.1098 -6.63 3.4e-11\nRx          -0.7494     0.2133 -3.51 0.00044\nLog(scale)  -1.0894     0.1509 -7.22 5.1e-13\n\nScale= 0.336 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.08 on 3 degrees of freedom, p= 5.5e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\n\n\nleuc.logl.sel <- stepAIC(leuc.logl.comp, direction=\"backward\", trace=FALSE)\nsummary(leuc.logl.sel)\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n             Value Std. Error     z       p\n(Intercept)  5.008      0.348 14.40 < 2e-16\nlogwbc      -0.733      0.108 -6.81 9.8e-12\nRx          -0.743      0.210 -3.54   4e-04\nLog(scale)  -1.089      0.151 -7.22 5.3e-13\n\nScale= 0.337 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.04 on 2 degrees of freedom, p= 1e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42"
  },
  {
    "objectID": "semanas/Aula07.html#fazendo-previsÃµes-3",
    "href": "semanas/Aula07.html#fazendo-previsÃµes-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Fazendo PrevisÃµes",
    "text": "Fazendo PrevisÃµes\n\nnovosdados <- data.frame(logwbc=c(2,2), Rx=c(0,1))\npredict(leuc.logl.sel, type=\"lp\", newdata=novosdados)\n\n       1        2 \n3.542894 2.800346"
  },
  {
    "objectID": "semanas/Aula07.html#tempo-mediano-3",
    "href": "semanas/Aula07.html#tempo-mediano-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Tempo Mediano",
    "text": "Tempo Mediano\n\nprev1 <-predict(leuc.logl.sel, type=\"quantile\", newdata=novosdados, p=0.5)\nprev1\n\n       1        2 \n34.56680 16.45034 \n\nprev1[1]/prev1[2]\n\n       1 \n2.101282"
  },
  {
    "objectID": "semanas/Aula07.html#comparando-com-outro-quantil-3",
    "href": "semanas/Aula07.html#comparando-com-outro-quantil-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Comparando com outro quantil",
    "text": "Comparando com outro quantil\n\nprev2 <-predict(leuc.logl.sel, type=\"quantile\", newdata=novosdados, p=0.7)\nprev2\n\n       1        2 \n45.97221 21.87818 \n\nprev2[1]/prev2[2]\n\n       1 \n2.101282"
  },
  {
    "objectID": "semanas/Aula07.html#verificando-o-modelo-3",
    "href": "semanas/Aula07.html#verificando-o-modelo-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Verificando o modelo",
    "text": "Verificando o modelo\n\npar(mfrow = c(1, 2), cex = 0.6)\npred.lin <- predict(leuc.logl.sel, type = \"lp\")[dados$status == 1]\nlog.resid <- log(dados$tempo[dados$status == 1]) - pred.lin\nplot(pred.lin, log.resid, main = \"Grafico TA\",\nxlab = \"log(valores ajustados)\", ylab = \"log(residuos)\")\nsmoothSEcurve(log.resid, pred.lin)\nqqPlot(exp(log.resid), dist = \"logis\",\nscale = leuc.logl.sel$scale,\nmain = \"Grafico Q-Q\", xlab = \"Quantis teoricos\", ylab = \"Quantis Empiricos\")\n\n\n\n\n[1] 11 12"
  },
  {
    "objectID": "semanas/Aula07.html#comparaÃ§Ã£o-dos-modelos",
    "href": "semanas/Aula07.html#comparaÃ§Ã£o-dos-modelos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ComparaÃ§Ã£o dos modelos",
    "text": "ComparaÃ§Ã£o dos modelos\n\ntab.exp <- summary(leuc.exp.sel)\ntab.exp\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"exponential\")\n             Value Std. Error     z       p\n(Intercept)  5.958      0.699  8.52 < 2e-16\nlogwbc      -0.884      0.216 -4.10 4.2e-05\nRx          -1.093      0.413 -2.65  0.0082\n\nScale fixed at 1 \n\nExponential distribution\nLoglik(model)= -100.8   Loglik(intercept only)= -116.8\n    Chisq= 31.99 on 2 degrees of freedom, p= 1.1e-07 \nNumber of Newton-Raphson Iterations: 4 \nn= 42 \n\ntab.wei <- summary(leuc.wei.sel)\ntab.wei\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"weibull\")\n             Value Std. Error     z       p\n(Intercept)  5.399      0.364 14.84 < 2e-16\nlogwbc      -0.807      0.108 -7.45 9.7e-14\nRx          -0.659      0.189 -3.49 0.00049\nLog(scale)  -0.793      0.142 -5.58 2.5e-08\n\nScale= 0.452 \n\nWeibull distribution\nLoglik(model)= -90.1   Loglik(intercept only)= -116.4\n    Chisq= 52.68 on 2 degrees of freedom, p= 3.6e-12 \nNumber of Newton-Raphson Iterations: 7 \nn= 42 \n\nTRV <- 2*(tab.wei$loglik[1] - tab.exp$loglik[1])\npchisq(TRV, 1, lower.tail = F)\n\n[1] 0.3953251\n\ntab.ln <- summary(leuc.logn.sel)\ntab.ln\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"lognormal\")\n             Value Std. Error     z       p\n(Intercept)  4.982      0.394 12.65 < 2e-16\nlogwbc      -0.716      0.123 -5.80 6.6e-09\nRx          -0.848      0.232 -3.66 0.00025\nLog(scale)  -0.437      0.129 -3.39 0.00070\n\nScale= 0.646 \n\nLog Normal distribution\nLoglik(model)= -93.9   Loglik(intercept only)= -115.4\n    Chisq= 42.9 on 2 degrees of freedom, p= 4.8e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\ntab.ll <- summary(leuc.logl.sel)\ntab.ll\n\n\nCall:\nsurvreg(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados, \n    dist = \"loglogistic\")\n             Value Std. Error     z       p\n(Intercept)  5.008      0.348 14.40 < 2e-16\nlogwbc      -0.733      0.108 -6.81 9.8e-12\nRx          -0.743      0.210 -3.54   4e-04\nLog(scale)  -1.089      0.151 -7.22 5.3e-13\n\nScale= 0.337 \n\nLog logistic distribution\nLoglik(model)= -92.3   Loglik(intercept only)= -115.4\n    Chisq= 46.04 on 2 degrees of freedom, p= 1e-10 \nNumber of Newton-Raphson Iterations: 6 \nn= 42 \n\naic.exp <- -2*tab.exp$loglik[1] + 2*3\naic.exp\n\n[1] 239.5333\n\naic.wei <- -2*tab.wei$loglik[1] + 2*4\naic.wei\n\n[1] 240.8108\n\naic.ln <- -2*tab.ln$loglik[1] + 2*4\naic.ln\n\n[1] 238.786\n\naic.ll <- -2*tab.ll$loglik[1] + 2*4\naic.ll\n\n[1] 238.7022\n\naic <- c(aic.exp, aic.wei, aic.ln, aic.ll)\ndelta.aic <- aic - min(aic)\ndelta.aic\n\n[1] 0.83108732 2.10858745 0.08373248 0.00000000\n\npeso.aic <- exp(-0.5*delta.aic)/sum(exp(-0.5*delta.aic))\nsum(peso.aic)\n\n[1] 1\n\nmodelos <- data.frame(modelos=c(\"Exponencial\", \"Weibull\",\n                                \"Lognormal\", \"Loglogistico\"),\n                      p_Akaike = peso.aic)\ngt::gt(modelos)\n\n\n\n\n\n  \n  \n    \n      modelos\n      p_Akaike\n    \n  \n  \n    Exponencial\n0.2224093\n    Weibull\n0.1174214\n    Lognormal\n0.3231759\n    Loglogistico\n0.3369933"
  },
  {
    "objectID": "semanas/Aula08.html",
    "href": "semanas/Aula08.html",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "",
    "text": "Nesta etapa vamos comeÃ§ar a trabalhar com o modelo semi-paramÃ©trico de Cox\nO conjunto de dados a seguir chamado â€œanderson.xlsxâ€ consiste em tempos de remissÃ£o (em semanas) em 42 pacientes com leucemia, metade dos quais recebem uma certa nova terapia de tratamento e a outra metade recebe uma terapia de tratamento padrÃ£o.\nA variÃ¡vel de exposiÃ§Ã£o de interesse Ã© o tratamento (Rx = 0 se novo tratamento, Rx = 1 se tratamento padrÃ£o).\nDuas outras variÃ¡veis para controle como potenciais confundidores sÃ£o a contagem de glÃ³bulos brancos (ou seja, logwbc) e sexo. O status de falha Ã© definido pela variÃ¡vel recaÃ­da (0 se censurado, 1 se falhar)."
  },
  {
    "objectID": "semanas/Aula08.html#carregando-os-dados",
    "href": "semanas/Aula08.html#carregando-os-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\nlibrary(survival)\nlibrary(readxl)\ndados <- read_xlsx(\"anderson.xlsx\", col_names = TRUE )\nsummary(dados)\n\n     tempo           status            sexo            logwbc     \n Min.   : 1.00   Min.   :0.0000   Min.   :0.0000   Min.   :1.450  \n 1st Qu.: 6.00   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2.303  \n Median :10.50   Median :1.0000   Median :0.0000   Median :2.800  \n Mean   :12.88   Mean   :0.7143   Mean   :0.4762   Mean   :2.930  \n 3rd Qu.:18.50   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:3.490  \n Max.   :35.00   Max.   :1.0000   Max.   :1.0000   Max.   :5.000  \n       Rx     \n Min.   :0.0  \n 1st Qu.:0.0  \n Median :0.5  \n Mean   :0.5  \n 3rd Qu.:1.0  \n Max.   :1.0"
  },
  {
    "objectID": "semanas/Aula08.html#ajuste-nÃ£o-paramÃ©trico",
    "href": "semanas/Aula08.html#ajuste-nÃ£o-paramÃ©trico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste NÃ£o ParamÃ©trico",
    "text": "Ajuste NÃ£o ParamÃ©trico\n\nekm <- survfit(Surv(tempo,status)~Rx, data=dados)\ntempo <- ekm$time\nst <- ekm$surv\nsummary(ekm)\n\nCall: survfit(formula = Surv(tempo, status) ~ Rx, data = dados)\n\n                Rx=0 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    6     21       3    0.857  0.0764        0.720        1.000\n    7     17       1    0.807  0.0869        0.653        0.996\n   10     15       1    0.753  0.0963        0.586        0.968\n   13     12       1    0.690  0.1068        0.510        0.935\n   16     11       1    0.627  0.1141        0.439        0.896\n   22      7       1    0.538  0.1282        0.337        0.858\n   23      6       1    0.448  0.1346        0.249        0.807\n\n                Rx=1 \n time n.risk n.event survival std.err lower 95% CI upper 95% CI\n    1     21       2   0.9048  0.0641      0.78754        1.000\n    2     19       2   0.8095  0.0857      0.65785        0.996\n    3     17       1   0.7619  0.0929      0.59988        0.968\n    4     16       2   0.6667  0.1029      0.49268        0.902\n    5     14       2   0.5714  0.1080      0.39455        0.828\n    8     12       4   0.3810  0.1060      0.22085        0.657\n   11      8       2   0.2857  0.0986      0.14529        0.562\n   12      6       2   0.1905  0.0857      0.07887        0.460\n   15      4       1   0.1429  0.0764      0.05011        0.407\n   17      3       1   0.0952  0.0641      0.02549        0.356\n   22      2       1   0.0476  0.0465      0.00703        0.322\n   23      1       1   0.0000     NaN           NA           NA\n\nplot(ekm, xlab=\"T(semanas)\",ylab=\"S(t)\", lty=2:3)\nlegend(\"topright\",c(\"Rx=0\",\"Rx=1\"), lty = 2:3)"
  },
  {
    "objectID": "semanas/Aula08.html#modelo-semi-paramÃ©trico-de-cox",
    "href": "semanas/Aula08.html#modelo-semi-paramÃ©trico-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Semi-paramÃ©trico de Cox",
    "text": "Modelo Semi-paramÃ©trico de Cox\n\nleuc.cox1 <- coxph(Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados)\nsummary(leuc.cox1)\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ sexo + logwbc + Rx, data = dados)\n\n  n= 42, number of events= 30 \n\n         coef exp(coef) se(coef)     z Pr(>|z|)    \nsexo   0.3147    1.3698   0.4545 0.692  0.48872    \nlogwbc 1.6819    5.3760   0.3366 4.997 5.82e-07 ***\nRx     1.5036    4.4978   0.4615 3.258  0.00112 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n       exp(coef) exp(-coef) lower .95 upper .95\nsexo       1.370     0.7300    0.5621     3.338\nlogwbc     5.376     0.1860    2.7794    10.398\nRx         4.498     0.2223    1.8204    11.113\n\nConcordance= 0.851  (se = 0.041 )\nLikelihood ratio test= 47.19  on 3 df,   p=3e-10\nWald test            = 33.54  on 3 df,   p=2e-07\nScore (logrank) test = 48.01  on 3 df,   p=2e-10"
  },
  {
    "objectID": "semanas/Aula08.html#automatizando-ajuste",
    "href": "semanas/Aula08.html#automatizando-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\nleuc.cox2 <- stepAIC(leuc.cox1, direction=\"backward\", trace=FALSE)\nsummary(leuc.cox2)\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ logwbc + Rx, data = dados)\n\n  n= 42, number of events= 30 \n\n         coef exp(coef) se(coef)     z Pr(>|z|)    \nlogwbc 1.6909    5.4243   0.3359 5.034  4.8e-07 ***\nRx     1.3861    3.9991   0.4248 3.263   0.0011 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n       exp(coef) exp(-coef) lower .95 upper .95\nlogwbc     5.424     0.1844     2.808    10.478\nRx         3.999     0.2501     1.739     9.195\n\nConcordance= 0.852  (se = 0.04 )\nLikelihood ratio test= 46.71  on 2 df,   p=7e-11\nWald test            = 33.6  on 2 df,   p=5e-08\nScore (logrank) test = 46.07  on 2 df,   p=1e-10"
  },
  {
    "objectID": "semanas/Aula08.html#informaÃ§Ãµes-do-ajuste",
    "href": "semanas/Aula08.html#informaÃ§Ãµes-do-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "InformaÃ§Ãµes do Ajuste",
    "text": "InformaÃ§Ãµes do Ajuste\n\ncoef(leuc.cox2)\n\n  logwbc       Rx \n1.690890 1.386076 \n\nlogLik(leuc.cox2)\n\n'log Lik.' -69.8281 (df=2)"
  },
  {
    "objectID": "semanas/Aula08.html#avaliando-o-ajuste-1",
    "href": "semanas/Aula08.html#avaliando-o-ajuste-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando o ajuste 1",
    "text": "Avaliando o ajuste 1\n\nlibrary(rms)\nsurvplot(npsurv(Surv(tempo, status) ~ Rx, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula08.html#avaliando-o-ajuste-2",
    "href": "semanas/Aula08.html#avaliando-o-ajuste-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando o ajuste 2",
    "text": "Avaliando o ajuste 2\n\nlibrary(survminer)\nponto <- surv_cutpoint(dados, time = \"tempo\", event = \"status\", variables = \"logwbc\")\nponto$cutpoint[1]\n\n       cutpoint\nlogwbc     2.73\n\ndados$grupolwbc <- cut(dados$logwbc,ponto$cutpoint[1])\nsurvplot(npsurv(Surv(tempo, status) ~ grupolwbc, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula08.html#curva-de-sobrevivÃªncia",
    "href": "semanas/Aula08.html#curva-de-sobrevivÃªncia",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Curva de SobrevivÃªncia",
    "text": "Curva de SobrevivÃªncia\n\namostra <- data.frame(\nRx = c(0, 1), logwbc = rep(mean(dados$logwbc), 2))\namostra.surv <- survfit(leuc.cox2, newdata = amostra)\nplot(amostra.surv, col = c(1, 2), conf.int = TRUE,\nxlab = \"Tempo\", ylab = \"S(t)\")\nlegend(\"bottomleft\", bty = \"n\", lty = 1, col = 1:2,\nlegend = sprintf(\"Rx %d\", 0:1))"
  },
  {
    "objectID": "semanas/Aula09.html",
    "href": "semanas/Aula09.html",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "",
    "text": "Vamos usar neste exemplo dados da biblioteca survival.\nOs dados sÃ£o de sobrevivÃªncia de pacientes com cancer de pulmÃ£o em estÃ¡gio avanÃ§ado do North Central Cancer Treatment Group.\n- inst: CÃ³dico da IntituiÃ§Ã£o\n- time: Tempo de sobrevivÃªncia em dias\n- status: 1=censurado, 2=morto\n- age: Idade em anos\n- sex: 1=Homem 2 = Mulher\n- ph.ecog: escore ecog 0=bom 5=morto\n- ph.karno: escore de Karnofsky (ruim=0-bom=100) definido pelo mÃ©dico\n- pat.karno: escore de Karnofsky definido pelo paciente\n- meal.cal: Calorias consumidas nas refeiÃ§Ãµes\n- wt.loss: Perda de peso nos Ãºltimos seis meses (libras)"
  },
  {
    "objectID": "semanas/Aula09.html#modelo-semi-paramÃ©trico-de-cox",
    "href": "semanas/Aula09.html#modelo-semi-paramÃ©trico-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo Semi-paramÃ©trico de Cox",
    "text": "Modelo Semi-paramÃ©trico de Cox\n\najuste1 <- coxph(Surv(time, status) ~ age + sex + ph.ecog +\n                   ph.karno + pat.karno + meal.cal + wt.loss, data = dados)\nsummary(ajuste1)\n\nCall:\ncoxph(formula = Surv(time, status) ~ age + sex + ph.ecog + ph.karno + \n    pat.karno + meal.cal + wt.loss, data = dados)\n\n  n= 167, number of events= 120 \n\n                coef  exp(coef)   se(coef)      z Pr(>|z|)   \nage        1.080e-02  1.011e+00  1.160e-02  0.931  0.35168   \nsex       -5.536e-01  5.749e-01  2.016e-01 -2.746  0.00603 **\nph.ecog    7.395e-01  2.095e+00  2.250e-01  3.287  0.00101 **\nph.karno   2.244e-02  1.023e+00  1.123e-02  1.998  0.04575 * \npat.karno -1.207e-02  9.880e-01  8.116e-03 -1.488  0.13685   \nmeal.cal   2.835e-05  1.000e+00  2.594e-04  0.109  0.91298   \nwt.loss   -1.420e-02  9.859e-01  7.766e-03 -1.828  0.06748 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n          exp(coef) exp(-coef) lower .95 upper .95\nage          1.0109     0.9893    0.9881    1.0341\nsex          0.5749     1.7395    0.3872    0.8534\nph.ecog      2.0950     0.4773    1.3479    3.2560\nph.karno     1.0227     0.9778    1.0004    1.0455\npat.karno    0.9880     1.0121    0.9724    1.0038\nmeal.cal     1.0000     1.0000    0.9995    1.0005\nwt.loss      0.9859     1.0143    0.9710    1.0010\n\nConcordance= 0.653  (se = 0.029 )\nLikelihood ratio test= 28.16  on 7 df,   p=2e-04\nWald test            = 27.5  on 7 df,   p=3e-04\nScore (logrank) test = 28.31  on 7 df,   p=2e-04\n\nlogLik(ajuste1)\n\n'log Lik.' -494.0344 (df=7)"
  },
  {
    "objectID": "semanas/Aula09.html#usando-o-teste-de-wald-e-da-razÃ£o-de-verossimilhanÃ§a",
    "href": "semanas/Aula09.html#usando-o-teste-de-wald-e-da-razÃ£o-de-verossimilhanÃ§a",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Usando o teste de Wald e da razÃ£o de verossimilhanÃ§a",
    "text": "Usando o teste de Wald e da razÃ£o de verossimilhanÃ§a\nO teste de Wald avalia a estatÃ­stica z, que no caso acima indica que diversas variÃ¡veis nÃ£o sÃ£o significativas, por exemplo, meat.cal, age, pat.karno.\nVamos eliminar somente meat.cal e fazer o teste da razÃ£o de verossimilhanÃ§a para confirmarmos que ela nÃ£o Ã© estatÃ­sticamente significativa.\n\najuste2 <- coxph(Surv(time, status) ~ age + sex + ph.ecog +\n                   ph.karno + pat.karno + wt.loss, data = dados)\nlogLik(ajuste2)\n\n'log Lik.' -494.0404 (df=6)\n\nTRV <- 2*(logLik(ajuste1) - logLik(ajuste2))\npchisq(TRV[1],1, lower.tail = FALSE)\n\n[1] 0.9131696\n\n\nO resultado acima confirma que o modelo nÃ£o Ã© afetado pela retirada de meat.cal, ou seja, ela nÃ£o Ã© estatÃ­sticamente significativa."
  },
  {
    "objectID": "semanas/Aula09.html#automatizando-ajuste",
    "href": "semanas/Aula09.html#automatizando-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Automatizando ajuste",
    "text": "Automatizando ajuste\n\nlibrary(MASS)\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\najuste3 <- stepAIC(ajuste1, direction=\"backward\", trace=FALSE)\nsummary(ajuste3)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + ph.ecog + ph.karno + \n    pat.karno + wt.loss, data = dados)\n\n  n= 167, number of events= 120 \n\n               coef exp(coef)  se(coef)      z Pr(>|z|)   \nsex       -0.558190  0.572244  0.199202 -2.802  0.00508 **\nph.ecog    0.742983  2.102197  0.227604  3.264  0.00110 **\nph.karno   0.020366  1.020575  0.011080  1.838  0.06604 . \npat.karno -0.012401  0.987675  0.007978 -1.554  0.12008   \nwt.loss   -0.014494  0.985611  0.007693 -1.884  0.05957 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n          exp(coef) exp(-coef) lower .95 upper .95\nsex          0.5722     1.7475    0.3873    0.8456\nph.ecog      2.1022     0.4757    1.3457    3.2841\nph.karno     1.0206     0.9798    0.9987    1.0430\npat.karno    0.9877     1.0125    0.9724    1.0032\nwt.loss      0.9856     1.0146    0.9709    1.0006\n\nConcordance= 0.658  (se = 0.029 )\nLikelihood ratio test= 27.28  on 5 df,   p=5e-05\nWald test            = 26.89  on 5 df,   p=6e-05\nScore (logrank) test = 27.64  on 5 df,   p=4e-05\n\n\nVeja que wt.loss e ph.karno sÃ£o marginalmente significativas. pat.karno tem p-valor acima de 0,10 o que normalmente indicaria sua retirada do modelo."
  },
  {
    "objectID": "semanas/Aula09.html#usando-o-bic",
    "href": "semanas/Aula09.html#usando-o-bic",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Usando o BIC",
    "text": "Usando o BIC\n\nn_eventos <- sum(dados$status)\najuste4 <- stepAIC(ajuste1, direction=\"backward\", k= log(n_eventos), trace=FALSE)\nsummary(ajuste4)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + ph.ecog, data = dados)\n\n  n= 167, number of events= 120 \n\n           coef exp(coef) se(coef)      z Pr(>|z|)    \nsex     -0.5101    0.6004   0.1969 -2.591 0.009579 ** \nph.ecog  0.4825    1.6201   0.1323  3.647 0.000266 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n        exp(coef) exp(-coef) lower .95 upper .95\nsex        0.6004     1.6655    0.4082    0.8832\nph.ecog    1.6201     0.6172    1.2501    2.0998\n\nConcordance= 0.641  (se = 0.031 )\nLikelihood ratio test= 19.48  on 2 df,   p=6e-05\nWald test            = 19.35  on 2 df,   p=6e-05\nScore (logrank) test = 19.62  on 2 df,   p=5e-05"
  },
  {
    "objectID": "semanas/Aula09.html#informaÃ§Ãµes-do-ajuste",
    "href": "semanas/Aula09.html#informaÃ§Ãµes-do-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "InformaÃ§Ãµes do Ajuste",
    "text": "InformaÃ§Ãµes do Ajuste\n\ncoef(ajuste4)\n\n       sex    ph.ecog \n-0.5100991  0.4825185 \n\nlogLik(ajuste4)\n\n'log Lik.' -498.3757 (df=2)"
  },
  {
    "objectID": "semanas/Aula09.html#tempos-idÃªnticos",
    "href": "semanas/Aula09.html#tempos-idÃªnticos",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Tempos IdÃªnticos",
    "text": "Tempos IdÃªnticos\n\najuste5 <- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"efron\", \n                 data=dados)\najuste6 <- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"breslow\", \n                 data=dados)\najuste7 <- coxph(Surv(time,status==2) ~ sex + ph.ecog , \n                 ties= \"exact\", \n                 data=dados)\ndif_met <- rbind(coef(ajuste5), coef(ajuste6), coef(ajuste7))\nrow.names(dif_met) <- c(\"Efron\", \"Breslow\", \"Exact\")\nknitr::kable(dif_met)\n\n\n\n\n\nsex\nph.ecog\n\n\n\n\nEfron\n-0.5100991\n0.4825185\n\n\nBreslow\n-0.5094047\n0.4823368\n\n\nExact\n-0.5103502\n0.4832902\n\n\n\n\n\nObserve que as diferenÃ§as entre os mÃ©todos sÃ£o pequenas, nÃ£o afetando a interpretaÃ§Ã£o."
  },
  {
    "objectID": "semanas/Aula09.html#avaliando-ajuste",
    "href": "semanas/Aula09.html#avaliando-ajuste",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando Ajuste",
    "text": "Avaliando Ajuste\n\nav1 <- survfit(Surv(time, status) ~ sex, data = dados)\nav1.tab <- summary(av1)\nplot(log(av1.tab$time),log(-log(av1.tab$surv)),\ncol = av1.tab$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)\nlegend(\"bottomright\", bty = \"n\", lty = 1, col = c(1:2),\nlegend = sprintf(\"Sexo %d\", 1:2))\n\n\n\nav2 <- survfit(Surv(time, status) ~ ph.ecog, data = dados)\nav2.tab <- summary(av2)\nplot(log(av2.tab$time),log(-log(av2.tab$surv)),\ncol = av2.tab$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)\nlegend(\"bottomright\", bty = \"n\", lty = 1, col = c(1,2,3,4),\nlegend = sprintf(\"Ecog %d\", 0:3))\n\n\n\n\nNÃ£o temos indicaÃ§Ã£o grÃ¡fica de nÃ£o proporcionalidade das taxas de falhas"
  },
  {
    "objectID": "semanas/Aula09.html#resÃ­duos-de-cox-snell",
    "href": "semanas/Aula09.html#resÃ­duos-de-cox-snell",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Cox-Snell",
    "text": "ResÃ­duos de Cox-Snell\n\nlibrary(car)\ncox.snell <- abs(dados$status - ajuste4$residuals)\nqqPlot(cox.snell, dist = \"exp\", rate = mean(cox.snell))\n\n\n\n\n37 18 \n25 11 \n\n\nAlgum desvio na cauda direita"
  },
  {
    "objectID": "semanas/Aula09.html#resÃ­duos-de-schoenfeld",
    "href": "semanas/Aula09.html#resÃ­duos-de-schoenfeld",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Schoenfeld",
    "text": "ResÃ­duos de Schoenfeld\n\ncox.zph(ajuste4)\n\n        chisq df     p\nsex      1.24  1 0.266\nph.ecog  5.27  1 0.022\nGLOBAL   6.19  2 0.045\n\nresid.sch <- cox.zph(ajuste4)\npar(mfrow=c(1,3))\nplot(resid.sch)\n\n\n\n\nNÃ£o hÃ¡ indicaÃ§Ã£o significativa de nÃ£o proporcionalidade.\nSomente ph.ecog apresenta um p valor mais baixo indicando um potencial comportamento de nÃ£o proporcionalidade. A hipÃ³tese nula Ã© que o coeficiente angular Ã© zero."
  },
  {
    "objectID": "semanas/Aula09.html#resÃ­duos-martingale-e-deviance",
    "href": "semanas/Aula09.html#resÃ­duos-martingale-e-deviance",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos Martingale e Deviance",
    "text": "ResÃ­duos Martingale e Deviance\nOs resÃ­duos Martingale servem para avaliar alguma forma de nÃ£o lineridade do modelo e os resÃ­duoas deviance para verificarmos a presenÃ§a de outliers.\n\npar(mfrow=c(1,2))\nmart<- residuals(ajuste4,type=\"martingale\")\ndev<- residuals(ajuste4,type=\"deviance\")\nplot(mart, ylab=\"res\",pch=20)\ntitle(\"ResÄ±duos Martingale\")\nplot(dev, ylab=\"res\",pch=20)\ntitle(\"Residuos Deviance\")\n\n\n\n\nNÃ£o temos indicaÃ§Ãµes claras em nenhum dos dois resÃ­duos"
  },
  {
    "objectID": "semanas/Aula09.html#modelo-de-cox-estratificado",
    "href": "semanas/Aula09.html#modelo-de-cox-estratificado",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo de Cox Estratificado",
    "text": "Modelo de Cox Estratificado\nNa eventiualidade de termos um termo claramente violando a proporcionalidade das taxas de falhas, podemos contornar este problema usando a variÃ¡vel como um estrato.\n\najuste4_E <- coxph(Surv(time, status) ~ sex + strata(ph.ecog), data=dados)\nsummary(ajuste4_E)\n\nCall:\ncoxph(formula = Surv(time, status) ~ sex + strata(ph.ecog), data = dados)\n\n  n= 167, number of events= 120 \n\n       coef exp(coef) se(coef)      z Pr(>|z|)   \nsex -0.5434    0.5807   0.2002 -2.715  0.00664 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n    exp(coef) exp(-coef) lower .95 upper .95\nsex    0.5807      1.722    0.3923    0.8598\n\nConcordance= 0.572  (se = 0.027 )\nLikelihood ratio test= 7.75  on 1 df,   p=0.005\nWald test            = 7.37  on 1 df,   p=0.007\nScore (logrank) test = 7.54  on 1 df,   p=0.006\n\n\n\najuste_aux <- survfit(ajuste4_E)\nplot(ajuste_aux, mark.time=FALSE, col=c(1:4), lwd=3, las=1, bty='n', xlab=\"Tempo (dias)\", ylab=\"S(t)\")\nniveis <- sort(unique(dados$ph.ecog))\nlegend(\"topright\", levels(factor(niveis)), lwd=3, col=c(1:6))"
  },
  {
    "objectID": "semanas/Aula10.html#modelo-semiparamÃ©trico-de-cox",
    "href": "semanas/Aula10.html#modelo-semiparamÃ©trico-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo SemiParamÃ©trico de Cox",
    "text": "Modelo SemiParamÃ©trico de Cox\nVamos usar neste exemplo dados de pacientes com leucemia.\nO objetivo Ã© verificar se o novo tratamento proposto, 6MP, tem efeito sobre a doenÃ§a. (Rx=1 ou Rx=0)\nExistem dois grupos de pacientes. 21 receberam 6MP que Ã© um medicamento para tratar leucemia (Rx=0) e os outros 21 receberam placebo (Rx=1).\nAlÃ©m do tipo de tratamento foram coletadas informaÃ§Ãµes sobre o sexo dos pacientes e do log do nÃºmero de cÃ©lulas brancas (logwbc).\nO evento falha aqui Ã© ocorrer uma recaÃ­da na doenÃ§a."
  },
  {
    "objectID": "semanas/Aula10.html#leitura-dos-dados",
    "href": "semanas/Aula10.html#leitura-dos-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Leitura dos Dados",
    "text": "Leitura dos Dados\n\nlibrary(survival)\nlibrary(readxl)\ndados <- read_xlsx(\"anderson.xlsx\")\ngt::gt(head(dados))\n\n\n\n\n\n  \n  \n    \n      tempo\n      status\n      sexo\n      logwbc\n      Rx\n    \n  \n  \n    35\n0\n1\n1.45\n0\n    34\n0\n1\n1.47\n0\n    32\n0\n1\n2.20\n0\n    32\n0\n1\n2.53\n0\n    25\n0\n1\n1.78\n0\n    23\n1\n1\n2.57\n0"
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Somente com a variÃ¡vel Rx\najuste1 <- coxph(Surv(tempo,status) ~ Rx,data=dados)\najuste1\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx, data = dados)\n\n     coef exp(coef) se(coef)     z        p\nRx 1.5721    4.8169   0.4124 3.812 0.000138\n\nLikelihood ratio test=16.35  on 1 df, p=5.261e-05\nn= 42, number of events= 30 \n\n\nComo Rx Ã© uma variÃ¡vel binÃ¡ria, a mudanÃ§a de 0 para 1 implica num aumenta da taxa de falhas."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-1",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Com a variÃ¡vel Rx e logwbc\najuste2 <- coxph(Surv(tempo,status) ~ Rx + logwbc,data=dados)\najuste2\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc, data = dados)\n\n         coef exp(coef) se(coef)     z       p\nRx     1.3861    3.9991   0.4248 3.263  0.0011\nlogwbc 1.6909    5.4243   0.3359 5.034 4.8e-07\n\nLikelihood ratio test=46.71  on 2 df, p=7.187e-11\nn= 42, number of events= 30 \n\n\nO aumento do log do nÃºmero de cÃ©lulas brancas tambÃ©m aumenta a taxa de falhas."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-2",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n# Com a variÃ¡vel Rx, logwbc e sexo\najuste3 <- coxph(Surv(tempo,status) ~ Rx + logwbc + sexo,data=dados)\najuste3\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc + sexo, data = dados)\n\n         coef exp(coef) se(coef)     z        p\nRx     1.5036    4.4978   0.4615 3.258  0.00112\nlogwbc 1.6819    5.3760   0.3366 4.997 5.82e-07\nsexo   0.3147    1.3698   0.4545 0.692  0.48872\n\nLikelihood ratio test=47.19  on 3 df, p=3.171e-10\nn= 42, number of events= 30 \n\n\nO modelo nÃ£o indicou que a variÃ¡vel sexo Ã© estatÃ­sticamente significativa."
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-3",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-3",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\n## Ajuste do Modelo de Cox com sexo como fator\najuste4 <- coxph(Surv(tempo,status) ~ Rx + logwbc + factor(sexo), data=dados)\najuste4\n\nCall:\ncoxph(formula = Surv(tempo, status) ~ Rx + logwbc + factor(sexo), \n    data = dados)\n\n                coef exp(coef) se(coef)     z        p\nRx            1.5036    4.4978   0.4615 3.258  0.00112\nlogwbc        1.6819    5.3760   0.3366 4.997 5.82e-07\nfactor(sexo)1 0.3147    1.3698   0.4545 0.692  0.48872\n\nLikelihood ratio test=47.19  on 3 df, p=3.171e-10\nn= 42, number of events= 30 \n\n\nMesmo transformado a variÃ¡vel sexo em fator, ela permaneceu sem significÃ¢ncia estatÃ­stica."
  },
  {
    "objectID": "semanas/Aula10.html#outro-conjunto-de-dados",
    "href": "semanas/Aula10.html#outro-conjunto-de-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Outro conjunto de dados",
    "text": "Outro conjunto de dados\nNeste exemplo os dados considerados referem-se a um estudo, descrito em Klein e Moeschberger (1997), realizado com 90 pacientes do sexo masculino diagnosticados no perÃ­odo de 1970-1978 com cancer de laringe e que foram acompanhados atÃ© 01/01/1983.\nPara cada paciente foram registrados, no diagnÃ³stico, a idade (em anos) e o estÃ¡gio da doenÃ§a (I = tumor primÃ¡rio, II = desenvolvimento de nÃ³dulos, III = metÃ¡stases e IV = combinaÃ§Ã£o dos 3 estÃ¡giosanteriores) bem como seus respectivos tempos de falha ou censura (em meses).\nOs estÃ¡gios encontram-se ordenados pelo grau de seriedade da doenÃ§a (menos sÃ©rio para mais sÃ©rio)."
  },
  {
    "objectID": "semanas/Aula10.html#leitura-dos-dados-1",
    "href": "semanas/Aula10.html#leitura-dos-dados-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Leitura dos dados",
    "text": "Leitura dos dados\n\nlibrary(tidyverse)\ndados2 <- read_table(\"laringe.txt\")\ngt::gt(head(dados2))\n\n\n\n\n\n  \n  \n    \n      id\n      tempos\n      cens\n      idade\n      estagio\n    \n  \n  \n    1\n0.6\n1\n77\n1\n    2\n1.3\n1\n53\n1\n    3\n2.4\n1\n45\n1\n    4\n3.2\n1\n58\n1\n    5\n3.3\n1\n76\n1\n    6\n3.5\n1\n43\n1"
  },
  {
    "objectID": "semanas/Aula10.html#ajuste-do-modelo-de-cox-4",
    "href": "semanas/Aula10.html#ajuste-do-modelo-de-cox-4",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do Modelo de Cox",
    "text": "Ajuste do Modelo de Cox\n\najuste5 <- coxph(Surv(tempos,cens) ~ factor(estagio),data=dados2)\najuste5\n\nCall:\ncoxph(formula = Surv(tempos, cens) ~ factor(estagio), data = dados2)\n\n                    coef exp(coef) se(coef)     z        p\nfactor(estagio)2 0.06481   1.06696  0.45843 0.141   0.8876\nfactor(estagio)3 0.61481   1.84930  0.35519 1.731   0.0835\nfactor(estagio)4 1.73490   5.66838  0.41939 4.137 3.52e-05\n\nLikelihood ratio test=16.49  on 3 df, p=0.0009016\nn= 90, number of events= 50 \n   (1 observation deleted due to missingness)\n\n\nA medida que o estÃ¡gio aumenta, aumenta a taxa de mortalidade dos pacientes."
  },
  {
    "objectID": "semanas/Aula11.html#diagnÃ³stico-do-modelo-de-cox",
    "href": "semanas/Aula11.html#diagnÃ³stico-do-modelo-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "DiagnÃ³stico do modelo de Cox",
    "text": "DiagnÃ³stico do modelo de Cox\nO conjunto de dados carregados a seguir sÃ£o de 238 pacientes viciados com heroÃ­na.\nOs pacientes foram tratados em duas clÃ­nicas (1 e 2), alÃ©m disso foram coletadas informaÃ§Ãµes sobre dose de medicamento ministrado no tratamento e se o paciente jÃ¡ havia sido preso ou nÃ£o.\nOs tempos (survt) sÃ£o em dias e o evento analisado foi o tempo atÃ© a saÃ­da da clÃ­nica (status=1) ou o tempo atÃ© o tÃ©rmino de estudo (tempo censurado (status=0).\n\nid: IdentificaÃ§Ã£o do paciente\nclinic: clinica em que ocorreu o tratamento\nsurvt: tempo atÃ© a saÃ­da da clÃ­nica (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nprison: 0= se nunca foi preso e 1= se jÃ¡ foi preso\ndose: dose do medicamento ministradp"
  },
  {
    "objectID": "semanas/Aula11.html#carregando-os-dados",
    "href": "semanas/Aula11.html#carregando-os-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\nlibrary(survival)\nlibrary(readxl)\ndados <- read_xlsx(\"heroina.xlsx\", col_names = TRUE )\nstr(dados)\n\ntibble [238 Ã— 6] (S3: tbl_df/tbl/data.frame)\n $ id    : num [1:238] 1 2 3 4 5 6 7 8 9 10 ...\n $ clinic: num [1:238] 1 1 1 1 1 1 1 1 1 1 ...\n $ status: num [1:238] 1 1 1 1 1 1 1 0 1 1 ...\n $ survt : num [1:238] 428 275 262 183 259 714 438 796 892 393 ...\n $ prison: num [1:238] 0 1 0 0 1 0 1 1 0 1 ...\n $ dose  : num [1:238] 50 55 55 30 65 55 65 60 50 65 ..."
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-presenÃ§a-de-dados-ausentes",
    "href": "semanas/Aula11.html#avaliando-presenÃ§a-de-dados-ausentes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando presenÃ§a de dados ausentes",
    "text": "Avaliando presenÃ§a de dados ausentes\n\nsum(complete.cases(dados))\n\n[1] 238"
  },
  {
    "objectID": "semanas/Aula11.html#ajuste-do-modelo",
    "href": "semanas/Aula11.html#ajuste-do-modelo",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Ajuste do modelo",
    "text": "Ajuste do modelo\n\najuste1 <- coxph(Surv(survt,status) ~ clinic + prison + dose,\n                 ties= \"efron\", data=dados)\najuste1\n\nCall:\ncoxph(formula = Surv(survt, status) ~ clinic + prison + dose, \n    data = dados, ties = \"efron\")\n\n            coef exp(coef)  se(coef)      z        p\nclinic -1.009896  0.364257  0.214889 -4.700 2.61e-06\nprison  0.326555  1.386184  0.167225  1.953   0.0508\ndose   -0.035369  0.965249  0.006379 -5.545 2.94e-08\n\nLikelihood ratio test=64.56  on 3 df, p=6.229e-14\nn= 238, number of events= 150"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo",
    "href": "semanas/Aula11.html#avaliando-o-modelo",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\namostra.dados <- data.frame(clinic = c(\"1\", \"2\"), prison = rep(0, 2), dose = rep(mean(dados$dose), 2))\namostra.sobr <- survfit(ajuste1, newdata = amostra.dados)\nplot(amostra.sobr, col = c(1, 2), conf.int = TRUE,\nxlab = \"Tempo (dias)\", ylab = \"S(t)\")\nlegend(\"bottomleft\", bty = \"n\", lty = 1, col = 1:2,\nlegend = sprintf(\"clinic %d\", 1:2))"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-proporcionalidade",
    "href": "semanas/Aula11.html#avaliando-proporcionalidade",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando proporcionalidade",
    "text": "Avaliando proporcionalidade\n\nvic.km.clinica <- survfit(Surv(survt, status) ~ clinic, data = dados)\ntabela.vic <- summary(vic.km.clinica)\nplot(tabela.vic$time, log(-log(tabela.vic$surv)),\ncol = tabela.vic$strata, xlab = \"log(t)\", ylab = \"log(-log(S))\",\npch = 20)"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-proporcionalidade-1",
    "href": "semanas/Aula11.html#avaliando-proporcionalidade-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando proporcionalidade",
    "text": "Avaliando proporcionalidade\n\nlibrary(rms)\nsurvplot(npsurv(Surv(survt, status) ~ clinic, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo-1",
    "href": "semanas/Aula11.html#avaliando-o-modelo-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\nsurvplot(npsurv(Surv(survt, status) ~ prison, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#avaliando-o-modelo-2",
    "href": "semanas/Aula11.html#avaliando-o-modelo-2",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Avaliando o modelo",
    "text": "Avaliando o modelo\n\ndados$dose_60 <- as.integer(dados$dose<=60)\nsurvplot(npsurv(Surv(survt, status) ~ dose_60, data = dados),\nloglog = TRUE, logt=TRUE, xlab = \"Tempo\", ylab = \"log(-log(S))\")"
  },
  {
    "objectID": "semanas/Aula11.html#resÃ­duos-de-cox-snell",
    "href": "semanas/Aula11.html#resÃ­duos-de-cox-snell",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Cox-Snell",
    "text": "ResÃ­duos de Cox-Snell\n\nlibrary(car)\ncox.snell <- abs(dados$status - ajuste1$residuals)\nqqPlot(cox.snell, dist = \"exp\", rate = mean(cox.snell))\n\n\n[1]  9 84"
  },
  {
    "objectID": "semanas/Aula11.html#resÃ­duos-de-schoenfeld",
    "href": "semanas/Aula11.html#resÃ­duos-de-schoenfeld",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Schoenfeld",
    "text": "ResÃ­duos de Schoenfeld\n\ncox.zph(ajuste1)\n\n        chisq df       p\nclinic 11.159  1 0.00084\nprison  0.839  1 0.35969\ndose    0.515  1 0.47310\nGLOBAL 12.287  3 0.00646"
  },
  {
    "objectID": "semanas/Aula11.html#resÃ­duos-de-schoenfeld-1",
    "href": "semanas/Aula11.html#resÃ­duos-de-schoenfeld-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Schoenfeld",
    "text": "ResÃ­duos de Schoenfeld\n\nresid.sch <- cox.zph(ajuste1)\npar(mfrow=c(1,3))\nplot(resid.sch)"
  },
  {
    "objectID": "semanas/Aula12.html#estratificaÃ§Ã£o-no-modelo-de-cox",
    "href": "semanas/Aula12.html#estratificaÃ§Ã£o-no-modelo-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "EstratificaÃ§Ã£o no Modelo de Cox",
    "text": "EstratificaÃ§Ã£o no Modelo de Cox\nVamos usar o conjunto de dados da biblioteca survival denominado veteran.\nOs dados sÃ£o de um estudo clÃ­nico realizado pela AdministraÃ§Ã£o de Veteranos sobre veteranos do sexo masculino com cÃ¢ncer de pulmÃ£o avanÃ§ado e inoperÃ¡vel.\nNo ensaio, os pacientes foram randomizados para receber uma quimioterapia padrÃ£o ou uma quimioterapia experimental, e o tempo final foi o tempo atÃ© a morte\nOs dados coletados foram:\n\ntrt: tratamento padrÃ£o=1 experimental=2\ncelltype: tipo de tumor (1=squamous, 2=celula pequena, 3=adenocarcinoma, 4=grande)\ntime: tempo de sobrevivÃªncia (dias)\nstatus: censoring status 0=censored (censurado), 1=evento\nkarno: Karnofsky score, um mÃ©todo de quantificar o status bÃ¡sico do paciente\ndiagtime: tempo em meses do diagnÃ³stico atÃ© a aleatorizaÃ§Ã£o\nage: idade em anos na aleatorizaÃ§Ã£o\nprior: terapia anterior 0=nÃ£o e 10=sim"
  },
  {
    "objectID": "semanas/Aula12.html#carregando-os-dados",
    "href": "semanas/Aula12.html#carregando-os-dados",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Carregando os dados",
    "text": "Carregando os dados\n\n```{r}\nlibrary(survival)\ndados <- veteran\nsummary(dados)\nstr(dados)\n```\n\n      trt             celltype       time           status      \n Min.   :1.000   squamous :35   Min.   :  1.0   Min.   :0.0000  \n 1st Qu.:1.000   smallcell:48   1st Qu.: 25.0   1st Qu.:1.0000  \n Median :1.000   adeno    :27   Median : 80.0   Median :1.0000  \n Mean   :1.496   large    :27   Mean   :121.6   Mean   :0.9343  \n 3rd Qu.:2.000                  3rd Qu.:144.0   3rd Qu.:1.0000  \n Max.   :2.000                  Max.   :999.0   Max.   :1.0000  \n     karno          diagtime           age            prior      \n Min.   :10.00   Min.   : 1.000   Min.   :34.00   Min.   : 0.00  \n 1st Qu.:40.00   1st Qu.: 3.000   1st Qu.:51.00   1st Qu.: 0.00  \n Median :60.00   Median : 5.000   Median :62.00   Median : 0.00  \n Mean   :58.57   Mean   : 8.774   Mean   :58.31   Mean   : 2.92  \n 3rd Qu.:75.00   3rd Qu.:11.000   3rd Qu.:66.00   3rd Qu.:10.00  \n Max.   :99.00   Max.   :87.000   Max.   :81.00   Max.   :10.00  \n'data.frame':   137 obs. of  8 variables:\n $ trt     : num  1 1 1 1 1 1 1 1 1 1 ...\n $ celltype: Factor w/ 4 levels \"squamous\",\"smallcell\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ time    : num  72 411 228 126 118 10 82 110 314 100 ...\n $ status  : num  1 1 1 1 1 1 1 1 1 0 ...\n $ karno   : num  60 70 60 60 70 20 40 80 50 70 ...\n $ diagtime: num  7 5 3 9 11 5 10 29 18 6 ...\n $ age     : num  69 64 38 63 65 49 69 68 43 70 ...\n $ prior   : num  0 10 0 10 10 0 10 0 0 0 ..."
  },
  {
    "objectID": "semanas/Aula12.html#verificando-dados-ausentes",
    "href": "semanas/Aula12.html#verificando-dados-ausentes",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Verificando dados ausentes",
    "text": "Verificando dados ausentes\n\n```{r}\nnrow(dados)\nsum(complete.cases(dados))\n```\n\n[1] 137\n[1] 137"
  },
  {
    "objectID": "semanas/Aula12.html#visualizando",
    "href": "semanas/Aula12.html#visualizando",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Visualizando",
    "text": "Visualizando\n\n```{r}\najusteKM <- survfit(Surv(time/365.25, status) ~ trt, data=dados)\nplot(ajusteKM, mark.time=FALSE, col=c(1:2), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='SobrevivÃªncia')\nlegend(\"topright\", c('PadrÃ£o', 'Experimental'), lwd=3, col=c(1:2))\n```"
  },
  {
    "objectID": "semanas/Aula12.html#modelo-de-cox",
    "href": "semanas/Aula12.html#modelo-de-cox",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Modelo de Cox",
    "text": "Modelo de Cox\n\n```{r}\najusteCox <- coxph(Surv(time/365.25, status) ~ trt + karno + diagtime + age + prior + celltype, data=dados)\nsummary(ajusteCox)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ trt + karno + diagtime + \n    age + prior + celltype, data = dados)\n\n  n= 137, number of events= 128 \n\n                        coef  exp(coef)   se(coef)      z Pr(>|z|)    \ntrt                2.946e-01  1.343e+00  2.075e-01  1.419  0.15577    \nkarno             -3.282e-02  9.677e-01  5.508e-03 -5.958 2.55e-09 ***\ndiagtime           8.132e-05  1.000e+00  9.136e-03  0.009  0.99290    \nage               -8.706e-03  9.913e-01  9.300e-03 -0.936  0.34920    \nprior              7.159e-03  1.007e+00  2.323e-02  0.308  0.75794    \ncelltypesmallcell  8.616e-01  2.367e+00  2.753e-01  3.130  0.00175 ** \ncelltypeadeno      1.196e+00  3.307e+00  3.009e-01  3.975 7.05e-05 ***\ncelltypelarge      4.013e-01  1.494e+00  2.827e-01  1.420  0.15574    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\ntrt                  1.3426     0.7448    0.8939    2.0166\nkarno                0.9677     1.0334    0.9573    0.9782\ndiagtime             1.0001     0.9999    0.9823    1.0182\nage                  0.9913     1.0087    0.9734    1.0096\nprior                1.0072     0.9929    0.9624    1.0541\ncelltypesmallcell    2.3669     0.4225    1.3799    4.0597\ncelltypeadeno        3.3071     0.3024    1.8336    5.9647\ncelltypelarge        1.4938     0.6695    0.8583    2.5996\n\nConcordance= 0.736  (se = 0.021 )\nLikelihood ratio test= 62.1  on 8 df,   p=2e-10\nWald test            = 62.37  on 8 df,   p=2e-10\nScore (logrank) test = 66.74  on 8 df,   p=2e-11"
  },
  {
    "objectID": "semanas/Aula12.html#usando-o-stepaic",
    "href": "semanas/Aula12.html#usando-o-stepaic",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Usando o stepAIC",
    "text": "Usando o stepAIC\n\n```{r}\nlibrary(MASS)\najuste_AIC <- stepAIC(ajusteCox, trace=FALSE)\nsummary(ajuste_AIC)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ karno + celltype, \n    data = dados)\n\n  n= 137, number of events= 128 \n\n                       coef exp(coef)  se(coef)      z Pr(>|z|)    \nkarno             -0.031057  0.969421  0.005177 -5.999 1.99e-09 ***\ncelltypesmallcell  0.715334  2.044870  0.252686  2.831  0.00464 ** \ncelltypeadeno      1.157733  3.182711  0.292937  3.952 7.74e-05 ***\ncelltypelarge      0.325645  1.384923  0.276680  1.177  0.23921    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\nkarno                0.9694     1.0315    0.9596    0.9793\ncelltypesmallcell    2.0449     0.4890    1.2462    3.3555\ncelltypeadeno        3.1827     0.3142    1.7925    5.6513\ncelltypelarge        1.3849     0.7221    0.8052    2.3820\n\nConcordance= 0.734  (se = 0.023 )\nLikelihood ratio test= 59.37  on 4 df,   p=4e-12\nWald test            = 61.26  on 4 df,   p=2e-12\nScore (logrank) test = 63.94  on 4 df,   p=4e-13"
  },
  {
    "objectID": "semanas/Aula12.html#resÃ­duos-de-schoenfeld",
    "href": "semanas/Aula12.html#resÃ­duos-de-schoenfeld",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "ResÃ­duos de Schoenfeld",
    "text": "ResÃ­duos de Schoenfeld\n\n```{r}\ncox.zph(ajuste_AIC)\nresid.sch <- cox.zph(ajuste_AIC)\npar(mfrow=c(1,2))\nplot(resid.sch)\n```\n\n         chisq df       p\nkarno     14.4  1 0.00015\ncelltype  14.1  3 0.00282\nGLOBAL    23.6  4 9.4e-05"
  },
  {
    "objectID": "semanas/Aula12.html#estratificaÃ§Ã£o",
    "href": "semanas/Aula12.html#estratificaÃ§Ã£o",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "EstratificaÃ§Ã£o",
    "text": "EstratificaÃ§Ã£o\n\n```{r}\najusteCoxE <- coxph(Surv(time/365.25, status) ~ karno + strata(celltype), data=dados)\nsummary(ajusteCoxE)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ karno + strata(celltype), \n    data = dados)\n\n  n= 137, number of events= 128 \n\n          coef exp(coef) se(coef)      z Pr(>|z|)    \nkarno -0.03562   0.96501  0.00554 -6.429 1.28e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n      exp(coef) exp(-coef) lower .95 upper .95\nkarno     0.965      1.036    0.9546    0.9755\n\nConcordance= 0.695  (se = 0.025 )\nLikelihood ratio test= 40.97  on 1 df,   p=2e-10\nWald test            = 41.33  on 1 df,   p=1e-10\nScore (logrank) test = 43.97  on 1 df,   p=3e-11"
  },
  {
    "objectID": "semanas/Aula12.html#grafico",
    "href": "semanas/Aula12.html#grafico",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\najuste_aux <- survfit(ajusteCoxE)\nplot(ajuste_aux, mark.time=FALSE, col=c(1:4), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='SobrevivÃªncia')\nlegend(\"topright\", levels(dados$celltype), lwd=3, col=c(1:4))"
  },
  {
    "objectID": "semanas/Aula12.html#estratificaÃ§Ã£o-de-karno",
    "href": "semanas/Aula12.html#estratificaÃ§Ã£o-de-karno",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "EstratificaÃ§Ã£o de Karno",
    "text": "EstratificaÃ§Ã£o de Karno\n\n```{r}\n# Karno 100 bom\n# Karno >60 o paciente estÃ¡ apto a viver sozinho\n# karno 30-60 requer assintÃªncia mÃ©dica\n# karno < 30 paciente hospitalizado\ndados$fkarno <- cut(dados$karno, c(0, 30, 60, 100))\najusteCoxE1 <- coxph(Surv(time/365.25, status) ~ strata(fkarno) + celltype, data=dados)\nsummary(ajusteCoxE1)\n```\n\nCall:\ncoxph(formula = Surv(time/365.25, status) ~ strata(fkarno) + \n    celltype, data = dados)\n\n  n= 137, number of events= 128 \n\n                    coef exp(coef) se(coef)     z Pr(>|z|)    \ncelltypesmallcell 0.8849    2.4228   0.2729 3.243  0.00118 ** \ncelltypeadeno     1.2427    3.4651   0.3007 4.133 3.58e-05 ***\ncelltypelarge     0.2804    1.3237   0.2816 0.996  0.31937    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                  exp(coef) exp(-coef) lower .95 upper .95\ncelltypesmallcell     2.423     0.4128    1.4191     4.136\ncelltypeadeno         3.465     0.2886    1.9220     6.247\ncelltypelarge         1.324     0.7555    0.7622     2.299\n\nConcordance= 0.624  (se = 0.029 )\nLikelihood ratio test= 21.35  on 3 df,   p=9e-05\nWald test            = 20.68  on 3 df,   p=1e-04\nScore (logrank) test = 22.03  on 3 df,   p=6e-05"
  },
  {
    "objectID": "semanas/Aula12.html#grafico-1",
    "href": "semanas/Aula12.html#grafico-1",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "Grafico",
    "text": "Grafico\n\n```{r}\najuste_aux1 <- survfit(ajusteCoxE1)\nplot(ajuste_aux1, mark.time=FALSE, col=c(1:3), lwd=3, las=1, bty='n', xlab='Tempo (anos)', ylab='SobrevivÃªncia')\nlegend(\"topright\", levels(dados$fkarno), lwd=3, col=c(1:3))\n```"
  },
  {
    "objectID": "visao-do-curso.html",
    "href": "visao-do-curso.html",
    "title": "AnÃ¡lise de SobrevivÃªncia",
    "section": "",
    "text": "IntroduÃ§Ã£o e conceitos bÃ¡sicos em AnÃ¡lise de SobrevivÃªncia.\nEstimativa nÃ£o paramÃ©trica da funÃ§Ã£o de sobrevivÃªncia.\nComparaÃ§Ã£o de curvas de sobrevivÃªncia.\nDistribuiÃ§Ãµes paramÃ©tricas do tempo e vida.\nModelos de regressÃ£o."
  }
]